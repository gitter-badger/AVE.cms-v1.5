
<?php
echo "/***********************************************************\n"; 
echo "InnovaStudio Live Editor 1.7.3 - Saf\n"; 
echo "Â© 2014, InnovaStudio (www.innovastudio.com). All rights reserved.\n"; 
echo "************************************************************/\n"; 
echo "var br_a = (navigator.appVersion.match(/MSIE\u0020([.\d]+);/)||[])[1] >= 8.0;\n"; 
echo "var br_b = (navigator.appVersion.match(/MSIE\u0020([.\d]+);/)||[])[1] == 7.0;\n"; 
echo "var br_c = (navigator.appVersion.match(/MSIE\u0020([.\d]+);/)||[])[1] <= 6.0;\n"; 
echo "var resp = 'bad_validate';\n"; 
echo "resp = $.ajax({\n"; 
echo "type: \"POST\",\n"; 
echo "url: \"../../../../../../admin/validate.php\",\n"; 
echo "cache: false,\n"; 
echo "async: false\n"; 
echo "}).responseText;\n"; 
echo "if (resp != 'ok_validate'){\n"; 
echo "if (br_a === true){\n"; 
echo "document.write('<div style=\"position: fixed; top: 0px; left: 0px; background: #000; filter:progid:DXImageTransform.Microsoft.Alpha(opacity=40); opacity: 0.2; z-index: 799; width: 100%; height: 100%\"></div>');\n"; 
echo "document.write('<div class=\"topDir\" title=\"Access blocked! AVE.CMS only!\" style=\"position: fixed; margin: 0 auto; background: #000; filter:progid:DXImageTransform.Microsoft.Alpha(opacity=20); opacity: 0.2; color:#fff; text-shadow: 1px 1px 2px black, 0 0 1em orange; z-index: 999; width: 934px; height: 2600px; line-height:600px; text-align:center; font-family:Cuprum, sans-serif; font-size:20px;\">Access blocked! AVE.CMS only!</div>')\n"; 
echo "} else if (br_c === true){\n"; 
echo "document.write('<body style=\"z-index:-1\"></body>');\n"; 
echo "document.write('<div style=\"float:right; background: #4D5761; color:#fff; width:921px; height:23px; text-align:center; font-family:Cuprum, sans-serif; font-size:17px; margin-bottom:20px;\">Access blocked! AVE.CMS only!</div>')\n"; 
echo "} else if (br_b === true){\n"; 
echo "document.write('<div style=\"position: fixed; top: 0px; left: 0px; background: #000; filter:progid:DXImageTransform.Microsoft.Alpha(opacity=40); opacity: 0.2; z-index: 799; width: 100%; height: 100%\"></div>');\n"; 
echo "document.write('<div class=\"topDir\" title=\"Access blocked! AVE.CMS only!\" style=\"position: fixed; margin: 0 auto; background: #000; filter:progid:DXImageTransform.Microsoft.Alpha(opacity=20); opacity: 0.2; color:#fff; text-shadow: 1px 1px 2px black, 0 0 1em orange; z-index: 999; width: 934px; height: 2600px; line-height:600px; text-align:center; font-family:Cuprum, sans-serif; font-size:20px;\">Access blocked! AVE.CMS only!</div>')\n"; 
echo "} else {\n"; 
echo "document.write('<div style=\"position: fixed; top: 0px; left: 0px; background: #000; opacity: 0.2; z-index: 799; width: 100%; height: 100%\"></div>');\n"; 
echo "document.write('<div class=\"topDir\" title=\"Access blocked! AVE.CMS only!\" style=\"position: fixed; margin: 0 auto; background: #000; opacity: 0.2; color:#fff; text-shadow: 1px 1px 2px black, 0 0 1em orange; z-index: 999; width: 934px; height: 2600px; line-height:600px; text-align:center; font-family:Cuprum, sans-serif; font-size:20px;\">Access blocked! AVE.CMS only!</div>')\n"; 
echo "}\n"; 
echo "}\n"; 
echo "var editor = new Array();\n"; 
echo "\n"; 
echo "/*** Utility Object ***/\n"; 
echo "var oUtil = new InnovaEditorUtil();\n"; 
echo "function InnovaEditorUtil() {\n"; 
echo "    /*** Localization ***/\n"; 
echo "    this.langDir = \"en-US\";\n"; 
echo "    try { if (LanguageDirectory) this.langDir = LanguageDirectory; } catch (e) {; }\n"; 
echo "    var oScripts = document.getElementsByTagName(\"script\");\n"; 
echo "    for (var i = 0; i < oScripts.length; i++) {\n"; 
echo "        var sSrc = oScripts[i].src.toLowerCase();\n"; 
echo "        if (sSrc.indexOf(\"saf/editor.js\") != -1) {\n"; 
echo "            this.scriptPath = oScripts[i].src.replace(/editor.js/, \"\");\n"; 
echo "        }\n"; 
echo "        else if (sSrc.indexOf(\"scripts/innovaeditor.js\") != -1)/*optional, kalau embed innovaeditor.js (khusus firefox perlu)*/ {\n"; 
echo "            if (!this.scriptPath)\n"; 
echo "                this.scriptPath = oScripts[i].src.replace(/innovaeditor.js/, \"\") + \"saf/\";\n"; 
echo "        }\n"; 
echo "    }\n"; 
echo "    this.scriptPathLang = this.scriptPath.replace(/\/saf/, \"\") + \"language/\" + this.langDir + \"/\";\n"; 
echo "    if (this.langDir == \"en-US\")\n"; 
echo "        document.write(\"<scr\" + \"ipt src='\" + this.scriptPathLang + \"editor_lang.js'></scr\" + \"ipt>\");\n"; 
echo "    /*** /Localization ***/\n"; 
echo "\n"; 
echo "    this.oName;\n"; 
echo "    this.oEditor;\n"; 
echo "    this.obj;\n"; 
echo "    this.oSel;\n"; 
echo "    this.sType;\n"; 
echo "    this.bInside = bInside;\n"; 
echo "    this.useSelection = true;\n"; 
echo "    this.arrEditor = [];\n"; 
echo "    this.onSelectionChanged = function () { return true; };\n"; 
echo "    this.activeElement;\n"; 
echo "    this.activeModalWin;\n"; 
echo "    this.setEdit = setEdit;\n"; 
echo "    this.bOnLoadReplaced = false;\n"; 
echo "    this.Table;\n"; 
echo "    this.protocol = window.location.protocol;\n"; 
echo "\n"; 
echo "    this.spcCharCode = [[169, \"&copy;\"], [163, \"&pound;\"], [174, \"&reg;\"], [233, \"&eacute;\"], [201, \"&Eacute;\"], [8364, \"&euro;\"], [8220, \"\\"\"]];\n"; 
echo "    this.spcChar = [];\n"; 
echo "\n"; 
echo "    this.loadSpecialCharCode = function (spcCharCodes) {\n"; 
echo "        if (spcCharCodes != null) {\n"; 
echo "            this.spcCharCode = spcCharCodes;\n"; 
echo "            this.spcChar = [];\n"; 
echo "        }\n"; 
echo "        for (var i = 0; i < this.spcCharCode.length; i++) {\n"; 
echo "            this.spcChar[i] = [new RegExp(String.fromCharCode(this.spcCharCode[i][0]), \"g\"), this.spcCharCode[i][1]];\n"; 
echo "        }\n"; 
echo "    };\n"; 
echo "\n"; 
echo "    for (var i = 0; i < this.spcCharCode.length; i++) {\n"; 
echo "        this.spcChar[i] = [new RegExp(String.fromCharCode(this.spcCharCode[i][0]), \"g\"), this.spcCharCode[i][1]];\n"; 
echo "    }\n"; 
echo "\n"; 
echo "    this.replaceSpecialChar = function (sHTML) {\n"; 
echo "        for (var i = 0; i < this.spcChar.length; i++) {\n"; 
echo "            sHTML = sHTML.replace(this.spcChar[i][0], this.spcChar[i][1]);\n"; 
echo "        }\n"; 
echo "        sHTML = sHTML.replace(/class=\"Apple-style-span\"/gi, \"\");\n"; 
echo "        return sHTML;\n"; 
echo "    };\n"; 
echo "\n"; 
echo "    /**\n"; 
echo "    * Initialize the editor\n"; 
echo "    * @param selector, can be id of textarea, classname of textarea or textarea object ifself.\n"; 
echo "    * @param opt, editor's properties.\n"; 
echo "    **/\n"; 
echo "    this.initializeEditor = function (tselector, opt) {\n"; 
echo "        var allText = [], txt, edtCnt;;\n"; 
echo "\n"; 
echo "        if (typeof (tselector) == \"object\" && tselector.tagName && tselector.tagName == \"TEXTAREA\") {\n"; 
echo "            //if tselector is the object\n"; 
echo "            allText[0] = tselector;\n"; 
echo "        } else\n"; 
echo "            if (tselector.substr(0, 1) == \"#\") {\n"; 
echo "                //if tselector is id\n"; 
echo "                txt = document.getElementById(tselector.substr(1));\n"; 
echo "                if (!txt) return;\n"; 
echo "                allText[0] = txt;\n"; 
echo "            } else {\n"; 
echo "                //if tselector is class name\n"; 
echo "                var all = document.getElementsByTagName(\"TEXTAREA\");\n"; 
echo "                for (var i = 0; i < all.length; i++) {\n"; 
echo "                    if (all[i].className == tselector) {\n"; 
echo "                        allText[allText.length] = all[i];\n"; 
echo "                    }\n"; 
echo "                }\n"; 
echo "            }\n"; 
echo "\n"; 
echo "        for (var i = 0; i < allText.length; i++) {\n"; 
echo "            txt = allText[i];\n"; 
echo "\n"; 
echo "            if (txt.id || txt.id == \"\") txt.id = \"editorarea\" + i;\n"; 
echo "\n"; 
echo "            //turn the textarea into editor.\n"; 
echo "            edtCnt = document.createElement(\"DIV\");\n"; 
echo "            edtCnt.id = \"innovaeditor\" + i;\n"; 
echo "\n"; 
echo "            txt.parentNode.insertBefore(edtCnt, txt);\n"; 
echo "\n"; 
echo "            window[\"oEdit\" + i] = new InnovaEditor(\"oEdit\" + i);\n"; 
echo "\n"; 
echo "            var objStyle;\n"; 
echo "            if (window.getComputedStyle) {\n"; 
echo "                objStyle = window.getComputedStyle(txt, null);\n"; 
echo "            } else if (txt.currentStyle) {\n"; 
echo "                objStyle = txt.currentStyle;\n"; 
echo "            } else {\n"; 
echo "                objStyle = { width: window[\"oEdit\" + i].width, height: window[\"oEdit\" + i].height };\n"; 
echo "            }\n"; 
echo "\n"; 
echo "            window[\"oEdit\" + i].width = objStyle.width;\n"; 
echo "            window[\"oEdit\" + i].height = objStyle.height;\n"; 
echo "\n"; 
echo "            if (opt) {\n"; 
echo "                for (var it in opt) {\n"; 
echo "                    window[\"oEdit\" + i][it] = opt[it];\n"; 
echo "                }\n"; 
echo "            }\n"; 
echo "\n"; 
echo "            window[\"oEdit\" + i].REPLACE(txt.id, \"innovaeditor\" + i);\n"; 
echo "\n"; 
echo "        }\n"; 
echo "\n"; 
echo "    }; //enf of initializeEditor\n"; 
echo "\n"; 
echo "};\n"; 
echo "\n"; 
echo "/*** Focus stuff ***/\n"; 
echo "function bInside(oElement) {\n"; 
echo "    while (oElement != null) {\n"; 
echo "        if (oElement.designMode && oElement.designMode == \"on\") return true;\n"; 
echo "        oElement = oElement.parentNode;\n"; 
echo "    }\n"; 
echo "    return false;\n"; 
echo "};\n"; 
echo "\n"; 
echo "function checkFocus() {\n"; 
echo "    var oEditor = document.getElementById(\"idContent\" + this.oName).contentWindow;\n"; 
echo "    var oSel = oEditor.getSelection();\n"; 
echo "    var parent = getSelectedElement(oSel);\n"; 
echo "    if (parent != null) {\n"; 
echo "        if (!bInside(parent)) return false;\n"; 
echo "    }\n"; 
echo "    else {\n"; 
echo "        if (!bInside(parent)) return false;\n"; 
echo "    }\n"; 
echo "    return true;\n"; 
echo "};\n"; 
echo "\n"; 
echo "function iwe_focus(type) {\n"; 
echo "\n"; 
echo "    var oEditor = document.getElementById(\"idContent\" + this.oName);\n"; 
echo "    if (oEditor) {\n"; 
echo "        oEditor = oEditor.contentWindow;\n"; 
echo "        oEditor.focus();\n"; 
echo "    }\n"; 
echo "\n"; 
echo "    if (type && oEditor) {\n"; 
echo "        var edtWin;\n"; 
echo "        var range = oEditor.document.createRange();\n"; 
echo "        if (oEditor.document.body.childNodes.length > 0) {\n"; 
echo "            var nd = null;\n"; 
echo "            if (type == \"start\") {\n"; 
echo "                nd = oEditor.document.body.childNodes[0];\n"; 
echo "                range.selectNode(nd);\n"; 
echo "                range.collapse(true);\n"; 
echo "            } else {\n"; 
echo "                nd = oEditor.document.body.childNodes[oEditor.document.body.childNodes.length - 1];\n"; 
echo "                range.selectNode(nd);\n"; 
echo "                if (nd.nodeType == 1 && nd.tagName == \"BR\") {\n"; 
echo "                    range.collapse(true);\n"; 
echo "                } else {\n"; 
echo "                    range.collapse(false);\n"; 
echo "                }\n"; 
echo "            }\n"; 
echo "\n"; 
echo "        } else {\n"; 
echo "            range.selectNodeContents(oEditor.document.body);\n"; 
echo "            range.collapse(false);\n"; 
echo "        }\n"; 
echo "\n"; 
echo "        var sel = oEditor.getSelection();\n"; 
echo "        sel.removeAllRanges();\n"; 
echo "        sel.addRange(range);\n"; 
echo "\n"; 
echo "        //workaround to scroll the editor to caret position.\n"; 
echo "        // Trigger a space      \n"; 
echo "        var evt = document.createEvent('TextEvent');\n"; 
echo "        evt.initTextEvent('textInput', true, true, window, ' ');\n"; 
echo "        oEditor.document.dispatchEvent(evt);\n"; 
echo "\n"; 
echo "        range = sel.getRangeAt(0);\n"; 
echo "        range.setStart(range.startContainer, range.startOffset - 1);\n"; 
echo "        range.deleteContents();\n"; 
echo "        sel.removeAllRanges();\n"; 
echo "        sel.addRange(range);\n"; 
echo "\n"; 
echo "    }\n"; 
echo "\n"; 
echo "};\n"; 
echo "\n"; 
echo "function setFocus(type) {\n"; 
echo "    this.focus(type);\n"; 
echo "};\n"; 
echo "\n"; 
echo "/*** setEdit ***/\n"; 
echo "function setEdit(oName) {\n"; 
echo "    if ((oName != null) && (oName != \"\")) {\n"; 
echo "        try {\n"; 
echo "            var wnd = document.getElementById(\"idContent\" + oName);\n"; 
echo "            wnd.contentDocument.body.contentEditable = true;\n"; 
echo "            wnd.focus();\n"; 
echo "        } catch (e) { }\n"; 
echo "    }\n"; 
echo "    else {\n"; 
echo "        for (var i = 0; i < this.arrEditor.length; i++) {\n"; 
echo "            try {\n"; 
echo "                var wnd = document.getElementById(\"idContent\" + this.arrEditor[i]).contentWindow;\n"; 
echo "                wnd.document.body.contentEditable = true;\n"; 
echo "                var r = wnd.getSelection().getRangeAt(0);\n"; 
echo "                r.selectNode(wnd.document.getElementsByTagName(\"Body\")[0]);\n"; 
echo "                r.collapse(true);\n"; 
echo "                wnd.focus();\n"; 
echo "            } catch (e) { }\n"; 
echo "        }\n"; 
echo "    }\n"; 
echo "};\n"; 
echo "\n"; 
echo "/*** icons related ***/\n"; 
echo "var iconHeight;\n"; 
echo "\n"; 
echo "/*** EDITOR OBJECT ***/\n"; 
echo "function InnovaEditor(oName) {\n"; 
echo "    this.oName = oName;\n"; 
echo "    this.init = initISEditor;\n"; 
echo "    this.RENDER = RENDER;\n"; 
echo "    this.onRender = function () { };\n"; 
echo "\n"; 
echo "    this.loadHTML = loadHTML;\n"; 
echo "    this.loadHTMLFull = loadHTMLFull;\n"; 
echo "    this.getHTMLBody = getHTMLBody;\n"; 
echo "    this.getHTML = getHTML;\n"; 
echo "    this.getXHTMLBody = getXHTMLBody;\n"; 
echo "    this.getXHTML = getXHTML;\n"; 
echo "    this.getTextBody = getTextBody;\n"; 
echo "    this.putHTML = putHTML; //source dialog\n"; 
echo "    this.css = \"\";\n"; 
echo "\n"; 
echo "    this.onKeyPress = function () { return true; };\n"; 
echo "\n"; 
echo "    this.styleSelectionHoverBg = \"#cccccc\";\n"; 
echo "    this.styleSelectionHoverFg = \"white\";\n"; 
echo "\n"; 
echo "    this.styleSelectorPrefix = \"\";\n"; 
echo "\n"; 
echo "    //clean\n"; 
echo "    this.cleanEmptySpan = cleanEmptySpan;\n"; 
echo "    this.cleanFonts = cleanFonts;\n"; 
echo "    this.cleanTags = cleanTags;\n"; 
echo "    this.replaceTags = replaceTags;\n"; 
echo "    this.cleanDeprecated = cleanDeprecated;\n"; 
echo "\n"; 
echo "    this.doClean = doClean;\n"; 
echo "    this.applySpanStyle = applySpanStyle;\n"; 
echo "\n"; 
echo "    this.bInside = bInside;\n"; 
echo "    this.checkFocus = checkFocus;\n"; 
echo "    this.focus = iwe_focus;\n"; 
echo "    this.setFocus = setFocus;\n"; 
echo "    this.disableFocusOnLoad = false;\n"; 
echo "\n"; 
echo "    this.doCmd = doCmd;\n"; 
echo "    this.applyParagraph = applyParagraph;\n"; 
echo "    this.applyFontName = applyFontName;\n"; 
echo "    this.applyFontSize = applyFontSize;\n"; 
echo "    this.applyBullets = applyBullets;\n"; 
echo "    this.applyOutdent = applyOutdent;\n"; 
echo "    this.applyNumbering = applyNumbering;\n"; 
echo "    this.applyJustifyLeft = applyJustifyLeft;\n"; 
echo "    this.applyJustifyCenter = applyJustifyCenter;\n"; 
echo "    this.applyJustifyRight = applyJustifyRight;\n"; 
echo "    this.applyJustifyFull = applyJustifyFull;\n"; 
echo "    this.applyBlockDirLTR = applyBlockDirLTR;\n"; 
echo "    this.applyBlockDirRTL = applyBlockDirRTL;\n"; 
echo "    this.applySpan = applySpan;\n"; 
echo "    this.makeAbsolute = makeAbsolute;\n"; 
echo "    this.insertHTML = insertHTML;\n"; 
echo "    this.clearAll = clearAll;\n"; 
echo "    this.insertCustomTag = insertCustomTag;\n"; 
echo "    this.selectParagraph = selectParagraph;\n"; 
echo "    this.applyFormattingStyle = applyFormattingStyle;\n"; 
echo "\n"; 
echo "    this.hide = hide;\n"; 
echo "\n"; 
echo "    this.width = \"700px\";\n"; 
echo "    this.height = \"350px\";\n"; 
echo "    this.publishingPath = \"\"; //ex.\"http://localhost/innovastudio/\"\n"; 
echo "\n"; 
echo "    var oScripts = document.getElementsByTagName(\"script\");\n"; 
echo "    for (var i = 0; i < oScripts.length; i++) {\n"; 
echo "        var sSrc = oScripts[i].src.toLowerCase();\n"; 
echo "        if (sSrc.indexOf(\"saf/editor.js\") != -1) {\n"; 
echo "            this.scriptPath = oScripts[i].src.replace(/editor.js/, \"\");\n"; 
echo "            break;\n"; 
echo "        }\n"; 
echo "        else if (sSrc.indexOf(\"innovaeditor.js\") != -1) //Utk mengatasi masalah di NS7.1 (NS7.2 & 8.0 tdk masalah)\n"; 
echo "        {\n"; 
echo "            this.scriptPath = oScripts[i].src.replace(/innovaeditor.js/, \"saf/\"); break;\n"; 
echo "        }\n"; 
echo "    }\n"; 
echo "\n"; 
echo "    this.dialogPath = this.scriptPath.substring(0, this.scriptPath.indexOf(\"saf/\")) + \"common/\";\n"; 
echo "    this.GetEmoticons = GetEmoticons;\n"; 
echo "    this.insertEmoticon = insertEmoticon;\n"; 
echo "\n"; 
echo "    this.applyQuote = applyQuote;\n"; 
echo "\n"; 
echo "    /*** icons related ***/\n"; 
echo "    this.iconPath = \"icons/\";\n"; 
echo "    this.iconWidth = 29; //25;\n"; 
echo "    this.iconHeight = 25; //22;\n"; 
echo "    /*** /icons related ***/\n"; 
echo "\n"; 
echo "    this.dropTopAdjustment_moz = 0;\n"; 
echo "    this.dropLeftAdjustment_moz = 0;\n"; 
echo "\n"; 
echo "    this.applyColor = applyColor;\n"; 
echo "    this.oColor1 = new ColorPicker(\"oColor1\", this.oName); //to call: oEdit1.oColor1\n"; 
echo "    this.oColor2 = new ColorPicker(\"oColor2\", this.oName); //rendered id: ...oColor1oEdit1\n"; 
echo "    this.expandSelection = expandSelection;\n"; 
echo "\n"; 
echo "    this.useLastForeColor = false;\n"; 
echo "    this.useLastBackColor = false;\n"; 
echo "    this.stateForeColor = \"\";\n"; 
echo "    this.stateBackColor = \"\";\n"; 
echo "\n"; 
echo "    this.fullScreen = fullScreen;\n"; 
echo "    this.stateFullScreen = false;\n"; 
echo "\n"; 
echo "    this.getElm = iwe_getElm;\n"; 
echo "\n"; 
echo "    this.features = [];\n"; 
echo "\n"; 
echo "    /* Untuk Realtime masih diperlukan */\n"; 
echo "    //diff: btnSearch, btnCut, btnCopy, btnPaste, btnGuidelines\n"; 
echo "    this.btnParagraph = false; this.btnFontName = false; this.btnFontSize = false;\n"; 
echo "    this.btnCut = false; this.btnCopy = false; this.btnPaste = false; this.btnPasteText = false; this.btnUndo = false; this.btnRedo = false;\n"; 
echo "    this.btnBold = false; this.btnItalic = false; this.btnUnderline = false;\n"; 
echo "    this.btnStrikethrough = false; this.btnSuperscript = false; this.btnSubscript = false;\n"; 
echo "    this.btnJustifyLeft = false; this.btnJustifyCenter = false; this.btnJustifyRight = false; this.btnJustifyFull = false;\n"; 
echo "    this.btnNumbering = false; this.btnBullets = false; this.btnIndent = false; this.btnOutdent = false;\n"; 
echo "    this.btnLTR = false; this.btnRTL = false;\n"; 
echo "    this.btnForeColor = false; this.btnBackColor = false;\n"; 
echo "    this.btnTable = false; this.btnLine = false;\n"; 
echo "\n"; 
echo "    this.tabs = [\n"; 
echo "        [\"tabHome\", \"Home\", [\"group1\", \"group2\", \"group4\"]],\n"; 
echo "        [\"tabStyle\", \"Insert\", [\"group3\"]]\n"; 
echo "    ];\n"; 
echo "\n"; 
echo "    this.groups = [\n"; 
echo "        [\"group1\", \"\", [\"Bold\", \"Italic\", \"Underline\", \"FontDialog\", \"ForeColor\", \"TextDialog\", \"RemoveFormat\"]],\n"; 
echo "        [\"group2\", \"\", [\"Bullets\", \"Numbering\", \"JustifyLeft\", \"JustifyCenter\", \"JustifyRight\"]],\n"; 
echo "        [\"group3\", \"\", [\"LinkDialog\", \"ImageDialog\", \"Table\", \"TableDialog\"]],\n"; 
echo "        [\"group4\", \"\", [\"Undo\", \"Redo\", \"FullScreen\", \"SourceDialog\"]]\n"; 
echo "    ];\n"; 
echo "\n"; 
echo "    this.toolbarMode = 2; //0:standard, 1:tab, 2:group\n"; 
echo "    this.showResizeBar = true;\n"; 
echo "\n"; 
echo "    this.pasteTextOnCtrlV = false;\n"; 
echo "\n"; 
echo "    this.dialogSize = {\n"; 
echo "        \"Preview\": { w: 900, h: 600 },\n"; 
echo "        \"TableDialog\": { w: 785, h: 500 },\n"; 
echo "        \"ImageDialog\": { w: 755, h: 545 },\n"; 
echo "        \"TextDialog\": { w: 375, h: 475 },\n"; 
echo "        \"YoutubeDialog\": { w: 421, h: 545 },\n"; 
echo "        \"LinkDialog\": { w: 605, h: 475 },\n"; 
echo "        \"SourceDialog\": { w: 700, h: 450 },\n"; 
echo "        \"CompleteTextDialog\": { w: 815, h: 470 },\n"; 
echo "        \"FontDialog\": { w: 500, h: 470 },\n"; 
echo "        \"FlashDialog\": { w: 390, h: 195 },\n"; 
echo "        \"BookmarkDialog\": { w: 360, h: 240 },\n"; 
echo "        \"CharsDialog\": { w: 700, h: 122 },\n"; 
echo "        \"SearchDialog\": { w: 370, h: 140 }\n"; 
echo "    };\n"; 
echo "\n"; 
echo "    this.setDialogSize = function (name, dim) {\n"; 
echo "        this.dialogSize[name] = dim;\n"; 
echo "    };\n"; 
echo "\n"; 
echo "    //*** CMS FUNCTIONS ***\n"; 
echo "    this.fileBrowser = \"\";\n"; 
echo "    this.enableFlickr = false;\n"; 
echo "    this.enableImageStyles = true;\n"; 
echo "    this.enableYTVideoStyles = true;\n"; 
echo "    this.enableCssButtons = false;\n"; 
echo "    this.enableLightbox = false;\n"; 
echo "    this.enableTableAutoformat = false;\n"; 
echo "    this.flickrUser = \"ysw.insite\";\n"; 
echo "    this.cmdAssetManager = \"\";\n"; 
echo "    this.cmdFileManager = \"\";\n"; 
echo "    this.cmdImageManager = \"\";\n"; 
echo "    this.cmdMediaManager = \"\";\n"; 
echo "    this.cmdFlashManager = \"\";\n"; 
echo "\n"; 
echo "    this.btnContentBlock = false;\n"; 
echo "    this.cmdContentBlock = \";\"; //needs ;\n"; 
echo "    this.btnInternalLink = false;\n"; 
echo "    this.cmdInternalLink = \";\"; //needs ;\n"; 
echo "    this.insertLink = insertLink;\n"; 
echo "    this.btnCustomObject = false;\n"; 
echo "    this.cmdCustomObject = \";\"; //needs ;\n"; 
echo "    this.btnInternalImage = false;\n"; 
echo "    this.cmdInternalImage = \";\"; //needs ;\n"; 
echo "    //**********\n"; 
echo "\n"; 
echo "    this.arrStyle = [];\n"; 
echo "    this.isCssLoaded = false;\n"; 
echo "    this.openStyleSelect = openStyleSelect;\n"; 
echo "\n"; 
echo "    this.arrParagraph = [[getTxt(\"Heading 1\"), \"H1\"],\n"; 
echo "        [getTxt(\"Heading 2\"), \"H2\"],\n"; 
echo "        [getTxt(\"Heading 3\"), \"H3\"],\n"; 
echo "        [getTxt(\"Heading 4\"), \"H4\"],\n"; 
echo "        [getTxt(\"Heading 5\"), \"H5\"],\n"; 
echo "        [getTxt(\"Heading 6\"), \"H6\"],\n"; 
echo "        [getTxt(\"Preformatted\"), \"PRE\"],\n"; 
echo "        [getTxt(\"Normal (P)\"), \"P\"],\n"; 
echo "        [getTxt(\"Normal (DIV)\"), \"DIV\"]];\n"; 
echo "\n"; 
echo "    //    this.arrFontName = [\"Arial\", \"Arial Black\", \"Arial Narrow\",\n"; 
echo "    //        \"Book Antiqua\", \"Bookman Old Style\", \"Century Gothic\",\n"; 
echo "    //        \"Comic Sans MS\", \"Courier New\", \"Franklin Gothic Medium\",\n"; 
echo "    //        \"Garamond\", \"Georgia\", \"Impact\", \"Lucida Console\",\n"; 
echo "    //        \"Lucida Sans\", \"Lucida Unicode\", \"Modern\",\n"; 
echo "    //        \"Monotype Corsiva\", \"Palatino Linotype\", \"Roman\",\n"; 
echo "    //        \"Script\", \"Small Fonts\", \"Symbol\", \"Tahoma\",\n"; 
echo "    //        \"Times New Roman\", \"Trebuchet MS\", \"Verdana\",\n"; 
echo "    //        \"Webdings\", \"Wingdings\", \"serif\", \"sans-serif\",\n"; 
echo "    //        \"cursive\", \"fantasy\", \"monospace\"];\n"; 
echo "    this.arrFontName = [\"Impact, Charcoal, sans-serif\", \"Palatino Linotype, Book Antiqua, Palatino, serif\", \"Tahoma, Geneva, sans-serif\",\n"; 
echo "        \"Century Gothic, sans-serif\", \"Lucida Sans Unicode, Lucida Grande, sans-serif\", \"Times New Roman, Times, serif\",\n"; 
echo "        \"Arial Narrow, sans-serif\", \"Verdana, Geneva, sans-serif\", \"Copperplate Gothic Light, sans-serif\",\n"; 
echo "        \"Lucida Console, Monaco, monospace\", \"Gill Sans MT, sans-serif\", \"Trebuchet MS, Helvetica, sans-serif\", \"Courier New, Courier, monospace\",\n"; 
echo "        \"Arial, Helvetica, sans-serif\", \"Georgia, Serif\", \"Garamond, Serif\"];\n"; 
echo "\n"; 
echo "    this.arrFontSize = [[getTxt(\"Size 1\"), \"8pt\"],\n"; 
echo "        [getTxt(\"Size 2\"), \"10pt\"],\n"; 
echo "        [getTxt(\"Size 3\"), \"12pt\"],\n"; 
echo "        [getTxt(\"Size 4\"), \"14pt\"],\n"; 
echo "        [getTxt(\"Size 5\"), \"18pt\"],\n"; 
echo "        [getTxt(\"Size 6\"), \"24pt\"],\n"; 
echo "        [getTxt(\"Size 7\"), \"36pt\"]];\n"; 
echo "\n"; 
echo "    this.arrCustomTag = []; //eg.[[\"Full Name\",\"{%full_name%}\"],[\"Email\",\"{%email%}\"]];\n"; 
echo "\n"; 
echo "    this.docType = \"<!DOCTYPE html PUBLIC \\"-//W3C//DTD XHTML 1.0 Transitional//EN\\" \\"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd\\">\";\n"; 
echo "    this.html = \"<html>\";\n"; 
echo "    this.headContent = \"\";\n"; 
echo "    this.preloadHTML = \"\";\n"; 
echo "    this.originalContent = \"\";\n"; 
echo "    this.isContentChanged = isContentChanged;\n"; 
echo "\n"; 
echo "    this.onSave = function () { document.getElementById(\"iwe_btnSubmit\" + this.oName).click() };\n"; 
echo "    this.useBR = false;\n"; 
echo "    this.useDIV = true;\n"; 
echo "    this.returnKeyMode = -1; //0:default, 1:div, 2:br, 3:p    \n"; 
echo "\n"; 
echo "    this.onFullScreen = function () { return true; };\n"; 
echo "    this.onNormalScreen = function () { return true; };\n"; 
echo "\n"; 
echo "    this.initialRefresh = false; //not used\n"; 
echo "\n"; 
echo "    this.doUndo = doUndo;\n"; 
echo "    this.doRedo = doRedo;\n"; 
echo "    this.saveForUndo = saveForUndo;\n"; 
echo "    this.doUndoRedo = doUndoRedo;\n"; 
echo "\n"; 
echo "    this.arrUndoList = [];\n"; 
echo "    this.arrRedoList = [];\n"; 
echo "\n"; 
echo "    this.useTagSelector = true;\n"; 
echo "    this.TagSelectorPosition = \"bottom\";\n"; 
echo "    this.moveTagSelector = moveTagSelector;\n"; 
echo "    this.selectElement = selectElement;\n"; 
echo "    this.removeTag = removeTag;\n"; 
echo "    this.doClick_TabCreate = doClick_TabCreate;\n"; 
echo "    this.doRefresh_TabCreate = doRefresh_TabCreate;\n"; 
echo "\n"; 
echo "    this.arrCustomButtons = [[\"CustomName1\", \"alert(0)\", \"caption here\", \"btnSave.gif\"],\n"; 
echo "                            [\"CustomName2\", \"alert(0)\", \"caption here\", \"btnSave.gif\"]];\n"; 
echo "\n"; 
echo "    this.customDialogShow = customDialogShow;\n"; 
echo "    this.customDialog = [];\n"; 
echo "\n"; 
echo "    this.onSelectionChanged = function () { return true; };\n"; 
echo "\n"; 
echo "    this.spellCheckMode = \"ieSpell\";\n"; 
echo "\n"; 
echo "    this.encodeIO = false;\n"; 
echo "    this.changeHeight = changeHeight;\n"; 
echo "\n"; 
echo "    this.fixWord = fixWord;\n"; 
echo "\n"; 
echo "    this.REPLACE = REPLACE;\n"; 
echo "    this.mode = \"XHTMLBody\";\n"; 
echo "    this.idTextArea;\n"; 
echo "\n"; 
echo "    var me = this;\n"; 
echo "    this.tbar = new ISToolbarManager(this.oName);\n"; 
echo "    this.tbar.iconPath = this.scriptPath.substring(0, this.scriptPath.indexOf(\"saf/\")) + this.iconPath;\n"; 
echo "\n"; 
echo "    editor[editor.length] = this;\n"; 
echo "    return this;\n"; 
echo "};\n"; 
echo "\n"; 
echo "function changeActiveEditor(oName) {\n"; 
echo "    var edtObj = eval(oName);\n"; 
echo "    var edtFrm = document.getElementById(\"idContent\" + oName);\n"; 
echo "\n"; 
echo "    oUtil.activeElement = null; //focus ke editor, jgn pakai selection dari tag selector\n"; 
echo "    oUtil.oName = oName;\n"; 
echo "    oUtil.oEditor = edtFrm.contentWindow;\n"; 
echo "    oUtil.obj = edtObj;\n"; 
echo "    edtObj.hide(); //pengganti onfocus\n"; 
echo "}\n"; 
echo "\n"; 
echo "/*** Undo/Redo ***/\n"; 
echo "function saveForUndo() {\n"; 
echo "    var oEditor = document.getElementById(\"idContent\" + this.oName).contentWindow;\n"; 
echo "    var obj = this;\n"; 
echo "    if (obj.arrUndoList[0])\n"; 
echo "        if (oEditor.document.body.innerHTML == obj.arrUndoList[0][0]) return;\n"; 
echo "    for (var i = 20; i > 1; i--) obj.arrUndoList[i - 1] = obj.arrUndoList[i - 2];\n"; 
echo "    obj.focus();\n"; 
echo "    var oSel = oEditor.getSelection();\n"; 
echo "    var range = oSel.getRangeAt(0);\n"; 
echo "    obj.arrUndoList[0] = [oEditor.document.body.innerHTML, range.cloneRange()];\n"; 
echo "    //obj.arrUndoList[0] = [oEditor.document.body.innerHTML, null];\n"; 
echo "\n"; 
echo "    this.arrRedoList = []; //clear redo list\n"; 
echo "\n"; 
echo "    if (this.btnUndo) this.tbar.btns[\"btnUndo\" + this.oName].setState(1);\n"; 
echo "    if (this.btnRedo) this.tbar.btns[\"btnRedo\" + this.oName].setState(5);\n"; 
echo "};\n"; 
echo "function doUndo() {\n"; 
echo "    this.doUndoRedo(this.arrUndoList, this.arrRedoList);\n"; 
echo "};\n"; 
echo "\n"; 
echo "function doRedo() {\n"; 
echo "    this.doUndoRedo(this.arrRedoList, this.arrUndoList);\n"; 
echo "};\n"; 
echo "function doUndoRedo(listA, listB) {\n"; 
echo "    var oEditor = document.getElementById(\"idContent\" + this.oName).contentWindow;\n"; 
echo "    var obj = this;\n"; 
echo "    if (!listA[0]) return; //return of undo/redo array empty\n"; 
echo "\n"; 
echo "    for (var i = 20; i > 1; i--) listB[i - 1] = listB[i - 2];\n"; 
echo "    var oSel = oEditor.getSelection();\n"; 
echo "    var range = oSel.getRangeAt(0);\n"; 
echo "    listB[0] = [oEditor.document.body.innerHTML, range.cloneRange()];\n"; 
echo "\n"; 
echo "    sHTML = listA[0][0];\n"; 
echo "\n"; 
echo "    oEditor.document.body.innerHTML = sHTML;\n"; 
echo "\n"; 
echo "    oSel = oEditor.getSelection();\n"; 
echo "    oSel.removeAllRanges();\n"; 
echo "    oSel.addRange(listA[0][1]);\n"; 
echo "\n"; 
echo "    for (var i = 0; i < 19; i++) listA[i] = listA[i + 1];\n"; 
echo "    listA[19] = null;\n"; 
echo "    realTime(this);\n"; 
echo "};\n"; 
echo "\n"; 
echo "/*** RENDER ***/\n"; 
echo "var bOnSubmitOriginalSaved = false;\n"; 
echo "function REPLACE(idTextArea, dvId) {\n"; 
echo "    this.idTextArea = idTextArea;\n"; 
echo "    var oTextArea = document.getElementById(idTextArea);\n"; 
echo "    oTextArea.style.display = \"none\";\n"; 
echo "    var oForm = oTextArea.form;\n"; 
echo "    if (oForm) {\n"; 
echo "        if (!bOnSubmitOriginalSaved) {\n"; 
echo "            if (oForm.onsubmit)\n"; 
echo "                onsubmit_original = oForm.onsubmit;\n"; 
echo "\n"; 
echo "            bOnSubmitOriginalSaved = true;\n"; 
echo "        }\n"; 
echo "        oForm.onsubmit = new Function(\"return onsubmit_new()\");\n"; 
echo "    }\n"; 
echo "\n"; 
echo "    var sContent = document.getElementById(idTextArea).value + \" \";\n"; 
echo "    sContent = sContent.replace(/&/g, \"&amp;\");\n"; 
echo "    sContent = sContent.replace(/</g, \"&lt;\");\n"; 
echo "    sContent = sContent.replace(/>/g, \"&gt;\");\n"; 
echo "\n"; 
echo "    this.RENDER(sContent, dvId);\n"; 
echo "};\n"; 
echo "\n"; 
echo "function isContentChanged() {\n"; 
echo "\n"; 
echo "    var sContent = \"\";\n"; 
echo "    if (this.mode == \"HTMLBody\") { sContent = this.getHTMLBody(); } else\n"; 
echo "        if (this.mode == \"HTML\") { sContent = this.getHTML(); } else\n"; 
echo "            if (this.mode == \"XHTMLBody\") { sContent = this.getXHTMLBody(); } else\n"; 
echo "                if (this.mode == \"XHTML\") { sContent = this.getXHTML(); }\n"; 
echo "\n"; 
echo "    if (sContent != this.originalContent) {\n"; 
echo "        return true;\n"; 
echo "    }\n"; 
echo "    return false;\n"; 
echo "};\n"; 
echo "\n"; 
echo "function onsubmit_new() {\n"; 
echo "    var sContent;\n"; 
echo "    for (var i = 0; i < oUtil.arrEditor.length; i++) {\n"; 
echo "		\n"; 
echo "		if(!document.getElementById(\"idContent\" + oUtil.arrEditor[i])) continue;\n"; 
echo "		\n"; 
echo "        var oEdit = eval(oUtil.arrEditor[i]);\n"; 
echo "        if (oEdit.mode == \"HTMLBody\") sContent = oEdit.getHTMLBody();\n"; 
echo "        if (oEdit.mode == \"HTML\") sContent = oEdit.getHTML();\n"; 
echo "        if (oEdit.mode == \"XHTMLBody\") sContent = oEdit.getXHTMLBody();\n"; 
echo "        if (oEdit.mode == \"XHTML\") sContent = oEdit.getXHTML();\n"; 
echo "        document.getElementById(oEdit.idTextArea).value = sContent;\n"; 
echo "    }\n"; 
echo "    if (onsubmit_original) return onsubmit_original();\n"; 
echo "};\n"; 
echo "function onsubmit_original() { };\n"; 
echo "\n"; 
echo "function RENDER(sPreloadHTML, dvId) {\n"; 
echo "    /*** icons related ***/\n"; 
echo "    iconHeight = this.iconHeight;\n"; 
echo "\n"; 
echo "    /*** Tetap Ada (For downgrade compatibility) ***/\n"; 
echo "    if (sPreloadHTML.substring(0, 4) == \"<!--\" && sPreloadHTML.substring(sPreloadHTML.length - 3) == \"-->\")\n"; 
echo "        sPreloadHTML = sPreloadHTML.substring(4, sPreloadHTML.length - 3);\n"; 
echo "\n"; 
echo "    if (sPreloadHTML.substring(0, 4) == \"<!--\" && sPreloadHTML.substring(sPreloadHTML.length - 6) == \"--&gt;\")\n"; 
echo "        sPreloadHTML = sPreloadHTML.substring(4, sPreloadHTML.length - 6);\n"; 
echo "\n"; 
echo "    /*** Converting back HTML-encoded content (kalau tdk encoded tdk masalah) ***/\n"; 
echo "    sPreloadHTML = sPreloadHTML.replace(/&lt;/g, \"<\");\n"; 
echo "    sPreloadHTML = sPreloadHTML.replace(/&gt;/g, \">\");\n"; 
echo "    sPreloadHTML = sPreloadHTML.replace(/&amp;/g, \"&\");\n"; 
echo "\n"; 
echo "    /*** features ***/\n"; 
echo "    /*** /features ***/\n"; 
echo "\n"; 
echo "    this.preloadHTML = sPreloadHTML;\n"; 
echo "\n"; 
echo "    var sHTMLDropMenus = \"\";\n"; 
echo "    var sHTMLIcons = \"\";\n"; 
echo "    var sTmp = \"\";\n"; 
echo "\n"; 
echo "    //Render Color Picker (forecolor)\n"; 
echo "    this.oColor1.onShow = new Function(this.oName + \".hide()\");\n"; 
echo "    this.oColor1.onPickColor = new Function(this.oName + \".applyColor('ForeColor', \" + this.oName + \".oColor1.color)\");\n"; 
echo "    this.oColor1.onRemoveColor = new Function(this.oName + \".applyColor('ForeColor','')\");\n"; 
echo "\n"; 
echo "    //Render Color Picker (backcolor)\n"; 
echo "    this.oColor2.onShow = new Function(this.oName + \".hide()\");\n"; 
echo "    this.oColor2.onPickColor = new Function(this.oName + \".applyColor('hilitecolor', \" + this.oName + \".oColor2.color)\");\n"; 
echo "    this.oColor2.onRemoveColor = new Function(this.oName + \".applyColor('HiliteColor','')\");\n"; 
echo "\n"; 
echo "    var me = this;\n"; 
echo "\n"; 
echo "    /* Toolbar Mode: 1 (tab) or 2 (group) */\n"; 
echo "    var tmp = null, tmpTb, grpMap = new Object();\n"; 
echo "    //create toolbar.\n"; 
echo "    for (var i = 0; i < this.groups.length; i++) {\n"; 
echo "        tmp = this.groups[i];\n"; 
echo "        tmpTb = this.tbar.createToolbar(this.oName + \"tbar\" + tmp[0]);\n"; 
echo "        tmpTb.onClick = function (id) { tbAction(tmpTb, id, me, me.oName); };\n"; 
echo "        tmpTb.style.toolbar = \"main_istoolbar\";\n"; 
echo "        tmpTb.iconPath = this.scriptPath.substring(0, this.scriptPath.indexOf(\"saf/\")) + this.iconPath;\n"; 
echo "        tmpTb.btnWidth = this.iconWidth;\n"; 
echo "        tmpTb.btnHeight = this.iconHeight;\n"; 
echo "        for (var j = 0; j < tmp[2].length; j++) {\n"; 
echo "            eval(this.oName + \".btn\" + tmp[2][j] + \"=true\");\n"; 
echo "        }\n"; 
echo "        buildToolbar(tmpTb, this, tmp[2]);\n"; 
echo "        grpMap[tmp[0]] = tmp[1];\n"; 
echo "    }\n"; 
echo "    //create tab\n"; 
echo "    if (this.toolbarMode == 1) {\n"; 
echo "        var eTab = this.tbar.createTbTab(\"tabCtl\" + this.oName), tmpGrp;\n"; 
echo "        for (var i = 0; i < this.tabs.length; i++) {\n"; 
echo "            tmp = this.tabs[i];\n"; 
echo "            tmpGrp = this.tbar.createTbGroup(this.oName + \"grp\" + tmp[0]);\n"; 
echo "            for (var j = 0; j < tmp[2].length; j++) {\n"; 
echo "                tmpGrp.addGroup(this.oName + tmp[2][j], grpMap[tmp[2][j]], this.oName + \"tbar\" + tmp[2][j]);\n"; 
echo "            }\n"; 
echo "            eTab.addTab(this.oName + tmp[0], tmp[1], tmpGrp);\n"; 
echo "        }\n"; 
echo "    } else if (this.groups.length > 0) {\n"; 
echo "        var tmpGrp;\n"; 
echo "        tmpGrp = this.tbar.createTbGroup(this.oName + \"grp\");\n"; 
echo "        for (var i = 0; i < this.groups.length; i++) {\n"; 
echo "            tmp = this.groups[i];\n"; 
echo "            tmpGrp.addGroup(this.oName + tmp[0], grpMap[tmp[0]], this.oName + \"tbar\" + tmp[0]);\n"; 
echo "        }\n"; 
echo "        if (this.toolbarMode == 3) {\n"; 
echo "            tmpGrp.groupFlow = true;\n"; 
echo "        }\n"; 
echo "        if (this.toolbarMode == 4) {\n"; 
echo "            tmpGrp.groupFlow = true;\n"; 
echo "            tmpGrp.draggable = true;\n"; 
echo "        }\n"; 
echo "    }\n"; 
echo "    /*******/\n"; 
echo "\n"; 
echo "    var sHTML = \"\";\n"; 
echo "    var icPath = this.scriptPath.substring(0, this.scriptPath.indexOf(\"saf/\")) + this.iconPath;\n"; 
echo "\n"; 
echo "    if (!document.getElementById(\"id_refresh_z_index\"))\n"; 
echo "        sHTML += \"<div id=id_refresh_z_index style='margin:0px'></div>\";\n"; 
echo "\n"; 
echo "    sHTML += \"<table id=idArea\" + this.oName + \" name=idArea\" + this.oName + \" border='0px' \" +\n"; 
echo "            \"cellpadding=0 cellspacing=0 width='\" + this.width + \"' height='\" + this.height + \"' style='width:\" + this.width + \";height:\" + this.height + \";border:none;border-bottom:solid 1px #cfcfcf'>\" +\n"; 
echo "            \"<tr><td colspan=2 style=\\"padding:0px;border:#cfcfcf 0px solid;background:url('\" + icPath + \"bg.gif')\\">\" +\n"; 
echo "            \"<table cellpadding=0 cellspacing=0 border=0 width='100%'  style='border:none;margin:0px'><tr><td dir=ltr style='padding:0px;'>\" +\n"; 
echo "            this.tbar.render() +\n"; 
echo "            \"</td></tr></table>\" +\n"; 
echo "            \"</td></tr>\" +\n"; 
echo "            \"<tr id=idTagSelTopRow\" + this.oName + \"><td colspan=2 id=idTagSelTop\" + this.oName + \" height=0px style='color:#000000;padding:0px;'></td></tr>\";\n"; 
echo "\n"; 
echo "\n"; 
echo "    sHTML += \"<tr style='width:100%;height:100%'><td colspan=2 valign=top height=100% style='padding:0px;background:white;padding-right:0px;'>\";\n"; 
echo "\n"; 
echo "    sHTML += \"<table id='cntContainer\" + this.oName + \"' cellpadding=0 cellspacing=0 width='100%' height='100%' style='margin-top:0px;border:none;'><tr style='width:100%;height:100%'><td width='100%' height='100%' style='padding:0px;border:solid 1px #cfcfcf;border-bottom:none'>\"; //StyleSelect\n"; 
echo "\n"; 
echo "    sHTML += \"<iframe frameborder='no' style='width:100%;height:100%;' \" +\n"; 
echo "            \" name=idContent\" + this.oName + \" id=idContent\" + this.oName + \" src='\" + this.scriptPath + \"blank.gif'></iframe>\";\n"; 
echo "\n"; 
echo "    sHTML += \"<iframe style='display:none;width:1px;height:1px;overflow:auto;border:0px' id=\\"myStyle\" + this.oName + \"\\" name=\\"myStyle\" + this.oName + \"\\" src='\" + this.scriptPath + \"blank.gif'></iframe>\";\n"; 
echo "\n"; 
echo "    sHTML += \"</td><td id=idStyles\" + this.oName + \" style='padding:0px;background:#f4f4f4'></td></tr></table>\"; //StyleSelect\n"; 
echo "\n"; 
echo "    sHTML += \"</td></tr>\";\n"; 
echo "    sHTML += \"<tr id=idTagSelBottomRow\" + this.oName + \"><td colspan=2 id=idTagSelBottom\" + this.oName + \" style='color:#000000;padding:0px;'></td></tr>\";\n"; 
echo "    if (this.showResizeBar) {\n"; 
echo "        sHTML += \"<tr id=idResizeBar\" + this.oName + \"><td colspan=2 style='padding:0px;'><div  style='cursor:n-resize;' class='resize_bar' onmousedown=\\"onEditorStartResize(event, this, '\" + this.oName + \"')\\" ></div></td></tr>\";\n"; 
echo "    }\n"; 
echo "    sHTML += \"</table>\";\n"; 
echo "\n"; 
echo "    sHTML += sHTMLDropMenus; //dropdown\n"; 
echo "\n"; 
echo "    sHTML += \"<input type=submit name=iwe_btnSubmit\" + this.oName + \" id=iwe_btnSubmit\" + this.oName + \" value=SUBMIT style='display:none' >\"; //hidden submit button\n"; 
echo "\n"; 
echo "    if (dvId) {\n"; 
echo "        var edtStr = [];\n"; 
echo "        edtStr[0] = sHTML;\n"; 
echo "        document.getElementById(dvId).innerHTML = edtStr.join(\"\");\n"; 
echo "    } else {\n"; 
echo "        document.write(sHTML);\n"; 
echo "    }\n"; 
echo "\n"; 
echo "    /*var clPick=document.getElementById(\"isClPiker\"+this.oName);\n"; 
echo "    if(!clPick) { \n"; 
echo "    clPick = document.createElement(\"DIV\");\n"; 
echo "    clPick.id=\"isClPiker\"+this.oName;\n"; 
echo "    clPick.innerHTML=this.oColor1.generateHTML() + this.oColor2.generateHTML();\n"; 
echo "    document.body.insertBefore(clPick, document.body.childNodes[0]);\n"; 
echo "    }\n"; 
echo "    */\n"; 
echo "\n"; 
echo "    this.init();\n"; 
echo "\n"; 
echo "};\n"; 
echo "\n"; 
echo "/*=====================================*/\n"; 
echo "/*=========RESIZE TOOLBAR DRAG=========*/\n"; 
echo "/*=====================================*/\n"; 
echo "\n"; 
echo "function onEditorStartResize(ev, elm, oName) {\n"; 
echo "\n"; 
echo "    document.onmousemove = onEditorResize;\n"; 
echo "    document.onmouseup = onEditorStopResize;\n"; 
echo "    document.onselectstart = function () { return false; };\n"; 
echo "    document.ondragstart = function () { return false; };\n"; 
echo "    document.body.style.cursor = \"n-resize\";\n"; 
echo "\n"; 
echo "    oUtil.currentResized = eval(oName);\n"; 
echo "    oUtil.resizeInit = { x: ev.screenX, y: ev.screenY };\n"; 
echo "    if (!oUtil.isWindow) oUtil.isWindow = new ISWindow(oName);\n"; 
echo "\n"; 
echo "    oUtil.isWindow.showOverlay();\n"; 
echo "\n"; 
echo "};\n"; 
echo "\n"; 
echo "function onEditorStopResize(event) {\n"; 
echo "\n"; 
echo "    oUtil.resizeOffset = { dx: event.screenX - oUtil.resizeInit.x, dy: event.screenY - oUtil.resizeInit.y };\n"; 
echo "    oUtil.currentResized.changeHeight(oUtil.resizeOffset.dy);\n"; 
echo "\n"; 
echo "    oUtil.isWindow.hideOverlay();\n"; 
echo "\n"; 
echo "    document.onmousemove = null;\n"; 
echo "    document.onmouseup = null;\n"; 
echo "    document.body.style.cursor = \"default\";\n"; 
echo "};\n"; 
echo "\n"; 
echo "function onEditorResize(event) {\n"; 
echo "\n"; 
echo "    oUtil.resizeOffset = { dx: event.screenX - oUtil.resizeInit.x, dy: event.screenY - oUtil.resizeInit.y };\n"; 
echo "    oUtil.currentResized.changeHeight(oUtil.resizeOffset.dy);\n"; 
echo "    oUtil.resizeInit = { x: event.screenX, y: event.screenY };\n"; 
echo "\n"; 
echo "};\n"; 
echo "\n"; 
echo "/*=====================================*/\n"; 
echo "/*======END OF RESIZE TOOLBAR DRAG=====*/\n"; 
echo "/*=====================================*/\n"; 
echo "\n"; 
echo "function initISEditor() {\n"; 
echo "\n"; 
echo "    if (this.useTagSelector) {\n"; 
echo "        if (this.TagSelectorPosition == \"bottom\") this.TagSelectorPosition = \"top\";\n"; 
echo "        else this.TagSelectorPosition = \"bottom\";\n"; 
echo "        this.moveTagSelector();\n"; 
echo "    }\n"; 
echo "\n"; 
echo "    var oEditor = document.getElementById(\"idContent\" + this.oName).contentWindow;\n"; 
echo "\n"; 
echo "    oUtil.oName = this.oName; //default active editor\n"; 
echo "    oUtil.oEditor = oEditor;\n"; 
echo "    oUtil.obj = this;\n"; 
echo "\n"; 
echo "    oUtil.arrEditor.push(this.oName);\n"; 
echo "\n"; 
echo "    var arrA = String(this.preloadHTML).match(/<HTML[^>]*>/ig);\n"; 
echo "    if (arrA) {//full html\n"; 
echo "        //this.putHTML(this.preloadHTML);\n"; 
echo "        this.loadHTMLFull(this.preloadHTML);\n"; 
echo "    }\n"; 
echo "    else {\n"; 
echo "        this.loadHTML(this.preloadHTML);\n"; 
echo "    }\n"; 
echo "\n"; 
echo "    /***** Replace current body onload ******/\n"; 
echo "    if (!oUtil.bOnLoadReplaced) {\n"; 
echo "        if (window.onload) onload_original = window.onload;\n"; 
echo "        window.onload = new Function(\"onload_new()\");\n"; 
echo "        oUtil.bOnLoadReplaced = true;\n"; 
echo "    }\n"; 
echo "    /****************************************/\n"; 
echo "    try { oEditor.document.body.contentEditable = true; } catch (e) { }\n"; 
echo "\n"; 
echo "    try {\n"; 
echo "        var cnt = oEditor.document.body.innerHTML;\n"; 
echo "        cnt = cnt.replace(/\s+/gi, \"\");\n"; 
echo "        if (cnt == \"\") {\n"; 
echo "            oEditor.document.body.innerHTML = \"<br class=\\"innova\\" />\";\n"; 
echo "        }\n"; 
echo "\n"; 
echo "        var range = oEditor.document.createRange();\n"; 
echo "        range.selectNode(oEditor.document.body.childNodes[0]);\n"; 
echo "        range.collapse(true);\n"; 
echo "\n"; 
echo "        var sel = oEditor.getSelection();\n"; 
echo "        sel.removeAllRanges();\n"; 
echo "        sel.addRange(range);\n"; 
echo "\n"; 
echo "    } catch (e) { }\n"; 
echo "\n"; 
echo "    //get original editor content.\n"; 
echo "    switch (this.mode) {\n"; 
echo "        case \"HTMLBody\": this.originalContent = this.getHTMLBody(); break;\n"; 
echo "        case \"HTML\": this.originalContent = this.getHTML(); break;\n"; 
echo "        case \"XHTMLBody\": this.originalContent = this.getXHTMLBody(); break;\n"; 
echo "        case \"XHTML\": this.originalContent = this.getXHTML(); break;\n"; 
echo "    };\n"; 
echo "\n"; 
echo "    if (this.returnKeyMode == -1) {\n"; 
echo "        if (this.useDIV) this.returnKeyMode = 1;\n"; 
echo "        else if (this.useBR) this.returnKeyMode = 2;\n"; 
echo "        else if (!this.useDIV && !this.useBR) this.returnKeyMode = 3;\n"; 
echo "    }\n"; 
echo "\n"; 
echo "    if (this.disableFocusOnLoad == false) {\n"; 
echo "        this.focus();\n"; 
echo "    }\n"; 
echo "\n"; 
echo "};\n"; 
echo "\n"; 
echo "function buildToolbar(tb, oEdt, btnMap) {\n"; 
echo "    var oName = oEdt.oName;\n"; 
echo "\n"; 
echo "    for (var i = 0; i < btnMap.length; i++) {\n"; 
echo "        sButtonName = btnMap[i];\n"; 
echo "        switch (sButtonName) {\n"; 
echo "            case \"|\":\n"; 
echo "                tb.addSeparator();\n"; 
echo "                break;\n"; 
echo "            case \"BRK\":\n"; 
echo "                tb.addBreak();\n"; 
echo "                break;\n"; 
echo "            case \"FullScreen\":\n"; 
echo "                tb.addButton(\"btnFullScreen\" + oName, \"btnFullScreen.gif\", getTxt(\"Full Screen\"));\n"; 
echo "                break;\n"; 
echo "            case \"Print\":\n"; 
echo "                tb.addButton(\"btnPrint\" + oName, \"btnPrint.gif\", getTxt(\"Print\"));\n"; 
echo "                break;\n"; 
echo "            case \"Search\":\n"; 
echo "                tb.addButton(\"btnSearch\" + oName, \"btnSearch.gif\", getTxt(\"Search\"));\n"; 
echo "                break;\n"; 
echo "            case \"SpellCheck\":\n"; 
echo "                if (oEdt.spellCheckMode != \"ieSpell\") tb.addButton(\"btnSpellCheck\" + oName, \"btnSpellCheck.gif\", getTxt(\"Check Spelling\"));\n"; 
echo "                break;\n"; 
echo "            case \"Styles\":\n"; 
echo "                tb.addButton(\"btnStyles\" + oName, \"btnStyleSelect.gif\", getTxt(\"Style Selection\"));\n"; 
echo "                break;\n"; 
echo "            case \"Paragraph\":\n"; 
echo "                tb.addDropdownButton(\"btnParagraph\" + oName, \"ddParagraph\" + oName, \"btnParagraph.gif\", getTxt(\"Paragraph\"), 37);\n"; 
echo "                var ddPar = new ISDropdown(\"ddParagraph\" + oName);\n"; 
echo "                ddPar.onClick = function (id) { ddAction(tb, id, oEdt, oEdt.oName) };\n"; 
echo "                for (var j = 0; j < oEdt.arrParagraph.length; j++) {\n"; 
echo "                    ddPar.addItem(\"btnParagraph_\" + j + oName,\n"; 
echo "                    \"<\" + oEdt.arrParagraph[j][1] + \" style=\\"\margin-bottom:4px\\"  unselectable=on> \" +\n"; 
echo "                    oEdt.arrParagraph[j][0] + \"</\" + oEdt.arrParagraph[j][1] + \">\");\n"; 
echo "                }\n"; 
echo "                break;\n"; 
echo "            case \"FontName\":\n"; 
echo "                tb.addDropdownButton(\"btnFontName\" + oName, \"ddFontName\" + oName, \"btnFontName.gif\", getTxt(\"Font Name\"), 37);\n"; 
echo "                var ddFont = new ISDropdown(\"ddFontName\" + oName);\n"; 
echo "                ddFont.onClick = function (id) { ddAction(tb, id, oEdt, oEdt.oName) };\n"; 
echo "                for (var j = 0; j < oEdt.arrFontName.length; j++) {\n"; 
echo "                    ddFont.addItem(\"btnFontName_\" + j + oName, \"<span style='font-family:\" + oEdt.arrFontName[j] + \";font-size:12px' unselectable=on>\" + oEdt.arrFontName[j] + \"</span>\");\n"; 
echo "                }\n"; 
echo "                break;\n"; 
echo "            case \"FontSize\":\n"; 
echo "                tb.addDropdownButton(\"btnFontSize\" + oName, \"ddFontSize\" + oName, \"btnFontSize.gif\", getTxt(\"Font Size\"), 37);\n"; 
echo "                var ddFs = new ISDropdown(\"ddFontSize\" + oName);\n"; 
echo "                ddFs.onClick = function (id) { ddAction(tb, id, oEdt, oEdt.oName) };\n"; 
echo "                for (var j = 0; j < oEdt.arrFontSize.length; j++) {\n"; 
echo "                    ddFs.addItem(\"btnFontSize_\" + j + oName,\n"; 
echo "                    \"<div unselectable=on style=\\"font-size:\" + oEdt.arrFontSize[j][1] + \"\\">\" +\n"; 
echo "                    oEdt.arrFontSize[j][0] + \"</div>\");\n"; 
echo "                }\n"; 
echo "                break;\n"; 
echo "            case \"Undo\":\n"; 
echo "                tb.addButton(\"btnUndo\" + oName, \"btnUndo.gif\", getTxt(\"Undo\"));\n"; 
echo "                break;\n"; 
echo "            case \"Redo\":\n"; 
echo "                tb.addButton(\"btnRedo\" + oName, \"btnRedo.gif\", getTxt(\"Redo\"));\n"; 
echo "                break;\n"; 
echo "            case \"Paste\":\n"; 
echo "                tb.addDropdownButton(\"btnPaste\" + oName, \"ddPaste\" + oName, \"btnPaste.gif\", getTxt(\"Paste\"));\n"; 
echo "                var pvDD = new ISDropdown(\"ddPaste\" + oName);\n"; 
echo "                pvDD.iconPath = tb.iconPath;\n"; 
echo "                pvDD.addItem(\"btnPasteClip\" + oName, getTxt(\"Paste\"), \"btnPasteClip.gif\");\n"; 
echo "                pvDD.addItem(\"btnPasteText\" + oName, getTxt(\"Paste Text\"), \"btnPasteText.gif\");\n"; 
echo "                pvDD.onClick = function (id) { ddAction(tb, id, oEdt, oEdt.oName) };\n"; 
echo "                break;\n"; 
echo "            case \"Emoticons\":\n"; 
echo "                tb.addDropdownButton(\"btnEmoticons\" + oName, \"ddEmoticons\" + oName, \"btnEmoticons.gif\", getTxt(\"Emoticons\"));\n"; 
echo "                var ddTable = new ISDropdown(\"ddEmoticons\" + oName);\n"; 
echo "                ddTable.add(new ISCustomDDItem(\"btnInsertEmoticons\", oEdt.GetEmoticons()));\n"; 
echo "                break;\n"; 
echo "            case \"Quote\":\n"; 
echo "                tb.addToggleButton(\"btnQuote\" + oName, \"\", false, \"btnQuote.gif\", getTxt(\"Quote\"));\n"; 
echo "                break;\n"; 
echo "            case \"Bold\":\n"; 
echo "                tb.addToggleButton(\"btnBold\" + oName, \"\", false, \"btnBold.gif\", getTxt(\"Bold\"));\n"; 
echo "                break;\n"; 
echo "            case \"Italic\":\n"; 
echo "                tb.addToggleButton(\"btnItalic\" + oName, \"\", false, \"btnItalic.gif\", getTxt(\"Italic\"));\n"; 
echo "                break;\n"; 
echo "            case \"Underline\":\n"; 
echo "                tb.addToggleButton(\"btnUnderline\" + oName, \"\", false, \"btnUnderline.gif\", getTxt(\"Underline\"));\n"; 
echo "                break;\n"; 
echo "            case \"Strikethrough\":\n"; 
echo "                tb.addToggleButton(\"btnStrikethrough\" + oName, \"\", false, \"btnStrikethrough.gif\", getTxt(\"Strikethrough\"));\n"; 
echo "                break;\n"; 
echo "            case \"Superscript\":\n"; 
echo "                tb.addToggleButton(\"btnSuperscript\" + oName, \"\", false, \"btnSuperscript.gif\", getTxt(\"Superscript\"));\n"; 
echo "                break;\n"; 
echo "            case \"Subscript\":\n"; 
echo "                tb.addToggleButton(\"btnSubscript\" + oName, \"\", false, \"btnSubscript.gif\", getTxt(\"Subscript\"));\n"; 
echo "                break;\n"; 
echo "            case \"JustifyLeft\":\n"; 
echo "                tb.addToggleButton(\"btnJustifyLeft\" + oName, \"align\", false, \"btnLeft.gif\", getTxt(\"Justify Left\"));\n"; 
echo "                break;\n"; 
echo "            case \"JustifyCenter\":\n"; 
echo "                tb.addToggleButton(\"btnJustifyCenter\" + oName, \"align\", false, \"btnCenter.gif\", getTxt(\"Justify Center\"));\n"; 
echo "                break;\n"; 
echo "            case \"JustifyRight\":\n"; 
echo "                tb.addToggleButton(\"btnJustifyRight\" + oName, \"align\", false, \"btnRight.gif\", getTxt(\"Justify Right\"));\n"; 
echo "                break;\n"; 
echo "            case \"JustifyFull\":\n"; 
echo "                tb.addToggleButton(\"btnJustifyFull\" + oName, \"align\", false, \"btnFull.gif\", getTxt(\"Justify Full\"));\n"; 
echo "                break;\n"; 
echo "            case \"Numbering\":\n"; 
echo "                tb.addToggleButton(\"btnNumbering\" + oName, \"bullet\", false, \"btnNumber.gif\", getTxt(\"Numbering\"));\n"; 
echo "                break;\n"; 
echo "            case \"Bullets\":\n"; 
echo "                tb.addToggleButton(\"btnBullets\" + oName, \"bullet\", false, \"btnList.gif\", getTxt(\"Bullets\"));\n"; 
echo "                break;\n"; 
echo "            case \"Indent\":\n"; 
echo "                tb.addButton(\"btnIndent\" + oName, \"btnIndent.gif\", getTxt(\"Indent\"));\n"; 
echo "                break;\n"; 
echo "            case \"Outdent\":\n"; 
echo "                tb.addButton(\"btnOutdent\" + oName, \"btnOutdent.gif\", getTxt(\"Outdent\"));\n"; 
echo "                break;\n"; 
echo "            case \"LTR\":\n"; 
echo "                tb.addToggleButton(\"btnLTR\" + oName, \"dir\", false, \"btnLTR.gif\", getTxt(\"Left To Right\"));\n"; 
echo "                break;\n"; 
echo "            case \"RTL\":\n"; 
echo "                tb.addToggleButton(\"btnRTL\" + oName, \"dir\", false, \"btnRTL.gif\", getTxt(\"Right To Left\"));\n"; 
echo "                break;\n"; 
echo "            case \"ForeColor\":\n"; 
echo "                tb.addDropdownButton(\"btnForeColor\" + oName, \"ddForeColor\" + oName, \"btnForeColor.gif\", getTxt(\"Foreground Color\"));\n"; 
echo "                var ddTable = new ISDropdown(\"ddForeColor\" + oName);\n"; 
echo "                ddTable.add(new ISCustomDDItem(\"btnInsertForeColor\", oEdt.oColor1.generateHTML()));\n"; 
echo "                break;\n"; 
echo "            case \"BackColor\":\n"; 
echo "                tb.addDropdownButton(\"btnBackColor\" + oName, \"ddBackColor\" + oName, \"btnBackColor.gif\", getTxt(\"Background Color\"));\n"; 
echo "                var ddTable = new ISDropdown(\"ddBackColor\" + oName);\n"; 
echo "                ddTable.add(new ISCustomDDItem(\"btnInsertBackColor\", oEdt.oColor2.generateHTML()));\n"; 
echo "                break;\n"; 
echo "            case \"FontDialog\":\n"; 
echo "                tb.addButton(\"btnFontDialog\" + oName, \"btnFont.gif\", getTxt(\"Fonts\"));\n"; 
echo "                break;\n"; 
echo "            case \"TextDialog\":\n"; 
echo "                tb.addButton(\"btnTextDialog\" + oName, \"btnText.gif\", getTxt(\"Text\"));\n"; 
echo "                break;\n"; 
echo "            case \"CompleteTextDialog\":\n"; 
echo "                tb.addButton(\"btnCompleteTextDialog\" + oName, \"btnText.gif\", getTxt(\"Text\"));\n"; 
echo "                break;\n"; 
echo "            case \"LinkDialog\":\n"; 
echo "                tb.addButton(\"btnLinkDialog\" + oName, \"btnHyperlink.gif\", getTxt(\"Link\"));\n"; 
echo "                break;\n"; 
echo "            case \"ImageDialog\":\n"; 
echo "                tb.addButton(\"btnImageDialog\" + oName, \"btnImage.gif\", getTxt(\"Image\"));\n"; 
echo "                break;\n"; 
echo "            case \"YoutubeDialog\":\n"; 
echo "                tb.addButton(\"btnYoutubeDialog\" + oName, \"btnYoutubeVideo.gif\", getTxt(\"YoutubeVideo\"));\n"; 
echo "                break;\n"; 
echo "            case \"TableDialog\":\n"; 
echo "                tb.addButton(\"btnTableDialog\" + oName, \"btnTableEdit.gif\", getTxt(\"Table\"));\n"; 
echo "                break;\n"; 
echo "            case \"FlashDialog\":\n"; 
echo "                tb.addButton(\"btnFlashDialog\" + oName, \"btnFlash.gif\", getTxt(\"Flash\"));\n"; 
echo "                break;\n"; 
echo "            case \"CharsDialog\":\n"; 
echo "                tb.addButton(\"btnCharsDialog\" + oName, \"btnSymbol.gif\", getTxt(\"Special Characters\"));\n"; 
echo "                break;\n"; 
echo "            case \"SearchDialog\":\n"; 
echo "                tb.addButton(\"btnSearchDialog\" + oName, \"btnSearch.gif\", getTxt(\"Search & Replace\"));\n"; 
echo "                break;\n"; 
echo "            case \"SourceDialog\":\n"; 
echo "                tb.addButton(\"btnSourceDialog\" + oName, \"btnSource.gif\", getTxt(\"HTML Editor\"));\n"; 
echo "                break;\n"; 
echo "            case \"BookmarkDialog\":\n"; 
echo "                tb.addButton(\"btnBookmarkDialog\" + oName, \"btnBookmark.gif\", getTxt(\"Bookmark\"));\n"; 
echo "                break;\n"; 
echo "            case \"Preview\":\n"; 
echo "                tb.addButton(\"btnPreview\" + oName, \"btnPreview.gif\", getTxt(\"Preview\"));\n"; 
echo "                break;\n"; 
echo "            case \"CustomTag\":\n"; 
echo "                tb.addDropdownButton(\"btnCustomTag\" + oName, \"ddCustomTag\" + oName, \"btnCustomTag.gif\", getTxt(\"Tags\"), 37);\n"; 
echo "                var ddCustomTag = new ISDropdown(\"ddCustomTag\" + oName);\n"; 
echo "                ddCustomTag.onClick = function (id) { ddAction(tb, id, oEdt, oEdt.oName) };\n"; 
echo "                for (var j = 0; j < oEdt.arrCustomTag.length; j++) {\n"; 
echo "                    ddCustomTag.addItem(\"btnCustomTag_\" + j + oName, oEdt.arrCustomTag[j][0]);\n"; 
echo "                }\n"; 
echo "                break;\n"; 
echo "            case \"ContentBlock\":\n"; 
echo "                tb.addButton(\"btnContentBlock\" + oName, \"btnContentBlock.gif\", getTxt(\"Content Block\"));\n"; 
echo "                break;\n"; 
echo "            case \"InternalLink\":\n"; 
echo "                tb.addButton(\"btnInternalLink\" + oName, \"btnInternalLink.gif\", getTxt(\"Internal Link\"));\n"; 
echo "                break;\n"; 
echo "            case \"InternalImage\":\n"; 
echo "                tb.addButton(\"btnInternalImage\" + oName, \"btnInternalImage.gif\", getTxt(\"Internal Image\"));\n"; 
echo "                break;\n"; 
echo "            case \"CustomObject\":\n"; 
echo "                tb.addButton(\"btnCustomObject\" + oName, \"btnCustomObject.gif\", getTxt(\"Object\"));\n"; 
echo "                break;\n"; 
echo "            case \"Table\":\n"; 
echo "                var sdd = [], sZ = 0;\n"; 
echo "                sdd[sZ++] = \"<table width='175' id='dropTableCreate\" + oName + \"' style='cursor:default;background:#f3f3f8;' cellpadding=0 cellspacing=1 unselectable=on>\";\n"; 
echo "                for (var m = 0; m < 8; m++) {\n"; 
echo "                    sdd[sZ++] = \"<tr>\";\n"; 
echo "                    for (var n = 0; n < 8; n++) {\n"; 
echo "                        sdd[sZ++] = \"<td onclick='\" + oName + \".doClick_TabCreate(this)' onmouseover='doOver_TabCreate(this);event.cancelBubble=true;' style='background:#ffffff;font-size:1px;border:#d3d3d3 1px solid;width:20px;height:20px;' unselectable=on>&nbsp;</td>\";\n"; 
echo "                    }\n"; 
echo "                    sdd[sZ++] = \"</tr>\";\n"; 
echo "                }\n"; 
echo "                //sdd[sZ++] = \"<tr><td colspan=8 align=center style='font-family:verdana;font-size:10px;color:#000000;border:#f3f3f8 1px solid;padding:1px 1px 1px 1px' unselectable=on>&nbsp;</td></tr>\";\n"; 
echo "                sdd[sZ++] = \"<tr><td colspan=8 onclick=\\"\" + oName + \".hide();modelessDialogShow('\" + oEdt.dialogPath + \"webtable.htm',785, 500);\\" onmouseover=\\"doOut_TabCreate(document.getElementById('dropTableCreate\" + oName + \"'));this.innerHTML='\" + getTxt(\"Advanced Table Insert\") + \"';this.style.border='#777777 1px solid';this.style.backgroundColor='#444444';this.style.color='#ffffff'\\" onmouseout=\\"this.style.border='#f3f3f8 1px solid';this.style.backgroundColor='#f3f3f8';this.style.color='#000000'\\" align=center style='font-family:verdana;font-size:10px;color:#000000;border:#f3f3f8 1px solid;padding:1px 1px 1px 1px' unselectable=on>\" + getTxt(\"Advanced Table Insert\") + \"</td></tr>\";\n"; 
echo "                sdd[sZ++] = \"</table>\";\n"; 
echo "\n"; 
echo "                tb.addDropdownButton(\"btnTable\" + oName, \"ddTable\" + oName, \"btnTable.gif\", getTxt(\"Insert Table\"));\n"; 
echo "                var ddTable = new ISDropdown(\"ddTable\" + oName);\n"; 
echo "                ddTable.add(new ISCustomDDItem(\"btnInsertTable\", sdd.join(\"\")));\n"; 
echo "\n"; 
echo "                /*\n"; 
echo "                tb.addDropdownButton(\"btnTableEdit\" + oName, \"ddTableEdit\" + oName, \"btnTableEdit.gif\", getTxt(\"Edit Table/Cell\"));\n"; 
echo "                var ddTblEdit = new ISDropdown(\"ddTableEdit\" + oName);\n"; 
echo "                ddTblEdit.onClick = function (id) { ddAction(tb, id, oEdt, oEdt.oName) };\n"; 
echo "                ddTblEdit.iconPath = tb.iconPath;\n"; 
echo "                ddTblEdit.addItem(\"mnuTableSize\" + oName, getTxt(\"Table Size\"), \"btnTableSize.gif\");\n"; 
echo "                ddTblEdit.addItem(\"mnuTableEdit\" + oName, getTxt(\"Edit Table\"), \"btnEditTable.gif\");\n"; 
echo "                ddTblEdit.addItem(\"mnuCellEdit\" + oName, getTxt(\"Edit Cell\"), \"btnEditCell.gif\");*/\n"; 
echo "                break;\n"; 
echo "            case \"Absolute\":\n"; 
echo "                tb.addButton(\"btnAbsolute\" + oName, \"btnAbsolute.gif\", getTxt(\"Absolute\"));\n"; 
echo "                break;\n"; 
echo "            case \"Line\":\n"; 
echo "                tb.addButton(\"btnLine\" + oName, \"btnLine.gif\", getTxt(\"Line\"));\n"; 
echo "                break;\n"; 
echo "            case \"RemoveFormat\":\n"; 
echo "                tb.addButton(\"btnRemoveFormat\" + oName, \"btnRemoveFormat.gif\", getTxt(\"Remove Formatting\"));\n"; 
echo "                break;\n"; 
echo "            case \"ClearAll\":\n"; 
echo "                tb.addButton(\"btnClearAll\" + oName, \"btnDelete.gif\", getTxt(\"Clear All\"));\n"; 
echo "                break;\n"; 
echo "            default:\n"; 
echo "                for (var j = 0; j < oEdt.arrCustomButtons.length; j++) {\n"; 
echo "                    if (sButtonName == oEdt.arrCustomButtons[j][0]) {\n"; 
echo "                        sCbName = oEdt.arrCustomButtons[j][0];\n"; 
echo "                        //sCbCommand=oEdt.arrCustomButtons[j][1];\n"; 
echo "                        sCbCaption = oEdt.arrCustomButtons[j][2];\n"; 
echo "                        sCbImage = oEdt.arrCustomButtons[j][3];\n"; 
echo "\n"; 
echo "                        /* New Custom Dropdown */\n"; 
echo "                        if (oEdt.arrCustomButtons[j].length < 5) {\n"; 
echo "                            if (oEdt.arrCustomButtons[j][4])\n"; 
echo "                                tb.addButton(sCbName + oName, sCbImage, sCbCaption, oEdt.arrCustomButtons[j][4]);\n"; 
echo "                            else\n"; 
echo "                                tb.addButton(sCbName + oName, sCbImage, sCbCaption);\n"; 
echo "                        } else {\n"; 
echo "                            if (oEdt.arrCustomButtons[j][4] != 0)\n"; 
echo "                                tb.addDropdownButton(sCbName + oName, \"dd\" + sCbName + oName, sCbImage, sCbCaption, oEdt.arrCustomButtons[j][4]);\n"; 
echo "                            else\n"; 
echo "                                tb.addDropdownButton(sCbName + oName, \"dd\" + sCbName + oName, sCbImage, sCbCaption);\n"; 
echo "                            var ddTable = new ISDropdown(\"dd\" + sCbName + oName);\n"; 
echo "                            var arrItems = oEdt.arrCustomButtons[j][5];\n"; 
echo "                            for (var k = 0; k < arrItems.length; k++) {\n"; 
echo "                                tmp = arrItems[k];\n"; 
echo "                                ddTable.addItem('item_' + sCbName + k + oName,\n"; 
echo "                                '<div style=\"margin:4px 0;padding:2px 0;font-size:13px;\"  unselectable=on onclick=\"' + tmp[1] + '\" > ' +\n"; 
echo "                                tmp[2] + '</div>');\n"; 
echo "                            }\n"; 
echo "                        }\n"; 
echo "                        /* /New Custom Dropdown */\n"; 
echo "\n"; 
echo "                    }\n"; 
echo "                }\n"; 
echo "                break;\n"; 
echo "\n"; 
echo "        }\n"; 
echo "    }\n"; 
echo "};\n"; 
echo "\n"; 
echo "\n"; 
echo "function iwe_getElm(s) {\n"; 
echo "    return document.getElementById(s + this.oName);\n"; 
echo "};\n"; 
echo "\n"; 
echo "/*** Replace current body onload ***/\n"; 
echo "function onload_new() {\n"; 
echo "    onload_original();\n"; 
echo "    //alert(\"setEdit here\");\n"; 
echo "    //oUtil.setEdit();\n"; 
echo "};\n"; 
echo "function onload_original() {\n"; 
echo "};\n"; 
echo "\n"; 
echo "/*** Color Picker Object ***/\n"; 
echo "var arrColorPickerObjects = [];\n"; 
echo "function ColorPicker(sName, sParent) {\n"; 
echo "    this.oParent = sParent;\n"; 
echo "    if (sParent) {\n"; 
echo "        this.oName = sParent + \".\" + sName;\n"; 
echo "        this.oRenderName = sName + sParent;\n"; 
echo "    }\n"; 
echo "    else {\n"; 
echo "        this.oName = sName;\n"; 
echo "        this.oRenderName = sName;\n"; 
echo "    }\n"; 
echo "    arrColorPickerObjects.push(this.oName);\n"; 
echo "\n"; 
echo "    this.onShow = function () { return true; };\n"; 
echo "    this.onHide = function () { return true; };\n"; 
echo "    this.onPickColor = function () { return true; };\n"; 
echo "    this.onRemoveColor = function () { return true; };\n"; 
echo "    this.hide = hideColorPicker;\n"; 
echo "    this.hideAll = hideColorPickerAll;\n"; 
echo "    this.color;\n"; 
echo "    this.isActive = false;\n"; 
echo "    this.generateHTML = generateHTML;\n"; 
echo "};\n"; 
echo "function generateHTML() {\n"; 
echo "    var arrColors = [\n"; 
echo "      [\"#ef001b\", \"#cc0017\", \"#a60012\", \"#83000e\", \"#ef0078\", \"#ce0067\", \"#ad0057\", \"#8b0045\", \"#e301ed\", \"#c501ce\", \"#a401ab\", \"#88018e\", \"#6716ef\", \"#5913ce\", \"#4b10af\", \"#3e0d90\"],\n"; 
echo "      [\"#f67684\", \"#e36875\", \"#ca5965\", \"#b34e59\", \"#f563ac\", \"#de599b\", \"#cc5490\", \"#b24d7f\", \"#ee68f4\", \"#db5fe1\", \"#c759cc\", \"#b255b6\", \"#a779f5\", \"#976cdf\", \"#8d68cc\", \"#7f5eb7\"],\n"; 
echo "      [\"#fcc0c6\", \"#eea8af\", \"#dd959c\", \"#ce8c93\", \"#fec7e2\", \"#f4b8d6\", \"#e5a6c6\", \"#d495b4\", \"#fabffd\", \"#eeaff1\", \"#e19fe4\", \"#cf90d2\", \"#e0c3fd\", \"#d1b1f1\", \"#c1a0e2\", \"#b192d1\"],\n"; 
echo "      [\"#fef5f6\", \"#fdeced\", \"#f7dee0\", \"#eacedc\", \"#fef3f8\", \"#fbe8f1\", \"#efd0e0\", \"#e6c7d6\", \"#fef2fe\", \"#fae6fb\", \"#f1d3f2\", \"#e3c1e4\", \"#f5edfe\", \"#f0e5fb\", \"#e1d3ef\", \"#d9cbe7\"],\n"; 
echo "\n"; 
echo "      [\"#028b6c\", \"#02775d\", \"#02644e\", \"#015441\", \"#1882ed\", \"#1574d4\", \"#115eab\", \"#0e4f90\", \"#0040eb\", \"#0039d0\", \"#0030b1\", \"#002892\", \"#50509e\", \"#46468b\", \"#3a3a73\", \"#303060\"],\n"; 
echo "      [\"#69baa7\", \"#61a898\", \"#57998a\", \"#508b7d\", \"#7bb8f5\", \"#6ea7e0\", \"#6195c9\", \"#5684b2\", \"#6d92f5\", \"#5f82e0\", \"#5675c9\", \"#4d68b2\", \"#9b9bc9\", \"#8b8bb6\", \"#7e7ea5\", \"#747496\"],\n"; 
echo "      [\"#d0eae4\", \"#b3d7cf\", \"#9bc4ba\", \"#8fb4ac\", \"#c3dffc\", \"#aacdf0\", \"#9bbde0\", \"#97b4d1\", \"#bdcdfb\", \"#a8bbef\", \"#96aae1\", \"#8a9bcb\", \"#d8d8eb\", \"#c7c7dc\", \"#b5b5cc\", \"#a5a5bc\"],\n"; 
echo "      [\"#f0f8f6\", \"#deedea\", \"#d7e6e2\", \"#ceddda\", \"#f1f7fe\", \"#e5f0fb\", \"#d8e5f2\", \"#cfdbe7\", \"#eff3fe\", \"#e5eafa\", \"#dde3f4\", \"#d2d8ea\", \"#f4f4f9\", \"#e5e5ef\", \"#dbdbe5\", \"#d6d6df\"],\n"; 
echo "\n"; 
echo "      [\"#00a000\", \"#008d00\", \"#007700\", \"#006000\", \"#86d800\", \"#73ba00\", \"#629e00\", \"#528400\", \"#eded00\", \"#cece00\", \"#afaf00\", \"#909000\", \"#e3ab00\", \"#c79600\", \"#aa8000\", \"#856400\"],\n"; 
echo "      [\"#68c868\", \"#5cb65c\", \"#56a456\", \"#4b924b\", \"#b7e768\", \"#a8d45f\", \"#97c056\", \"#86aa4d\", \"#f1f164\", \"#e1e15d\", \"#caca58\", \"#b2b24d\", \"#eecc65\", \"#dabc5e\", \"#c7ac59\", \"#b09850\"],\n"; 
echo "      [\"#c6ecc6\", \"#addead\", \"#96cd96\", \"#87b987\", \"#e1f6c0\", \"#d0eba6\", \"#c1d99a\", \"#b1c88c\", \"#fbfbad\", \"#f1f194\", \"#e2e28e\", \"#cece8c\", \"#faeaba\", \"#f2dfa7\", \"#e6d090\", \"#cbbb8b\"],\n"; 
echo "      [\"#eef9ee\", \"#dff1df\", \"#d5e8d5\", \"#c6dbc6\", \"#f1fbe2\", \"#e9f5d5\", \"#dfebcd\", \"#d4e1c0\", \"#fefef0\", \"#fafae3\", \"#f0f0cb\", \"#e4e4c5\", \"#fdf8ea\", \"#f9f2de\", \"#eee4c7\", \"#dfd7bf\"],\n"; 
echo "\n"; 
echo "      [\"#818181\", \"#676767\", \"#494949\", \"#000000\", \"#783c00\", \"#673300\", \"#562b00\", \"#472300\", \"#eb4600\", \"#cd3d00\", \"#ad3300\", \"#8f2a00\", \"#ed7700\", \"#d26900\", \"#af5800\", \"#904800\"],\n"; 
echo "      [\"#c9c9c9\", \"#a9a9a9\", \"#919191\", \"#787878\", \"#af8b68\", \"#a28264\", \"#917458\", \"#856d55\", \"#f19068\", \"#dd8561\", \"#c97654\", \"#b47053\", \"#f5ac63\", \"#e1a05f\", \"#ca9259\", \"#b78451\"],\n"; 
echo "      [\"#efefef\", \"#dcdcdc\", \"#c1c1c1\", \"#9d9d9d\", \"#dbcab9\", \"#ccb8a5\", \"#bda792\", \"#a3917f\", \"#fbcebc\", \"#f1bba5\", \"#e1aa93\", \"#ce9f8b\", \"#fcd7b3\", \"#f3caa2\", \"#e7b98c\", \"#c8a078\"],\n"; 
echo "      [\"#ffffff\", \"#f7f7f7\", \"#ededed\", \"#dddddd\", \"#f4efeb\", \"#efe8e1\", \"#e6ded6\", \"#dbd3cc\", \"#fef5f2\", \"#fae8e1\", \"#f0dbd3\", \"#e1cbc2\", \"#fef7f0\", \"#faecde\", \"#f1e2d3\", \"#e3d3c3\"]\n"; 
echo "    ];\n"; 
echo "    var sHTMLColor = \"<table id=dropColor\" + this.oRenderName + \" style=\\"background-color:#fcfcfc;\\" unselectable=on cellpadding=0 cellspacing=0 width=140px><tr><td unselectable=on style='padding:2px;'>\";\n"; 
echo "    sHTMLColor += \"<table align=center cellpadding=0 cellspacing=0 border=0 unselectable=on>\";\n"; 
echo "    for (var i = 0; i < arrColors.length; i++) {\n"; 
echo "        sHTMLColor += \"<tr>\";\n"; 
echo "        for (var j = 0; j < arrColors[i].length; j++)\n"; 
echo "            sHTMLColor += \"<td onclick=\\"\" + this.oName + \".color='\" + arrColors[i][j] + \"';\" + this.oName + \".onPickColor();\" + this.oName + \".hideAll()\\" style=\\"\\" unselectable=on>\" +\n"; 
echo "                \"<table style='-moz-border-radius:0px;-webkit-border-radius: 0px;margin:0px;padding:0px;width:12px;height:12px;background:\" + arrColors[i][j] + \";' cellpadding=0 cellspacing=0 unselectable=on>\" +\n"; 
echo "                \"<tr><td unselectable=on style='cursor:pointer;margin:0px;padding:0px;line-height:normal;font-size:10px;'>&nbsp;</td></tr>\" +\n"; 
echo "                \"</table></td>\";\n"; 
echo "        sHTMLColor += \"</tr>\";\n"; 
echo "    }\n"; 
echo "\n"; 
echo "    //~~~ remove color ~~~~\n"; 
echo "    sHTMLColor += \"<tr>\";\n"; 
echo "    sHTMLColor += \"<td colspan=16 unselectable=on style='padding:0px;'>\" +\n"; 
echo "        \"<table style='padding:0px;margin-left:1px;width:100%;height:14px;background:#f4f4f4;' cellpadding=0 cellspacing=0 unselectable=on>\" +\n"; 
echo "        \"<tr><td onclick=\\"\" + this.oName + \".onRemoveColor();\" + this.oName + \".hideAll()\\" onmouseover=\\"this.style.border='#777777 1px solid'\\" onmouseout=\\"this.style.border='white 1px solid'\\" style=\\"cursor:default;padding:1px;border:white 1px solid;font-family:verdana;font-size:10px;color:#000000;line-height:9px;\\" align=center valign=top unselectable=on>x</td></tr>\" +\n"; 
echo "        \"</table></td>\";\n"; 
echo "    sHTMLColor += \"</tr>\";\n"; 
echo "\n"; 
echo "    sHTMLColor += \"</table>\";\n"; 
echo "    sHTMLColor += \"</td></tr></table>\";\n"; 
echo "    return sHTMLColor;\n"; 
echo "};\n"; 
echo "\n"; 
echo "\n"; 
echo "function hideColorPicker() {\n"; 
echo "    this.onHide();\n"; 
echo "\n"; 
echo "    //deprecated, this function is no longer use, since colorpicker is rendered inside toolbar.    \n"; 
echo "    return;\n"; 
echo "\n"; 
echo "    var box = document.getElementById(\"dropColor\" + this.oRenderName);\n"; 
echo "    box.style.display = \"none\";\n"; 
echo "    this.isActive = false;\n"; 
echo "};\n"; 
echo "function hideColorPickerAll() {\n"; 
echo "    //deprecated, this function is no longer use, since colorpicker is rendered inside toolbar.    \n"; 
echo "    return;\n"; 
echo "\n"; 
echo "    for (var i = 0; i < arrColorPickerObjects.length; i++) {\n"; 
echo "        var box = document.getElementById(\"dropColor\" + eval(arrColorPickerObjects[i]).oRenderName);\n"; 
echo "        box.style.display = \"none\";\n"; 
echo "        eval(arrColorPickerObjects[i]).isActive = false;\n"; 
echo "    }\n"; 
echo "};\n"; 
echo "\n"; 
echo "/*** CONTENT ***/\n"; 
echo "function loadHTML(sHTML)//hanya utk first load.\n"; 
echo "{\n"; 
echo "    var oEditor = document.getElementById(\"idContent\" + this.oName).contentWindow;\n"; 
echo "    oEditor.document.open(\"text/html\", \"replace\");\n"; 
echo "\n"; 
echo "    var defaultEditCss = \"<link id='tmp_xxinnova' href='\" + this.scriptPath + \"default_edit.css' type='text/css' rel='stylesheet' />\";\n"; 
echo "\n"; 
echo "    var hdr = \"\";\n"; 
echo "    if (this.publishingPath != \"\") {\n"; 
echo "        var arrA = String(this.preloadHTML).match(/<base[^>]*>/ig);\n"; 
echo "        if (!arrA) {//if no <base> found\n"; 
echo "            hdr = this.docType + \"<HTML><HEAD><BASE HREF=\\"\" + this.publishingPath + \"\\"/>\" + defaultEditCss + this.headContent + \"</HEAD><BODY>\" + \"</BODY></HTML>\";\n"; 
echo "            //kalau cuma tambah <HTML><HEAD></HEAD><BODY.. tdk apa2.\n"; 
echo "        }\n"; 
echo "    }\n"; 
echo "    else {\n"; 
echo "        hdr = this.docType + \"<HTML><HEAD>\" + defaultEditCss + this.headContent + \"</HEAD><BODY>\" + \"</BODY></HTML>\";\n"; 
echo "    }\n"; 
echo "\n"; 
echo "    oEditor.document.write(hdr);\n"; 
echo "    oEditor.document.close();\n"; 
echo "    oEditor.document.body.innerHTML = sHTML;\n"; 
echo "    oEditor.document.body.contentEditable = true;\n"; 
echo "\n"; 
echo "    //RealTime\n"; 
echo "\n"; 
echo "    var me = this;\n"; 
echo "    oEditor.document.addEventListener(\"keyup\", new Function(\"editorDoc_onkeyup(\" + this.oName + \")\"), true);\n"; 
echo "    oEditor.document.addEventListener(\"mouseup\", function (e) { editorDoc_onmouseup(e, me.oName); }, true);\n"; 
echo "\n"; 
echo "    oEditor.document.addEventListener(\"keydown\", new Function(\"var e=arguments[0];doKeyPress(eval(e), \" + this.oName + \")\"), false);\n"; 
echo "\n"; 
echo "    if (typeof this.css == 'object') {\n"; 
echo "\n"; 
echo "        for (var j = 0; j < this.css.length; j++) {\n"; 
echo "            var objL = oEditor.document.createElement(\"LINK\");\n"; 
echo "            objL.href = this.css[j];\n"; 
echo "            objL.rel = \"StyleSheet\";\n"; 
echo "            oEditor.document.documentElement.childNodes[0].appendChild(objL);\n"; 
echo "        }\n"; 
echo "\n"; 
echo "    } else {\n"; 
echo "\n"; 
echo "        if (this.css != \"\") {\n"; 
echo "            var objL = oEditor.document.createElement(\"LINK\");\n"; 
echo "            objL.href = this.css;\n"; 
echo "            objL.rel = \"StyleSheet\";\n"; 
echo "            oEditor.document.documentElement.childNodes[0].appendChild(objL);\n"; 
echo "        }\n"; 
echo "\n"; 
echo "    }\n"; 
echo "\n"; 
echo "\n"; 
echo "    /*** Apply this.arrStyle to the content ***/\n"; 
echo "    if (this.arrStyle.length > 0) {\n"; 
echo "        var oElement = oEditor.document.createElement(\"STYLE\");\n"; 
echo "        oEditor.document.documentElement.childNodes[0].appendChild(oElement);\n"; 
echo "        var sCssText = \"\";\n"; 
echo "        for (var i = 0; i < this.arrStyle.length; i++) {\n"; 
echo "            selector = this.arrStyle[i][0];\n"; 
echo "            style = this.arrStyle[i][3];\n"; 
echo "            sCssText += selector + \" { \" + style + \" } \";\n"; 
echo "        }\n"; 
echo "        oElement.appendChild(oEditor.document.createTextNode(sCssText));\n"; 
echo "    }\n"; 
echo "\n"; 
echo "    this.cleanDeprecated();\n"; 
echo "};\n"; 
echo "\n"; 
echo "function loadHTMLFull(sHTML, firstLoad)//first load full HTML\n"; 
echo "{\n"; 
echo "    var oEditor = document.getElementById(\"idContent\" + this.oName).contentWindow;\n"; 
echo "\n"; 
echo "    //save doctype (if any/if not body only)\n"; 
echo "    var arrA = String(sHTML).match(/<!DOCTYPE[^>]*>/ig);\n"; 
echo "    if (arrA)\n"; 
echo "        for (var i = 0; i < arrA.length; i++) {\n"; 
echo "            this.docType = arrA[i];\n"; 
echo "        }\n"; 
echo "    else this.docType = \"\"; //back to default value\n"; 
echo "\n"; 
echo "    //save html (if any/if not body only)\n"; 
echo "    var arrB = String(sHTML).match(/<HTML[^>]*>/ig);\n"; 
echo "    if (arrB)\n"; 
echo "        for (var i = 0; i < arrB.length; i++) {\n"; 
echo "            s = arrB[i];\n"; 
echo "            s = s.replace(/\\"[^\\"]*\\"/ig, function (x) {\n"; 
echo "                x = x.replace(/&/g, \"&amp;\").replace(/</g, \"&lt;\").replace(/>/g, \"&gt;\").replace(/'/g, \"&apos;\").replace(/\s+/ig, \"#_#\");\n"; 
echo "                return x\n"; 
echo "            });\n"; 
echo "            s = s.replace(/<([^ >]*)/ig, function (x) { return x.toLowerCase() });\n"; 
echo "            s = s.replace(/ ([^=]+)=([^\" >]+)/ig, \" $1=\\"$2\\"\");\n"; 
echo "            s = s.replace(/ ([^=]+)=/ig, function (x) { return x.toLowerCase() });\n"; 
echo "            s = s.replace(/#_#/ig, \" \");\n"; 
echo "            this.html = s;\n"; 
echo "        }\n"; 
echo "    else this.html = \"<html>\"; //back to default value\n"; 
echo "\n"; 
echo "    //Dalam pengeditan kalau pakai doctype,\n"; 
echo "    //membuat mouse tdk bisa di-klik di empty area\n"; 
echo "    //sHTML=String(sHTML).replace(/<!DOCTYPE[^>]*>/ig,\"\");\n"; 
echo "    if (this.publishingPath != \"\") {\n"; 
echo "        var arrA = sHTML.match(/<base[^>]*>/ig);\n"; 
echo "        if (!arrA) {\n"; 
echo "            sHTML = \"<BASE HREF=\\"\" + this.publishingPath + \"\\"/>\" + sHTML;\n"; 
echo "        }\n"; 
echo "    }\n"; 
echo "\n"; 
echo "    /*** Remove link to external css (content with links to external css can't be edited), then the set css property ***/\n"; 
echo "    this.css = \"\";\n"; 
echo "    var arrExtCss = String(sHTML).match(/<link[^>]*>/ig);\n"; 
echo "    if (arrExtCss)\n"; 
echo "        for (var i = 0; i < arrExtCss.length; i++) {\n"; 
echo "            var s = arrExtCss[i];\n"; 
echo "            var arrTmp = s.split(\"href=\\"\");\n"; 
echo "            if (arrTmp.length > 1) {\n"; 
echo "                s = arrTmp[1];\n"; 
echo "                arrTmp = s.split(\"\\"\");\n"; 
echo "                if (arrTmp.length > 1)\n"; 
echo "                    this.css = arrTmp[0];\n"; 
echo "            }\n"; 
echo "        }\n"; 
echo "\n"; 
echo "    //sHTML=sHTML.replace(/<link[^>]*>/ig,\"\");\n"; 
echo "    /*** end ***/\n"; 
echo "\n"; 
echo "    var p1 = 0, p2 = sHTML.length;\n"; 
echo "    var tmp = sHTML.match(/<body[^>]*>/i);\n"; 
echo "    if (tmp) {\n"; 
echo "        p1 = sHTML.indexOf(tmp[0]) + tmp[0].length;\n"; 
echo "    }\n"; 
echo "\n"; 
echo "    tmp = sHTML.match(/<\/body>/i);\n"; 
echo "    if (tmp) {\n"; 
echo "        p2 = sHTML.indexOf(tmp[0]);\n"; 
echo "    }\n"; 
echo "\n"; 
echo "    var head = sHTML.substring(0, p1) + \"</html>\";\n"; 
echo "    var cnt = sHTML.substring(p1, p2);\n"; 
echo "    var foot = sHTML.substr(p2);\n"; 
echo "\n"; 
echo "    var defaultEditCss = \"<link id='tmp_xxinnova' href='\" + this.scriptPath + \"default_edit.css' type='text/css' rel='stylesheet' />\";\n"; 
echo "    if (head.match(/<head>/gi)) {\n"; 
echo "        head = head.replace(/<head>/gi, \"<head>\" + defaultEditCss);\n"; 
echo "    } else {\n"; 
echo "        head = head.replace(/<body/gi, \"<head>\" + defaultEditCss + \"</head><body\");\n"; 
echo "    }\n"; 
echo "\n"; 
echo "    oEditor.document.open(\"text/html\", \"replace\");\n"; 
echo "    oEditor.document.write(head + foot);\n"; 
echo "    oEditor.document.close();\n"; 
echo "    oEditor.document.body.innerHTML = cnt;\n"; 
echo "    oEditor.document.body.contentEditable = true;\n"; 
echo "\n"; 
echo "    //RealTime\n"; 
echo "    var me = this;\n"; 
echo "    oEditor.document.addEventListener(\"keyup\", new Function(\"editorDoc_onkeyup(\" + me.oName + \")\"), true);\n"; 
echo "    oEditor.document.addEventListener(\"mouseup\", function (e) { editorDoc_onmouseup(e, me.oName); }, true);\n"; 
echo "\n"; 
echo "    //<br> or <p>\n"; 
echo "    oEditor.document.addEventListener(\"keydown\", new Function(\"var e=arguments[0];doKeyPress(eval(e), \" + this.oName + \")\"), false);\n"; 
echo "\n"; 
echo "    this.cleanDeprecated();\n"; 
echo "};\n"; 
echo "\n"; 
echo "function putHTML(sHTML) {//used by source editor\n"; 
echo "    this.loadHTMLFull(sHTML, true);\n"; 
echo "};\n"; 
echo "\n"; 
echo "function encodeHTMLCode(sHTML) {\n"; 
echo "    return sHTML.replace(/&/g, \"&amp;\").replace(/</g, \"&lt;\").replace(/>/g, \"&gt;\");\n"; 
echo "};\n"; 
echo "\n"; 
echo "function cleanHTML(sHTML) {\n"; 
echo "    var h = sHTML.replace(/<br class=\"innova\" \/>/gi, \"\").replace(/<br class=\"innova\">/gi, \"\");\n"; 
echo "\n"; 
echo "    //clean internal editing css\n"; 
echo "    var sMatch = h.match(/<link[^>]*>/ig);\n"; 
echo "    if (sMatch) {\n"; 
echo "        for (var i = 0; i < sMatch.length; i++) {\n"; 
echo "            if (sMatch[i].indexOf(\"tmp_xxinnova\") != -1) {\n"; 
echo "                h = h.replace(new RegExp(sMatch[i], \"gi\"), \"\");\n"; 
echo "            }\n"; 
echo "        }\n"; 
echo "    }\n"; 
echo "\n"; 
echo "    return h;\n"; 
echo "};\n"; 
echo "\n"; 
echo "function getTextBody() {\n"; 
echo "    var oEditor = document.getElementById(\"idContent\" + this.oName).contentWindow;\n"; 
echo "    return oEditor.document.body.textContent;\n"; 
echo "};\n"; 
echo "function getHTML(bEdit) {\n"; 
echo "    var oEditor = document.getElementById(\"idContent\" + this.oName).contentWindow;\n"; 
echo "    this.cleanDeprecated();\n"; 
echo "\n"; 
echo "    sHTML = getOuterHTML(oEditor.document.documentElement);\n"; 
echo "    sHTML = String(sHTML).replace(/\<PARAM NAME=\\"Play\\" VALUE=\\"0\\">/ig, \"<PARAM NAME=\\"Play\\" VALUE=\\"-1\\">\");\n"; 
echo "    sHTML = this.docType + sHTML; //restore doctype (if any)\n"; 
echo "    sHTML = oUtil.replaceSpecialChar(sHTML);\n"; 
echo "    if (this.encodeIO) sHTML = encodeHTMLCode(sHTML);\n"; 
echo "    sHTML = sHTML.replace(/\u00A0+/gi, \" \");\n"; 
echo "    sHTML = cleanHTML(sHTML);\n"; 
echo "\n"; 
echo "    if (!bEdit) {\n"; 
echo "        sHTML = sHTML.replace(/ contenteditable=\\"true\\"/ig, \"\");\n"; 
echo "        sHTML = sHTML.replace(/ contenteditable=\\"false\\"/ig, \"\");\n"; 
echo "    }\n"; 
echo "\n"; 
echo "	//var text = this.getTextBody();\n"; 
echo "	//if(!text || text.trim() == \"\") sHTML = \"\";\n"; 
echo "	\n"; 
echo "    return sHTML;\n"; 
echo "};\n"; 
echo "function getHTMLBody(bEdit) {\n"; 
echo "    var oEditor = document.getElementById(\"idContent\" + this.oName).contentWindow;\n"; 
echo "    this.cleanDeprecated();\n"; 
echo "\n"; 
echo "    sHTML = oEditor.document.body.innerHTML;\n"; 
echo "    sHTML = String(sHTML).replace(/\<PARAM NAME=\\"Play\\" VALUE=\\"0\\">/ig, \"<PARAM NAME=\\"Play\\" VALUE=\\"-1\\">\");\n"; 
echo "    sHTML = oUtil.replaceSpecialChar(sHTML);\n"; 
echo "    if (this.encodeIO) sHTML = encodeHTMLCode(sHTML);\n"; 
echo "    sHTML = sHTML.replace(/\u00A0+/gi, \" \");\n"; 
echo "    sHTML = cleanHTML(sHTML);\n"; 
echo "\n"; 
echo "    if (!bEdit) {\n"; 
echo "        sHTML = sHTML.replace(/ contenteditable=\\"true\\"/ig, \"\");\n"; 
echo "        sHTML = sHTML.replace(/ contenteditable=\\"false\\"/ig, \"\");\n"; 
echo "    }\n"; 
echo "\n"; 
echo "	//var text = this.getTextBody();\n"; 
echo "	//if(!text || text.trim() == \"\") sHTML = \"\";\n"; 
echo "	\n"; 
echo "    return sHTML;\n"; 
echo "};\n"; 
echo "var sBaseHREF = \"\";\n"; 
echo "function getXHTML(bEdit) {\n"; 
echo "    var oEditor = document.getElementById(\"idContent\" + this.oName).contentWindow;\n"; 
echo "    this.cleanDeprecated();\n"; 
echo "\n"; 
echo "    //base handling\n"; 
echo "    sHTML = getOuterHTML(oEditor.document.documentElement);\n"; 
echo "    var arrTmp = sHTML.match(/<BASE([^>]*)>/ig);\n"; 
echo "    if (arrTmp != null) sBaseHREF = arrTmp[0];\n"; 
echo "\n"; 
echo "    var arrBase = oEditor.document.getElementsByTagName(\"BASE\");\n"; 
echo "    if (arrBase.length != null) {\n"; 
echo "        for (var i = 0; i < arrBase.length; i++) {\n"; 
echo "            arrBase[i].parentNode.removeChild(arrBase[i]);\n"; 
echo "        }\n"; 
echo "    }\n"; 
echo "\n"; 
echo "    //~~~~~~~~~~~~~\n"; 
echo "    sBaseHREF = sBaseHREF.replace(/<([^ >]*)/ig, function (x) { return x.toLowerCase() });\n"; 
echo "    sBaseHREF = sBaseHREF.replace(/ [^=]+=\"[^\"]+\"/ig, function (x) {\n"; 
echo "        x = x.replace(/\s+/ig, \"#_#\");\n"; 
echo "        x = x.replace(/^#_#/, \" \");\n"; 
echo "        return x\n"; 
echo "    });\n"; 
echo "    sBaseHREF = sBaseHREF.replace(/ ([^=]+)=([^\" >]+)/ig, \" $1=\\"$2\\"\");\n"; 
echo "    sBaseHREF = sBaseHREF.replace(/ ([^=]+)=/ig, function (x) { return x.toLowerCase() });\n"; 
echo "    sBaseHREF = sBaseHREF.replace(/#_#/ig, \" \");\n"; 
echo "\n"; 
echo "    sBaseHREF = sBaseHREF.replace(/>$/ig, \" \/>\").replace(/\/ \/>$/ig, \"\/>\");\n"; 
echo "    //~~~~~~~~~~~~~\n"; 
echo "\n"; 
echo "    sHTML = recur(oEditor.document.documentElement, \"\");\n"; 
echo "\n"; 
echo "    sHTML = this.docType + this.html + sHTML + \"\n</html>\"; //restore doctype (if any) & html\n"; 
echo "    sHTML = sHTML.replace(/<head>/i, \"<head>\" + sBaseHREF); //restore base href\n"; 
echo "    sHTML = sHTML.replace(/\u00A0+/gi, \" \");\n"; 
echo "    sHTML = oUtil.replaceSpecialChar(sHTML);\n"; 
echo "    if (this.encodeIO) sHTML = encodeHTMLCode(sHTML);\n"; 
echo "    sHTML = cleanHTML(sHTML);\n"; 
echo "\n"; 
echo "    if (!bEdit) {\n"; 
echo "        sHTML = sHTML.replace(/ contenteditable=\\"true\\"/ig, \"\");\n"; 
echo "        sHTML = sHTML.replace(/ contenteditable=\\"false\\"/ig, \"\");\n"; 
echo "    }\n"; 
echo "\n"; 
echo "	//var text = this.getTextBody();\n"; 
echo "	//if(!text || text.trim() == \"\") sHTML = \"\";\n"; 
echo "\n"; 
echo "    return sHTML;\n"; 
echo "};\n"; 
echo "function getXHTMLBody(bEdit) {\n"; 
echo "    var oEditor = document.getElementById(\"idContent\" + this.oName).contentWindow;\n"; 
echo "    this.cleanDeprecated();\n"; 
echo "\n"; 
echo "    //base handling\n"; 
echo "    sHTML = getOuterHTML(oEditor.document.documentElement);\n"; 
echo "    var arrTmp = sHTML.match(/<BASE([^>]*)>/ig);\n"; 
echo "    if (arrTmp != null) sBaseHREF = arrTmp[0];\n"; 
echo "    /*var arrBase = oEditor.document.getElementsByTagName(\"BASE\");\n"; 
echo "    if (arrBase.length != null) \n"; 
echo "    {\n"; 
echo "    for(var i=0; i<arrBase.length; i++) \n"; 
echo "    {\n"; 
echo "    arrBase[i].parentNode.removeChild(arrBase[i]);\n"; 
echo "    }\n"; 
echo "    }*/\n"; 
echo "    //~~~~~~~~~~~~~\n"; 
echo "\n"; 
echo "    sHTML = recur(oEditor.document.body, \"\");\n"; 
echo "    sHTML = oUtil.replaceSpecialChar(sHTML);\n"; 
echo "    if (this.encodeIO) sHTML = encodeHTMLCode(sHTML);\n"; 
echo "    sHTML = sHTML.replace(/\u00A0+/gi, \" \");\n"; 
echo "    sHTML = cleanHTML(sHTML);\n"; 
echo "\n"; 
echo "    if (!bEdit) {\n"; 
echo "        sHTML = sHTML.replace(/ contenteditable=\\"true\\"/ig, \"\");\n"; 
echo "        sHTML = sHTML.replace(/ contenteditable=\\"false\\"/ig, \"\");\n"; 
echo "    }\n"; 
echo "	\n"; 
echo "	//var text = this.getTextBody();\n"; 
echo "	//if(!text || text.trim() == \"\") sHTML = \"\";\n"; 
echo "	\n"; 
echo "    return sHTML;\n"; 
echo "};\n"; 
echo "function ApplyCSS(oName) {\n"; 
echo "    var sTmp = \"\";\n"; 
echo "    var myStyle = document.getElementById(\"myStyle\" + oName).contentWindow;\n"; 
echo "    for (var i = 0; i < myStyle.document.styleSheets[0].cssRules.length; i++) {\n"; 
echo "        var sSelector = myStyle.document.styleSheets[0].cssRules[i].selectorText;\n"; 
echo "        if (sSelector != undefined) {\n"; 
echo "            sCssText = myStyle.document.styleSheets[0].cssRules[i].style.cssText.replace(/\"/g, \"&quot;\");\n"; 
echo "            var itemCount = sSelector.split(\".\").length;\n"; 
echo "            if (itemCount > 1) {\n"; 
echo "                sCaption = sSelector.split(\".\")[1];\n"; 
echo "                sTmp += \",[\\"\" + sSelector + \"\\",true,\\"\" + sCaption + \"\\",\\"\" + sCssText + \"\\"]\";\n"; 
echo "            }\n"; 
echo "            else sTmp += \",[\\"\" + sSelector + \"\\",false,\\"\\",\\"\" + sCssText + \"\\"]\";\n"; 
echo "        }\n"; 
echo "    }\n"; 
echo "    var arrStyle = eval(\"[\" + sTmp.substr(1) + \"]\");\n"; 
echo "\n"; 
echo "    if (arrStyle.length > 0) {\n"; 
echo "        var oEditor = document.getElementById(\"idContent\" + oName).contentWindow;\n"; 
echo "        var oElement = oEditor.document.createElement(\"STYLE\");\n"; 
echo "        //oElement.id=\"idExtCss\"\n"; 
echo "        oEditor.document.documentElement.childNodes[0].appendChild(oElement);\n"; 
echo "        var sCssText = \"\";\n"; 
echo "        for (var i = 0; i < arrStyle.length; i++) {\n"; 
echo "            selector = arrStyle[i][0];\n"; 
echo "            style = arrStyle[i][3].replace(/&quot;/g, \"\\"\");\n"; 
echo "            sCssText += selector + \" { \" + style + \" } \";\n"; 
echo "        }\n"; 
echo "        oElement.appendChild(oEditor.document.createTextNode(sCssText));\n"; 
echo "    }\n"; 
echo "};\n"; 
echo "function ApplyExternalStyle(oName) {\n"; 
echo "    var edtObj = eval(oName);\n"; 
echo "    var oEditor = document.getElementById(\"idContent\" + oName).contentWindow;\n"; 
echo "    var edtHost = oEditor.location.href.match(/:\/\/(.[^/]+)/)[1];\n"; 
echo "    var sTmp = \"\";\n"; 
echo "    var prefixes = edtObj.styleSelectorPrefix.split(\",\"), found = false;\n"; 
echo "\n"; 
echo "    for (var j = 0; j < oEditor.document.styleSheets.length; j++) {\n"; 
echo "        var myStyle = oEditor.document.styleSheets[j];\n"; 
echo "\n"; 
echo "        if (myStyle.href && myStyle.href.match(/:\/\/(.[^/]+)/)[1] != edtHost) {\n"; 
echo "            continue;\n"; 
echo "        }\n"; 
echo "        //In full HTML editing: this will parse linked & embedded stylesheet\n"; 
echo "        //In Body content editing: this will parse all embedded/applied css & arrStyle.\n"; 
echo "        for (var i = 0; i < myStyle.cssRules.length; i++) {\n"; 
echo "            sSelector = myStyle.cssRules[i].selectorText;\n"; 
echo "            if (sSelector != undefined) {\n"; 
echo "\n"; 
echo "                if (sSelector.match(/table\./gi)) {\n"; 
echo "                    continue;\n"; 
echo "                }\n"; 
echo "\n"; 
echo "                found = false;\n"; 
echo "                if (prefixes.length > 0) {\n"; 
echo "                    for (var ix = 0; ix < prefixes.length; ix++) {\n"; 
echo "                        if (prefixes[ix] != \"\" && sSelector.indexOf(\".\" + prefixes[ix]) >= 0) {\n"; 
echo "                            found = true;\n"; 
echo "                            break;\n"; 
echo "                        }\n"; 

echo "                    }\n"; 
echo "                }\n"; 
echo "                if (!found && edtObj.styleSelectorPrefix != \"\") continue;\n"; 
echo "\n"; 
echo "                sSelector = sSelector.replace(/\"/g, \"\\\\"\");\n"; 
echo "\n"; 
echo "                sCssText = myStyle.cssRules[i].style.cssText.replace(/\"/g, \"&quot;\");\n"; 
echo "                var itemCount = sSelector.split(\".\").length;\n"; 
echo "                if (itemCount > 1) {\n"; 
echo "                    sCaption = sSelector.split(\".\")[1];\n"; 
echo "                    sTmp += \",[\\"\" + sSelector + \"\\",true,\\"\" + sCaption + \"\\",\\"\" + sCssText + \"\\"]\";\n"; 
echo "                }\n"; 
echo "                else sTmp += \",[\\"\" + sSelector + \"\\",false,\\"\\",\\"\" + sCssText + \"\\"]\";\n"; 
echo "            }\n"; 
echo "        }\n"; 
echo "    }\n"; 
echo "\n"; 
echo "    var arrStyle = eval(\"[\" + sTmp.substr(1) + \"]\");\n"; 
echo "\n"; 
echo "    for (var i = 0; i < arrStyle.length; i++) {\n"; 
echo "        for (var j = 0; j < edtObj.arrStyle.length; j++) {\n"; 
echo "            if (arrStyle[i][0].toLowerCase() == edtObj.arrStyle[j][0].toLowerCase()) {\n"; 
echo "                arrStyle[i][1] = edtObj.arrStyle[j][1];\n"; 
echo "            }\n"; 
echo "        }\n"; 
echo "    }\n"; 
echo "\n"; 
echo "    edtObj.arrStyle = arrStyle; //Update arrStyle property\n"; 
echo "};\n"; 
echo "\n"; 
echo "function doApplyStyle(oName, sClassName) {\n"; 
echo "    var oEditor = document.getElementById(\"idContent\" + oName).contentWindow;\n"; 
echo "    var oSel = oEditor.getSelection();\n"; 
echo "    eval(oName).saveForUndo();\n"; 
echo "\n"; 
echo "    var element;\n"; 
echo "    if (oUtil.activeElement) {\n"; 
echo "        element = oUtil.activeElement;\n"; 
echo "        element.className = sClassName;\n"; 
echo "    }\n"; 
echo "    else {\n"; 
echo "        element = getSelectedElement(oSel);\n"; 
echo "        if (isTextSelected(oSel)) {\n"; 
echo "            if (oSel != \"\") {\n"; 
echo "                eval(oName).applySpanStyle([], sClassName);\n"; 
echo "            }\n"; 
echo "            else {\n"; 
echo "                if (element.tagName == \"BODY\") return;\n"; 
echo "                element.className = sClassName;\n"; 
echo "            }\n"; 
echo "        }\n"; 
echo "        else {\n"; 
echo "            if (element.tagName == \"BODY\") return;\n"; 
echo "            element.className = sClassName;\n"; 
echo "        }\n"; 
echo "    }\n"; 
echo "    realTime(eval(oName));\n"; 
echo "};\n"; 
echo "\n"; 
echo "function openStyleSelect() {\n"; 
echo "    if (!this.isCssLoaded) ApplyExternalStyle(this.oName);\n"; 
echo "    this.isCssLoaded = true; //make only 1 call to ApplyExternalStyle()\n"; 
echo "\n"; 
echo "    var idStyles = document.getElementById(\"idStyles\" + this.oName);\n"; 
echo "    if (idStyles.innerHTML != \"\") {//toggle\n"; 
echo "        if (idStyles.style.display == \"\")\n"; 
echo "            idStyles.style.display = \"none\";\n"; 
echo "        else\n"; 
echo "            idStyles.style.display = \"\";\n"; 
echo "        return;\n"; 
echo "    }\n"; 
echo "    idStyles.style.display = \"\";\n"; 
echo "\n"; 
echo "    var h = document.getElementById(\"idContent\" + this.oName).offsetHeight - 27;\n"; 
echo "\n"; 
echo "    var arrStyle = this.arrStyle;\n"; 
echo "\n"; 
echo "    var sHTML = \"\";\n"; 
echo "    sHTML += \"<div unselectable=on style='margin:5px;margin-top:0px;margin-right:1px' align='left'>\";\n"; 
echo "\n"; 
echo "    sHTML += \"<table style='margin:1px;margin-top:2px;margin-bottom:3px;width:14px;height:14px;background:#f4f4f4;' cellpadding=0 cellspacing=0 unselectable=on>\" +\n"; 
echo "    \"<tr><td onclick=\\"\" + this.oName + \".openStyleSelect();\\" onmouseover=\\"this.style.border='#708090 1px solid';this.style.color='white';this.style.backgroundColor='9FA7BB'\\" onmouseout=\\"this.style.border='white 1px solid';this.style.color='black';this.style.backgroundColor=''\\" style=\\"cursor:default;padding:1px;border:white 1px solid;font-family:verdana;font-size:10px;color:#000000;line-height:9px;\\" align=center valign=top unselectable=on>x</td></tr>\" +\n"; 
echo "    \"</table>\";\n"; 
echo "\n"; 
echo "    var sBody = \"\";\n"; 
echo "    for (var i = 0; i < arrStyle.length; i++) {\n"; 
echo "        sSelector = arrStyle[i][0];\n"; 
echo "        if (sSelector == \"body\") sBody = arrStyle[i][3];\n"; 
echo "    }\n"; 
echo "\n"; 
echo "    sHTML += \"<div unselectable=on style='overflow:auto;width:200px;height:\" + h + \"px;'>\";\n"; 
echo "    sHTML += \"<table name='tblStyles\" + this.oName + \"' id='tblStyles\" + this.oName + \"' cellpadding=0 cellspacing=0 style='background:#fcfcfc;\" + sBody + \";height:100%;width:100%;margin:0;'>\";\n"; 
echo "\n"; 
echo "    for (var i = 0; i < arrStyle.length; i++) {\n"; 
echo "        sSelector = arrStyle[i][0];\n"; 
echo "        isOnSelection = arrStyle[i][1];\n"; 
echo "\n"; 
echo "        sCssText = arrStyle[i][3];\n"; 
echo "        //sCssText=sCssText.replace(/color: rgb\(255, 255, 255\)/,\"COLOR: #000000\");\n"; 
echo "\n"; 
echo "        sCaption = arrStyle[i][2];\n"; 
echo "        if (isOnSelection) {\n"; 
echo "            if (sSelector.split(\".\").length > 1)//sudah pasti\n"; 
echo "            {\n"; 
echo "                var tmpSelector = sSelector;\n"; 
echo "                if (sSelector.indexOf(\":\") > 0) tmpSelector = sSelector.substring(0, sSelector.indexOf(\":\"));\n"; 
echo "                if (tmpSelector.indexOf(\"awesome\") == -1) {\n"; 
echo "                    sHTML += \"<tr style=\\"cursor:default\\" onmouseover=\\"if(this.style.marginRight!='1px'){this.style.background='\" + this.styleSelectionHoverBg + \"';this.style.color='\" + this.styleSelectionHoverFg + \"'}\\" onmouseout=\\"if(this.style.marginRight!='1px'){this.style.background='';this.style.color=''}\\">\";\n"; 
echo "                    sHTML += \"<td unselectable=on onclick=\\"doApplyStyle('\" + this.oName + \"','\" + tmpSelector.split(\".\")[1] + \"')\\" style='padding:2px'>\";\n"; 
echo "                    if (sSelector.split(\".\")[0] == \"\")\n"; 
echo "                        sHTML += \"<span unselectable=on style=\\"\" + sCssText + \";margin:0;\\">\" + sCaption + \"</span>\";\n"; 
echo "                    else\n"; 
echo "                        sHTML += \"<span unselectable=on style=\\"\" + sCssText + \";margin:0;\\">\" + sSelector + \"</span>\";\n"; 
echo "                    sHTML += \"</td></tr>\";\n"; 
echo "                }\n"; 
echo "            }\n"; 
echo "        }\n"; 
echo "    }\n"; 
echo "    sHTML += \"<tr><td height=100%>&nbsp;</td></tr></table></div>\";\n"; 
echo "    sHTML += \"</div>\";\n"; 
echo "    document.getElementById(\"idStyles\" + this.oName).innerHTML = sHTML;\n"; 
echo "};\n"; 
echo "\n"; 
echo "/**************************\n"; 
echo "NEW SPAN OPERATION \n"; 
echo "**************************/\n"; 
echo "\n"; 
echo "/*** CLEAN ***/\n"; 
echo "function cleanFonts() {\n"; 
echo "    var oEditor = document.getElementById(\"idContent\" + this.oName).contentWindow;\n"; 
echo "    var allFonts = oEditor.document.body.getElementsByTagName(\"FONT\");\n"; 
echo "    if (allFonts.length == 0) return false;\n"; 
echo "\n"; 
echo "    var f; var range;\n"; 
echo "    while (allFonts.length > 0) {\n"; 
echo "        f = allFonts[0];\n"; 
echo "        if (f.hasChildNodes && f.childNodes.length == 1 && f.childNodes[0].nodeType == 1 && f.childNodes[0].nodeName == \"SPAN\") {\n"; 
echo "            //if font containts only span child node\n"; 
echo "\n"; 
echo "            var theSpan = f.childNodes[0];\n"; 
echo "            copyAttribute(theSpan, f);\n"; 
echo "\n"; 
echo "            range = oEditor.document.createRange();\n"; 
echo "            range.selectNode(f);\n"; 
echo "            range.insertNode(theSpan);\n"; 
echo "            range.selectNode(f);\n"; 
echo "            range.deleteContents();\n"; 
echo "        }\n"; 
echo "        else\n"; 
echo "            if (f.parentNode.nodeName == \"SPAN\" && f.parentNode.childNodes.length == 1) {\n"; 
echo "                //font is the only child node of span.\n"; 
echo "                var theSpan = f.parentNode;\n"; 
echo "                copyAttribute(theSpan, f);\n"; 
echo "                theSpan.innerHTML = f.innerHTML;\n"; 
echo "            }\n"; 
echo "            else {\n"; 
echo "                var newSpan = oEditor.document.createElement(\"SPAN\");\n"; 
echo "                copyAttribute(newSpan, f);\n"; 
echo "                newSpan.innerHTML = f.innerHTML;\n"; 
echo "                f.parentNode.replaceChild(newSpan, f);\n"; 
echo "            }\n"; 
echo "    }\n"; 
echo "    return true;\n"; 
echo "};\n"; 
echo "function cleanTags(elements, sVal) {\n"; 
echo "    var oEditor = document.getElementById(\"idContent\" + this.oName).contentWindow;\n"; 
echo "    if (elements.length == 0) return false;\n"; 
echo "\n"; 
echo "    var f; var range;\n"; 
echo "    while (elements.length > 0) {\n"; 
echo "        f = elements[0];\n"; 
echo "        if (f.hasChildNodes && f.childNodes.length == 1 && f.childNodes[0].nodeType == 1 && f.childNodes[0].nodeName == \"SPAN\") {//if font containts only span child node      \n"; 
echo "            var theSpan = f.childNodes[0];\n"; 
echo "            if (sVal == \"bold\") theSpan.style.fontWeight = \"bold\";\n"; 
echo "            if (sVal == \"italic\") theSpan.style.fontStyle = \"italic\";\n"; 
echo "            if (sVal == \"line-through\") theSpan.style.textDecoration = \"line-through\";\n"; 
echo "            if (sVal == \"underline\") theSpan.style.textDecoration = \"underline\";\n"; 
echo "\n"; 
echo "            range = oEditor.document.createRange();\n"; 
echo "            range.selectNode(f);\n"; 
echo "            range.insertNode(theSpan);\n"; 
echo "            range.selectNode(f);\n"; 
echo "            range.deleteContents();\n"; 
echo "        }\n"; 
echo "        else\n"; 
echo "            if (f.parentNode.nodeName == \"SPAN\" && f.parentNode.childNodes.length == 1) {\n"; 
echo "                //font is the only child node of span.\n"; 
echo "                var theSpan = f.parentNode;\n"; 
echo "                if (sVal == \"bold\") theSpan.style.fontWeight = \"bold\";\n"; 
echo "                if (sVal == \"italic\") theSpan.style.fontStyle = \"italic\";\n"; 
echo "                if (sVal == \"line-through\") theSpan.style.textDecoration = \"line-through\";\n"; 
echo "                if (sVal == \"underline\") theSpan.style.textDecoration = \"underline\";\n"; 
echo "\n"; 
echo "                theSpan.innerHTML = f.innerHTML;\n"; 
echo "            }\n"; 
echo "            else {\n"; 
echo "                var newSpan = oEditor.document.createElement(\"SPAN\");\n"; 
echo "                if (sVal == \"bold\") newSpan.style.fontWeight = \"bold\";\n"; 
echo "                if (sVal == \"italic\") newSpan.style.fontStyle = \"italic\";\n"; 
echo "                if (sVal == \"line-through\") newSpan.style.textDecoration = \"line-through\";\n"; 
echo "                if (sVal == \"underline\") newSpan.style.textDecoration = \"underline\";\n"; 
echo "\n"; 
echo "                newSpan.innerHTML = f.innerHTML;\n"; 
echo "                f.parentNode.replaceChild(newSpan, f);\n"; 
echo "            }\n"; 
echo "    }\n"; 
echo "    return true;\n"; 
echo "};\n"; 
echo "function replaceTags(sFrom, sTo) {\n"; 
echo "    var oEditor = document.getElementById(\"idContent\" + this.oName).contentWindow;\n"; 
echo "\n"; 
echo "    var elements = oEditor.document.body.getElementsByTagName(sFrom);\n"; 
echo "\n"; 
echo "    while (elements.length > 0) {\n"; 
echo "        f = elements[0];\n"; 
echo "\n"; 
echo "        var newSpan = oEditor.document.createElement(sTo);\n"; 
echo "        newSpan.innerHTML = f.innerHTML;\n"; 
echo "        f.parentNode.replaceChild(newSpan, f);\n"; 
echo "    }\n"; 
echo "};\n"; 
echo "/************************************\n"; 
echo "Used in loadHTML, loadHTMLFull, \n"; 
echo "doKeyPress,\n"; 
echo "getHTML, getXHTML, \n"; 
echo "getHTMLBody, getXHTMLBody,\n"; 
echo "pasteWord.htm,\n"; 
echo "source_html.htm, source_xhtml.htm\n"; 
echo "*************************************/\n"; 
echo "function cleanDeprecated() {\n"; 
echo "    var oEditor = document.getElementById(\"idContent\" + this.oName).contentWindow;\n"; 
echo "\n"; 
echo "    var elements;\n"; 
echo "\n"; 
echo "    //elements=oEditor.document.body.getElementsByTagName(\"STRONG\");\n"; 
echo "    //this.cleanTags(elements,\"bold\");\n"; 
echo "    elements = oEditor.document.body.getElementsByTagName(\"B\");\n"; 
echo "    this.cleanTags(elements, \"bold\");\n"; 
echo "\n"; 
echo "    /* Membuat <i class=\"icon\"></i> terhapus */\n"; 
echo "    //elements = oEditor.document.body.getElementsByTagName(\"I\");\n"; 
echo "    //this.cleanTags(elements, \"italic\");\n"; 
echo "    //elements=oEditor.document.body.getElementsByTagName(\"EM\");\n"; 
echo "    //this.cleanTags(elements,\"italic\");\n"; 
echo "\n"; 
echo "    elements = oEditor.document.body.getElementsByTagName(\"STRIKE\");\n"; 
echo "    this.cleanTags(elements, \"line-through\");\n"; 
echo "    elements = oEditor.document.body.getElementsByTagName(\"S\");\n"; 
echo "    this.cleanTags(elements, \"line-through\");\n"; 
echo "\n"; 
echo "    elements = oEditor.document.body.getElementsByTagName(\"U\");\n"; 
echo "    this.cleanTags(elements, \"underline\");\n"; 
echo "\n"; 
echo "    this.replaceTags(\"DIR\", \"DIV\");\n"; 
echo "    this.replaceTags(\"MENU\", \"DIV\");\n"; 
echo "    this.replaceTags(\"CENTER\", \"DIV\");\n"; 
echo "    this.replaceTags(\"XMP\", \"PRE\");\n"; 
echo "    this.replaceTags(\"BASEFONT\", \"SPAN\"); //will be removed by cleanEmptySpan()\n"; 
echo "\n"; 
echo "    elements = oEditor.document.body.getElementsByTagName(\"APPLET\");\n"; 
echo "    while (elements.length > 0) {\n"; 
echo "        var f = elements[0];\n"; 
echo "        theParent = f.parentNode;\n"; 
echo "        theParent.removeChild(f);\n"; 
echo "    }\n"; 
echo "\n"; 
echo "    this.cleanFonts();\n"; 
echo "    this.cleanEmptySpan();\n"; 
echo "\n"; 
echo "    return true;\n"; 
echo "};\n"; 
echo "\n"; 
echo "/*** APPLY ***/\n"; 
echo "function applySpanStyle(arrStyles, sClassName, blockTag) {\n"; 
echo "    var useBlock = \"SPAN\";\n"; 
echo "    if (blockTag != null && blockTag != \"\") useBlock = blockTag;\n"; 
echo "\n"; 
echo "    var oEditor = document.getElementById(\"idContent\" + this.oName).contentWindow;\n"; 
echo "    var oSel = oEditor.getSelection();\n"; 
echo "\n"; 
echo "    var range;\n"; 
echo "    var oElement;\n"; 
echo "    if (!isTextSelected(oSel)) { //if not text selection\n"; 
echo "        range = oSel.getRangeAt(0);\n"; 
echo "        oElement = getSelectedElement(oSel);\n"; 
echo "        if (oElement.nodeName == useBlock) return oElement;\n"; 
echo "        return;\n"; 
echo "    }\n"; 
echo "\n"; 
echo "    this.hide();\n"; 
echo "    this.doCmd(\"fontname\", \"verdana\");\n"; 
echo "    oElement = getSelectedElement(oSel);\n"; 
echo "    oElement.style.fontFamily = \"\";\n"; 
echo "\n"; 
echo "    replaceWithSpan(oEditor, arrStyles, sClassName, useBlock);\n"; 
echo "    realTime(this);\n"; 
echo "};\n"; 
echo "function doClean() {\n"; 
echo "    this.saveForUndo(); //Save for Undo\n"; 
echo "\n"; 
echo "    if (oUtil.activeElement) var element = oUtil.activeElement;\n"; 
echo "    else {\n"; 
echo "        var oEditor = document.getElementById(\"idContent\" + this.oName).contentWindow;\n"; 
echo "        var oSel = oEditor.getSelection();\n"; 
echo "        element = getSelectedElement(oSel);\n"; 
echo "        if (isTextSelected(oSel)) {\n"; 
echo "            if (oSel != \"\") {\n"; 
echo "                var range = oSel.getRangeAt(0);\n"; 
echo "                if (element.innerHTML != range.toString()) {\n"; 
echo "                    this.doCmd('RemoveFormat');\n"; 
echo "                    realTime(this);\n"; 
echo "                    return;\n"; 
echo "                }\n"; 
echo "            }\n"; 
echo "            else {\n"; 
echo "                if (element.tagName == \"BODY\") return;\n"; 
echo "            }\n"; 
echo "        }\n"; 
echo "        else {\n"; 
echo "            if (element.tagName == \"BODY\") return;\n"; 
echo "        }\n"; 
echo "    }\n"; 
echo "\n"; 
echo "    element.removeAttribute(\"className\");\n"; 
echo "    element.removeAttribute(\"style\");\n"; 
echo "\n"; 
echo "    if (element.tagName == \"H1\" ||\n"; 
echo "    element.tagName == \"H2\" ||\n"; 
echo "    element.tagName == \"H3\" ||\n"; 
echo "    element.tagName == \"H4\" ||\n"; 
echo "    element.tagName == \"H5\" ||\n"; 
echo "    element.tagName == \"H6\" ||\n"; 
echo "    element.tagName == \"PRE\" ||\n"; 
echo "    element.tagName == \"P\" ||\n"; 
echo "    element.tagName == \"DIV\") {\n"; 
echo "        this.doCmd('FormatBlock', '<P>');\n"; 
echo "    }\n"; 
echo "\n"; 
echo "    this.doCmd('RemoveFormat');\n"; 
echo "    realTime(this);\n"; 
echo "};\n"; 
echo "\n"; 
echo "function cleanEmptySpan() {\n"; 
echo "    var bReturn = false;\n"; 
echo "    var oEditor = document.getElementById(\"idContent\" + this.oName).contentWindow;\n"; 
echo "    var reg = /<\s*SPAN\s*>/gi;\n"; 
echo "\n"; 
echo "    while (true) {\n"; 
echo "        var allSpans = oEditor.document.getElementsByTagName(\"SPAN\");\n"; 
echo "        if (allSpans.length == 0) break;\n"; 
echo "\n"; 
echo "        var emptySpans = [];\n"; 
echo "        for (var i = 0; i < allSpans.length; i++) {\n"; 
echo "\n"; 
echo "            if (allSpans[i].className == \"Apple-style-span\") allSpans[i].removeAttribute(\"class\", 0);\n"; 
echo "            if (allSpans[i].style.cssText == \"\") allSpans[i].removeAttribute(\"style\", 0);\n"; 
echo "\n"; 
echo "            if (getOuterHTML(allSpans[i]).search(reg) == 0)\n"; 
echo "                emptySpans[emptySpans.length] = allSpans[i];\n"; 
echo "        }\n"; 
echo "        if (emptySpans.length == 0) break;\n"; 
echo "        var theSpan, theParent;\n"; 
echo "        for (var i = 0; i < emptySpans.length; i++) {\n"; 
echo "            theSpan = emptySpans[i];\n"; 
echo "            theParent = theSpan.parentNode;\n"; 
echo "            if (!theParent) continue;\n"; 
echo "            if (theSpan.hasChildNodes()) {\n"; 
echo "                var range = oEditor.document.createRange();\n"; 
echo "                range.selectNodeContents(theSpan);\n"; 
echo "                var docFrag = range.extractContents();\n"; 
echo "                theParent.replaceChild(docFrag, theSpan);\n"; 
echo "            }\n"; 
echo "            else {\n"; 
echo "                theParent.removeChild(theSpan);\n"; 
echo "            }\n"; 
echo "            bReturn = true;\n"; 
echo "        }\n"; 
echo "    }\n"; 
echo "    return bReturn;\n"; 
echo "};\n"; 
echo "\n"; 
echo "/*** COMMON ***/\n"; 
echo "function copyStyleClass(newSpan, arrStyles, sClassName) {\n"; 
echo "    if (arrStyles) {\n"; 
echo "        for (var i = 0; i < arrStyles.length; i++) {\n"; 
echo "            //eval(\"newSpan.style.\"+arrStyles[i][0]+\"=\\"\"+arrStyles[i][1]+\"\\"\");\n"; 
echo "            newSpan.style[arrStyles[i][0]] = arrStyles[i][1];\n"; 
echo "        }\n"; 
echo "        if (newSpan.style.cssText == \"\") newSpan.removeAttribute(\"style\", 0);\n"; 
echo "    }\n"; 
echo "    if (sClassName)\n"; 
echo "        newSpan.className = sClassName;\n"; 
echo "};\n"; 
echo "\n"; 
echo "function copyAttribute(newSpan, f) {\n"; 
echo "    if ((f.face != null) && (f.face != \"\")) newSpan.style.fontFamily = f.face;\n"; 
echo "    if ((f.size != null) && (f.size != \"\")) {\n"; 
echo "        var nSize = \"\";\n"; 
echo "        if (f.size == 1) nSize = \"8pt\";\n"; 
echo "        else if (f.size == 2) nSize = \"10pt\";\n"; 
echo "        else if (f.size == 3) nSize = \"12pt\";\n"; 
echo "        else if (f.size == 4) nSize = \"14pt\";\n"; 
echo "        else if (f.size == 5) nSize = \"18pt\";\n"; 
echo "        else if (f.size == 6) nSize = \"24pt\";\n"; 
echo "        else if (f.size >= 7) nSize = \"36pt\";\n"; 
echo "        else if (f.size <= -2 || f.size == \"0\") nSize = \"8pt\";\n"; 
echo "        else if (f.size == \"-1\") nSize = \"10pt\";\n"; 
echo "        else if (f.size == 0) nSize = \"12pt\";\n"; 
echo "        else if (f.size == \"+1\") nSize = \"14pt\";\n"; 
echo "        else if (f.size == \"+2\") nSize = \"18pt\";\n"; 
echo "        else if (f.size == \"+3\") nSize = \"24pt\";\n"; 
echo "        else if (f.size == \"+4\" || f.size == \"+5\" || f.size == \"+6\") nSize = \"36pt\";\n"; 
echo "        else nSize = \"\";\n"; 
echo "        if (nSize != \"\") newSpan.style.fontSize = nSize;\n"; 
echo "    }\n"; 
echo "    if ((f.style.backgroundColor != null) && (f.style.backgroundColor != \"\")) newSpan.style.backgroundColor = f.style.backgroundColor;\n"; 
echo "    if ((f.color != null) && (f.color != \"\")) newSpan.style.color = f.color;\n"; 
echo "    if ((f.className != null) && (f.className != \"\")) newSpan.className = f.className;\n"; 
echo "};\n"; 
echo "\n"; 
echo "function replaceWithSpan(oEditor, arrStyles, sClassName, blockTag) {\n"; 
echo "    var useBlock = \"SPAN\";\n"; 
echo "    if (blockTag != null && blockTag != \"\") useBlock = blockTag;\n"; 
echo "\n"; 
echo "    var oSel = oEditor.getSelection();\n"; 
echo "\n"; 
echo "    var elm = getSelectedElement(oSel);\n"; 
echo "\n"; 
echo "    if (arrStyles || sClassName) copyStyleClass(elm, arrStyles, sClassName);\n"; 
echo "};\n"; 
echo "\n"; 
echo "/******** /NEW SPAN OPERATION *********/\n"; 
echo "\n"; 
echo "/*** REALTIME ***/\n"; 
echo "\n"; 
echo "function editorDoc_onkeyup(oEdt) {\n"; 
echo "\n"; 
echo "    if (oEdt.tmKeyup) { clearTimeout(oEdt.tmKeyup); oEdt.tmKeyup = null; }\n"; 
echo "    if (!oEdt.tmKeyup) oEdt.tmKeyup = setTimeout(function () { realTime(oEdt); }, 1000);\n"; 
echo "\n"; 
echo "    //realTime(edtObj);\n"; 
echo "};\n"; 
echo "function editorDoc_onmouseup(e, oName) {\n"; 
echo "    var edtObj = eval(oName);\n"; 
echo "    var edtFrm = document.getElementById(\"idContent\" + oName);\n"; 
echo "\n"; 
echo "    oUtil.activeElement = null; //focus ke editor, jgn pakai selection dari tag selector\n"; 
echo "    oUtil.oName = oName;\n"; 
echo "    oUtil.oEditor = edtFrm.contentWindow;\n"; 
echo "    oUtil.obj = edtObj;\n"; 
echo "    edtObj.hide(); //pengganti onfocus\n"; 
echo "\n"; 
echo "    if (e.target && e.target.tagName && e.target.tagName == 'IMG') {\n"; 
echo "        var oSel = edtFrm.contentWindow.getSelection();\n"; 
echo "        var range = oSel.getRangeAt(0);\n"; 
echo "        oSel.removeAllRanges();\n"; 
echo "        range.selectNodeContents(e.target); range.setEndAfter(e.target);\n"; 
echo "        oSel.addRange(range);\n"; 
echo "    }\n"; 
echo "\n"; 
echo "    realTime(edtObj);\n"; 
echo "};\n"; 
echo "function setActiveEditor(edtObj) {\n"; 
echo "    oUtil.oName = edtObj.oName;\n"; 
echo "    oUtil.oEditor = document.getElementById(\"idContent\" + edtObj.oName).contentWindow;\n"; 
echo "    oUtil.obj = edtObj;\n"; 
echo "};\n"; 
echo "\n"; 
echo "var arrTmp = [];\n"; 
echo "function GetElement(oElement, sMatchTag)//Used in realTime() only.\n"; 
echo "{\n"; 
echo "    while (oElement != null && oElement.tagName != sMatchTag) {\n"; 
echo "        if (oElement.tagName == \"BODY\") return null;\n"; 
echo "        oElement = oElement.parentNode;\n"; 
echo "    }\n"; 
echo "    return oElement;\n"; 
echo "};\n"; 
echo "\n"; 
echo "var arrTmp2 = []; //TAG SELECTOR\n"; 
echo "function realTime(edtObj) {\n"; 
echo "    try {\n"; 
echo "        var oName = edtObj.oName;\n"; 
echo "\n"; 
echo "        var oEditor = document.getElementById(\"idContent\" + oName).contentWindow;\n"; 
echo "\n"; 
echo "        var oSel = oEditor.getSelection();\n"; 
echo "        var element = getSelectedElement(oSel);\n"; 
echo "\n"; 
echo "        var obj = edtObj;\n"; 
echo "        var tbar = obj.tbar;\n"; 
echo "        var btn = null;\n"; 
echo "\n"; 
echo "        /* Table */\n"; 
echo "        var oTable = GetElement(element, \"TABLE\");\n"; 
echo "        if (oTable) obj.Table = oTable;\n"; 
echo "\n"; 
echo "        //Enable/Disable Table Edit & Cell Edit Menu\n"; 
echo "        /*\n"; 
echo "        if (obj.btnTable) {\n"; 
echo "\n"; 
echo "            var btn = tbar.btns[\"btnTableEdit\" + oName];\n"; 
echo "            var ddTbl = isDDs[btn.ddId];\n"; 
echo "            ddTbl.enableItem(\"mnuTableSize\" + oName, true);\n"; 
echo "            ddTbl.enableItem(\"mnuTableEdit\" + oName, true);\n"; 
echo "            ddTbl.enableItem(\"mnuCellEdit\" + oName, true);\n"; 
echo "            var oTable = GetElement(element, \"TABLE\");\n"; 
echo "            if (oTable) {\n"; 
echo "                ddTbl.enableItem(\"mnuCellEdit\" + oName, false);\n"; 
echo "                btn.setState(1);\n"; 
echo "            }\n"; 
echo "            else btn.setState(5);\n"; 
echo "\n"; 
echo "            var oTD = GetElement(element, \"TD\");\n"; 
echo "            if (oTD) {\n"; 
echo "                ddTbl.enableItem(\"mnuCellEdit\" + oName, true);\n"; 
echo "            }\n"; 
echo "        }*/\n"; 
echo "\n"; 
echo "        //REALTIME BUTTONS HERE\n"; 
echo "        var doc = oEditor.document;\n"; 
echo "\n"; 
echo "        if (obj.btnParagraph) {\n"; 
echo "            btn = tbar.btns[\"btnParagraph\" + oName];\n"; 
echo "            btn.setState(doc.queryCommandEnabled(\"FormatBlock\") ? 1 : 5);\n"; 
echo "        }\n"; 
echo "        if (obj.btnFontName) {\n"; 
echo "            btn = tbar.btns[\"btnFontName\" + oName];\n"; 
echo "            btn.setState(doc.queryCommandEnabled(\"FontName\") ? 1 : 5);\n"; 
echo "        }\n"; 
echo "\n"; 
echo "        if (obj.btnFontSize) {\n"; 
echo "            btn = tbar.btns[\"btnFontSize\" + oName];\n"; 
echo "            btn.setState(doc.queryCommandEnabled(\"FontSize\") ? 1 : 5);\n"; 
echo "        }\n"; 
echo "        //if(obj.btnPaste)\n"; 
echo "        //    {\n"; 
echo "        //    btn=tbar.btns[\"btnPaste\"+oName];\n"; 
echo "        //    btn.setState(doc.queryCommandEnabled(\"Paste\")?1:5);\n"; 
echo "        //    }\n"; 
echo "        if (obj.btnUndo) {\n"; 
echo "            btn = tbar.btns[\"btnUndo\" + oName];\n"; 
echo "            btn.setState(!obj.arrUndoList[0] ? 5 : 1);\n"; 
echo "        }\n"; 
echo "        if (obj.btnRedo) {\n"; 
echo "            btn = tbar.btns[\"btnRedo\" + oName];\n"; 
echo "            btn.setState(!obj.arrRedoList[0] ? 5 : 1);\n"; 
echo "        }\n"; 
echo "\n"; 
echo "        if (obj.btnBold) {\n"; 
echo "            btn = tbar.btns[\"btnBold\" + oName];\n"; 
echo "            btn.setState(doc.queryCommandEnabled(\"Bold\") ? (doc.queryCommandState(\"Bold\") ? 4 : 1) : 5);\n"; 
echo "        }\n"; 
echo "\n"; 
echo "        if (obj.btnItalic) {\n"; 
echo "            btn = tbar.btns[\"btnItalic\" + oName];\n"; 
echo "            btn.setState(doc.queryCommandEnabled(\"Italic\") ? (doc.queryCommandState(\"Italic\") ? 4 : 1) : 5);\n"; 
echo "        }\n"; 
echo "\n"; 
echo "        if (obj.btnUnderline) {\n"; 
echo "            btn = tbar.btns[\"btnUnderline\" + oName];\n"; 
echo "            btn.setState(doc.queryCommandEnabled(\"Underline\") ? (doc.queryCommandState(\"Underline\") ? 4 : 1) : 5);\n"; 
echo "        }\n"; 
echo "\n"; 
echo "        if (obj.btnStrikethrough) {\n"; 
echo "            btn = tbar.btns[\"btnStrikethrough\" + oName];\n"; 
echo "            btn.setState(doc.queryCommandEnabled(\"Strikethrough\") ? (doc.queryCommandState(\"Strikethrough\") ? 4 : 1) : 5);\n"; 
echo "        }\n"; 
echo "\n"; 
echo "        if (obj.btnSuperscript) {\n"; 
echo "            btn = tbar.btns[\"btnSuperscript\" + oName];\n"; 
echo "            btn.setState(doc.queryCommandEnabled(\"Superscript\") ? (doc.queryCommandState(\"Superscript\") ? 4 : 1) : 5);\n"; 
echo "        }\n"; 
echo "\n"; 
echo "        if (obj.btnSubscript) {\n"; 
echo "            btn = tbar.btns[\"btnSubscript\" + oName];\n"; 
echo "            btn.setState(doc.queryCommandEnabled(\"Subscript\") ? (doc.queryCommandState(\"Subscript\") ? 4 : 1) : 5);\n"; 
echo "        }\n"; 
echo "\n"; 
echo "        if (obj.btnNumbering) {\n"; 
echo "            btn = tbar.btns[\"btnNumbering\" + oName];\n"; 
echo "            btn.setState(doc.queryCommandEnabled(\"InsertOrderedList\") ? (doc.queryCommandState(\"InsertOrderedList\") ? 4 : 1) : 5);\n"; 
echo "        }\n"; 
echo "\n"; 
echo "        if (obj.btnBullets) {\n"; 
echo "            btn = tbar.btns[\"btnBullets\" + oName];\n"; 
echo "            btn.setState(doc.queryCommandEnabled(\"InsertUnorderedList\") ? (doc.queryCommandState(\"InsertUnorderedList\") ? 4 : 1) : 5);\n"; 
echo "        }\n"; 
echo "\n"; 
echo "        if (obj.btnJustifyLeft) {\n"; 
echo "            btn = tbar.btns[\"btnJustifyLeft\" + oName];\n"; 
echo "            btn.setState(doc.queryCommandEnabled(\"JustifyLeft\") ? (doc.queryCommandState(\"JustifyLeft\") ? 4 : 1) : 5);\n"; 
echo "        }\n"; 
echo "        if (obj.btnJustifyCenter) {\n"; 
echo "            btn = tbar.btns[\"btnJustifyCenter\" + oName];\n"; 
echo "            btn.setState(doc.queryCommandEnabled(\"JustifyCenter\") ? (doc.queryCommandState(\"JustifyCenter\") ? 4 : 1) : 5);\n"; 
echo "        }\n"; 
echo "\n"; 
echo "        if (obj.btnJustifyRight) {\n"; 
echo "            btn = tbar.btns[\"btnJustifyRight\" + oName];\n"; 
echo "            btn.setState(doc.queryCommandEnabled(\"JustifyRight\") ? (doc.queryCommandState(\"JustifyRight\") ? 4 : 1) : 5);\n"; 
echo "        }\n"; 
echo "        if (obj.btnJustifyFull) {\n"; 
echo "            btn = tbar.btns[\"btnJustifyFull\" + oName];\n"; 
echo "            btn.setState(doc.queryCommandEnabled(\"JustifyFull\") ? (doc.queryCommandState(\"JustifyFull\") ? 4 : 1) : 5);\n"; 
echo "        }\n"; 
echo "\n"; 
echo "        if (obj.btnIndent) {\n"; 
echo "            btn = tbar.btns[\"btnIndent\" + oName];\n"; 
echo "            btn.setState(doc.queryCommandEnabled(\"Indent\") ? 1 : 5);\n"; 
echo "        }\n"; 
echo "\n"; 
echo "        if (obj.btnOutdent) {\n"; 
echo "            btn = tbar.btns[\"btnOutdent\" + oName];\n"; 
echo "            btn.setState(doc.queryCommandEnabled(\"Outdent\") ? 1 : 5);\n"; 
echo "        }\n"; 
echo "\n"; 
echo "        if (obj.btnLTR) {\n"; 
echo "            btn = tbar.btns[\"btnLTR\" + oName];\n"; 
echo "            btn.setState(element.dir ? (element.dir.toLowerCase() == \"ltr\" ? 4 : 1) : 1);\n"; 
echo "        }\n"; 
echo "        if (obj.btnRTL) {\n"; 
echo "            btn = tbar.btns[\"btnRTL\" + oName];\n"; 
echo "            btn.setState(element.dir ? (element.dir.toLowerCase() == \"rtl\" ? 4 : 1) : 1);\n"; 
echo "        }\n"; 
echo "\n"; 
echo "\n"; 
echo "        var v = (element ? 1 : 5);\n"; 
echo "        if (obj.btnForeColor) tbar.btns[\"btnForeColor\" + oName].setState(v);\n"; 
echo "        if (obj.btnBackColor) tbar.btns[\"btnBackColor\" + oName].setState(v);\n"; 
echo "        if (obj.btnLine) tbar.btns[\"btnLine\" + oName].setState(v);\n"; 
echo "\n"; 
echo "        try { oUtil.onSelectionChanged() } catch (e) {; }\n"; 
echo "\n"; 
echo "        try { obj.onSelectionChanged() } catch (e) {; }\n"; 
echo "\n"; 
echo "        //STYLE SELECTOR ~~~~~~~~~~~~~~~~~~\n"; 
echo "        var idStyles = document.getElementById(\"idStyles\" + oName);\n"; 
echo "        if (idStyles.innerHTML != \"\") {\n"; 
echo "            var oElement;\n"; 
echo "            if (oUtil.activeElement)\n"; 
echo "                oElement = oUtil.activeElement;\n"; 
echo "            else\n"; 
echo "                oElement = getSelectedElement(oSel);\n"; 
echo "            var sCurrClass = oElement.className;\n"; 
echo "\n"; 
echo "            var oRows = document.getElementById(\"tblStyles\" + oName).rows;\n"; 
echo "            for (var i = 0; i < oRows.length - 1; i++) {\n"; 
echo "                sClass = oRows[i].childNodes[0].childNodes[0].innerHTML;\n"; 
echo "                if (sClass.split(\".\").length > 1 && sClass != \"\") sClass = sClass.split(\".\")[1];\n"; 
echo "                if (sCurrClass == sClass) {\n"; 
echo "                    oRows[i].style.marginRight = \"1px\";\n"; 
echo "                    oRows[i].style.backgroundColor = obj.styleSelectionHoverBg;\n"; 
echo "                    oRows[i].style.color = obj.styleSelectionHoverFg;\n"; 
echo "                }\n"; 
echo "                else {\n"; 
echo "                    oRows[i].style.marginRight = \"\";\n"; 
echo "                    oRows[i].style.backgroundColor = \"\";\n"; 
echo "                    oRows[i].style.color = \"\";\n"; 
echo "                }\n"; 
echo "            }\n"; 
echo "        }\n"; 
echo "\n"; 
echo "        //TAG SELECTOR ~~~~~~~~~~~~~~~~~~\n"; 
echo "        if (obj.useTagSelector) {\n"; 
echo "            oElement = element;\n"; 
echo "            var sHTML = \"\"; var i = 0;\n"; 
echo "            arrTmp2 = []; //clear\n"; 
echo "            while (oElement != null && oElement.tagName != \"BODY\" && oElement.nodeType == 1) {\n"; 
echo "                arrTmp2[i] = oElement;\n"; 
echo "                sHTML = \"&nbsp; &lt;<span id=tag\" + oName + i + \" unselectable=on style='text-decoration:underline;cursor:pointer' onclick=\\"\" + oName + \".selectElement(\" + i + \")\\">\" + oElement.tagName + \"</span>&gt;\" + sHTML;\n"; 
echo "                oElement = oElement.parentNode;\n"; 
echo "                i++;\n"; 
echo "            }\n"; 
echo "            sHTML = \"&nbsp;&lt;BODY&gt;\" + sHTML;\n"; 
echo "            document.getElementById(\"idElNavigate\" + oName).innerHTML = sHTML;\n"; 
echo "            document.getElementById(\"idElCommand\" + oName).style.display = \"none\";\n"; 
echo "            for (i = 0; i < arrTmp2.length; i++) {\n"; 
echo "                document.getElementById(\"tag\" + oName + i).addEventListener(\"click\", new Function(oName + \".selectElement(\" + i + \")\"), true);\n"; 
echo "            }\n"; 
echo "        }\n"; 
echo "\n"; 
echo "        //BLOCKQUOTE ~~~~~~~~~~~~~~~~~~\n"; 
echo "        btn = tbar.btns[\"btnQuote\" + oName];\n"; 
echo "        if (btn) {\n"; 
echo "            var oQuote = GetElement(element, \"BLOCKQUOTE\");\n"; 
echo "            btn.setState(oQuote ? 4 : 1);\n"; 
echo "        }\n"; 
echo "\n"; 
echo "    } catch (e) {; }\n"; 
echo "\n"; 
echo "};\n"; 
echo "\n"; 
echo "function realtimeFontSelect(oName) {\n"; 
echo "    var oEditor = document.getElementById(\"idContent\" + oName).contentWindow;\n"; 
echo "    var sFontName = oEditor.document.queryCommandValue(\"FontName\");\n"; 
echo "    var edt = eval(oName);\n"; 
echo "\n"; 
echo "    var found = false;\n"; 
echo "    for (var i = 0; i < edt.arrFontName.length; i++) {\n"; 
echo "        if (sFontName == edt.arrFontName[i]) { found = true; break; }\n"; 
echo "    }\n"; 
echo "    if (found) {\n"; 
echo "        isDDs[\"ddFontName\" + oName].selectItem(\"btnFontName_\" + i + oName, true);\n"; 
echo "    } else {\n"; 
echo "        isDDs[\"ddFontName\" + oName].clearSelection();\n"; 
echo "    }\n"; 
echo "\n"; 
echo "\n"; 
echo "};\n"; 
echo "function realtimeSizeSelect(oName) {\n"; 
echo "    var oEditor = document.getElementById(\"idContent\" + oName).contentWindow;\n"; 
echo "    var sFontSize = oEditor.document.queryCommandValue(\"FontSize\");\n"; 
echo "\n"; 
echo "    var edt = eval(oName);\n"; 
echo "\n"; 
echo "    var found = false;\n"; 
echo "    for (var i = 0; i < edt.arrFontSize.length; i++) {\n"; 
echo "        if (sFontSize == edt.arrFontSize[i][1]) { found = true; break; }\n"; 
echo "    }\n"; 
echo "    if (found) {\n"; 
echo "        isDDs[\"ddFontSize\" + oName].selectItem(\"btnFontSize_\" + i + oName, true);\n"; 
echo "    } else {\n"; 
echo "        isDDs[\"ddFontSize\" + oName].clearSelection();\n"; 
echo "    }\n"; 
echo "};\n"; 
echo "\n"; 
echo "/*** TAG SELECTOR ***/\n"; 
echo "function moveTagSelector() {\n"; 
echo "    var edtArea = document.getElementById(\"idArea\" + this.oName);\n"; 
echo "    var nWidth = edtArea.offsetWidth - 90;\n"; 
echo "    var icPath = this.scriptPath.substring(0, this.scriptPath.indexOf(\"saf/\")) + this.iconPath;\n"; 
echo "    /*\n"; 
echo "    idElNavigate width seharusnya 100%. Dibuat px utk menghindari flicker problem di Nets8\n"; 
echo "    */\n"; 
echo "    var sTagSelTop = \"<table unselectable=on ondblclick='\" + this.oName + \".moveTagSelector()' width='100%' cellpadding=0 cellspacing=0 style='border:none;border:#cfcfcf 1px solid;border-bottom:none;margin:0px'><tr style='background-color:#f4f4f4;font-family:arial;font-size:10px;color:black;'>\" +\n"; 
echo "        \"<td id=idElNavigate\" + this.oName + \" style='color:inherit;line-height:normal;font-size:inherit;padding:1px;width:\" + nWidth + \"px' valign=top>&nbsp;</td>\" +\n"; 
echo "        \"<td align=right valign='center' nowrap style='color:inherit;padding:0;margin;0;font-size:inherit;line-height:normal'>\" +\n"; 
echo "        \"<span id=idElCommand\" + this.oName + \" unselectable=on style='vertical-align:middle;display:none;text-decoration:underline;cursor:pointer;padding-right:5px;' onclick='\" + this.oName + \".removeTag()'>\" + getTxt(\"Remove Tag\") + \"</span>\" +\n"; 
echo "        \"</td></tr></table>\";\n"; 
echo "\n"; 
echo "    var sTagSelBottom = \"<table unselectable=on ondblclick='\" + this.oName + \".moveTagSelector()' width='100%' cellpadding=0 cellspacing=0 style='border:none;border-left:#cfcfcf 1px solid;border-right:#cfcfcf 1px solid;margin:0px'><tr style='background-color:#f4f4f4;font-family:arial;font-size:10px;color:black;'>\" +\n"; 
echo "        \"<td id=idElNavigate\" + this.oName + \" style='color:inherit;line-height:normal;font-size:inherit;padding:1px;width:\" + nWidth + \"px' valign=top>&nbsp;</td>\" +\n"; 
echo "        \"<td align=right valign='center' nowrap style='color:inherit;padding:0;margin;0;font-size:inherit;line-height:normal'>\" +\n"; 
echo "        \"<span id=idElCommand\" + this.oName + \" unselectable=on style='vertical-align:middle;display:none;text-decoration:underline;cursor:pointer;padding-right:5px;' onclick='\" + this.oName + \".removeTag()'>\" + getTxt(\"Remove Tag\") + \"</span>\" +\n"; 
echo "        \"</td></tr></table>\";\n"; 
echo "\n"; 
echo "    var selTop = document.getElementById(\"idTagSelTop\" + this.oName);\n"; 
echo "    var selTopRow = document.getElementById(\"idTagSelTopRow\" + this.oName);\n"; 
echo "    var selBottom = document.getElementById(\"idTagSelBottom\" + this.oName);\n"; 
echo "    var selBottomRow = document.getElementById(\"idTagSelBottomRow\" + this.oName);\n"; 
echo "\n"; 
echo "    if (this.TagSelectorPosition == \"top\") {\n"; 
echo "        selTop.innerHTML = \"\";\n"; 
echo "        selBottom.innerHTML = sTagSelBottom;\n"; 
echo "        selTopRow.style.display = \"none\";\n"; 
echo "        selBottomRow.style.display = \"\";\n"; 
echo "        this.TagSelectorPosition = \"bottom\";\n"; 
echo "    }\n"; 
echo "    else//if(this.TagSelectorPosition==\"bottom\")\n"; 
echo "    {\n"; 
echo "        selTop.innerHTML = sTagSelTop;\n"; 
echo "        selBottom.innerHTML = \"\";\n"; 
echo "        selTopRow.style.display = \"\";\n"; 
echo "        selBottomRow.style.display = \"none\";\n"; 
echo "        this.TagSelectorPosition = \"top\";\n"; 
echo "    }\n"; 
echo "};\n"; 
echo "function selectElement(i) {\n"; 
echo "    if (!this.useTagSelector) return;\n"; 
echo "    var oEditor = document.getElementById(\"idContent\" + this.oName).contentWindow;\n"; 
echo "\n"; 
echo "    var range = oEditor.document.createRange();\n"; 
echo "    range.selectNode(arrTmp2[i]);\n"; 
echo "\n"; 
echo "    var oSel = oEditor.getSelection();\n"; 
echo "    oSel.removeAllRanges();\n"; 
echo "    oSel.addRange(range);\n"; 
echo "\n"; 
echo "    oActiveElement = arrTmp2[i];\n"; 
echo "    if (oActiveElement.tagName != \"TD\" &&\n"; 
echo "        oActiveElement.tagName != \"TR\" &&\n"; 
echo "        oActiveElement.tagName != \"TBODY\" &&\n"; 
echo "        oActiveElement.tagName != \"LI\")\n"; 
echo "        document.getElementById(\"idElCommand\" + this.oName).style.display = \"\";\n"; 
echo "\n"; 
echo "    for (var j = 0; j < arrTmp2.length; j++) document.getElementById(\"tag\" + this.oName + j).style.background = \"\";\n"; 
echo "    document.getElementById(\"tag\" + this.oName + i).style.background = \"DarkGray\";\n"; 
echo "\n"; 
echo "    if (oActiveElement)\n"; 
echo "        oUtil.activeElement = oActiveElement; //Set active element in the Editor\n"; 
echo "\n"; 
echo "    this.focus();\n"; 
echo "};\n"; 
echo "function removeTag() {\n"; 
echo "    this.saveForUndo(); //Save for Undo\n"; 
echo "    var oEditor = document.getElementById(\"idContent\" + this.oName).contentWindow;\n"; 
echo "\n"; 
echo "    var oSel = oEditor.getSelection();\n"; 
echo "    var element = getSelectedElement(oSel);\n"; 
echo "    var nearElement = element.nextSibling == null ? (element.previousSibling == null ? element.parentNode : element.previousSibling) : element.nextSibling;\n"; 
echo "    switch (element.nodeName) {\n"; 
echo "        case \"TABLE\":;\n"; 
echo "        case \"IMG\":;\n"; 
echo "        case \"INPUT\":;\n"; 
echo "        case \"FORM\":;\n"; 
echo "        case \"SELECT\":\n"; 
echo "            element.parentNode.removeChild(element);\n"; 
echo "            break;\n"; 
echo "        default:\n"; 
echo "            oSel = oEditor.getSelection();\n"; 
echo "            var range = oSel.getRangeAt(0);\n"; 
echo "            var docFrag = range.createContextualFragment(element.innerHTML);\n"; 
echo "            range.selectNode(element);\n"; 
echo "            range.deleteContents();\n"; 
echo "\n"; 
echo "            range.insertNode(docFrag);\n"; 
echo "            try { oEditor.document.designMode = \"on\"; } catch (e) { }\n"; 
echo "            break;\n"; 
echo "    }\n"; 
echo "\n"; 
echo "    oSel = oEditor.getSelection();\n"; 
echo "    oSel.removeAllRanges();\n"; 
echo "    var range = oEditor.document.createRange();\n"; 
echo "    range.setStart(nearElement, 0);\n"; 
echo "    range.setEnd(nearElement, 0);\n"; 
echo "    oSel.addRange(range);\n"; 
echo "\n"; 
echo "    this.focus();\n"; 
echo "    realTime(this);\n"; 
echo "};\n"; 
echo "\n"; 
echo "/*** Apply Formatting ***/\n"; 
echo "function doCmd(sCmd, sOption) {\n"; 
echo "\n"; 
echo "    if (sCmd == \"Bold\" || sCmd == \"Italic\" || sCmd == \"Underline\" || sCmd == \"Strikethrough\" ||\n"; 
echo "        sCmd == \"Superscript\" || sCmd == \"Subscript\" ||\n"; 
echo "        sCmd == \"Indent\" || sCmd == \"Outdent\" || sCmd == \"InsertHorizontalRule\")\n"; 
echo "        this.saveForUndo(); //Save for Undo\n"; 
echo "\n"; 
echo "    var oEditor = document.getElementById(\"idContent\" + this.oName).contentWindow;\n"; 
echo "    oEditor.document.execCommand(\"styleWithCSS\", false, true);\n"; 
echo "    oEditor.document.execCommand(sCmd, false, sOption);\n"; 
echo "    realTime(this);\n"; 
echo "};\n"; 
echo "function applyColor(sType, sColor) {\n"; 
echo "    this.hide();\n"; 
echo "    this.focus(); //Focus stuff\n"; 
echo "    var oEditor = document.getElementById(\"idContent\" + this.oName).contentWindow;\n"; 
echo "    this.saveForUndo();\n"; 
echo "    if (sColor != null && sColor != \"\") {\n"; 
echo "        oEditor.document.execCommand(\"styleWithCSS\", false, true);\n"; 
echo "        oEditor.document.execCommand(sType, false, sColor);\n"; 
echo "        //spy setelah apply bisa select & ditampilkan di tag selector\n"; 
echo "        var sel = oEditor.getSelection();\n"; 
echo "        var range = sel.getRangeAt(0);\n"; 
echo "        if (range.startContainer.nodeType == Node.TEXT_NODE) {\n"; 
echo "            var el = range.startContainer.nextSibling;\n"; 
echo "            if (el) {\n"; 
echo "                range = oEditor.document.createRange();\n"; 
echo "                range.selectNode(el);\n"; 
echo "                sel = oEditor.getSelection();\n"; 
echo "                sel.removeAllRanges();\n"; 
echo "                sel.addRange(range);\n"; 
echo "            }\n"; 
echo "        }\n"; 
echo "    }\n"; 
echo "    else {\n"; 
echo "        var el = getSelectedElement(oEditor.getSelection());\n"; 
echo "        if (sType == \"ForeColor\") {\n"; 
echo "            el.style.color = \"\";\n"; 
echo "        }\n"; 
echo "        else if (sType == \"HiliteColor\") {\n"; 
echo "            el.style.backgroundColor = \"\";\n"; 
echo "        }\n"; 
echo "    }\n"; 
echo "\n"; 
echo "    realTime(this);\n"; 
echo "    if (sColor == \"\") return;\n"; 
echo "    //this.selectElement(0);\n"; 
echo "};\n"; 
echo "\n"; 
echo "function applyParagraph(val) {\n"; 
echo "    var oEditor = document.getElementById(\"idContent\" + this.oName).contentWindow;\n"; 
echo "    var oSel = oEditor.getSelection();\n"; 
echo "    this.hide();\n"; 
echo "    this.saveForUndo();\n"; 
echo "    this.doCmd(\"FormatBlock\", val);\n"; 
echo "};\n"; 
echo "\n"; 
echo "function applyFontName(val) {\n"; 
echo "    this.hide();\n"; 
echo "    this.saveForUndo();\n"; 
echo "\n"; 
echo "    var oEditor = document.getElementById(\"idContent\" + this.oName).contentWindow;\n"; 
echo "    var oSel = oEditor.getSelection();\n"; 
echo "    var oElement = getSelectedElement(oSel);\n"; 
echo "\n"; 
echo "    //if (oElement != null && oElement.tagName == \"SPAN\") {\n"; 
echo "    //    oElement.style.fontFamily = val;\n"; 
echo "    //} else {\n"; 
echo "    this.doCmd(\"fontname\", val);\n"; 
echo "    //}\n"; 
echo "\n"; 
echo "};\n"; 
echo "\n"; 
echo "function applyFontSize(val) {\n"; 
echo "\n"; 
echo "    this.hide();\n"; 
echo "    this.saveForUndo();\n"; 
echo "\n"; 
echo "    var oEditor = document.getElementById(\"idContent\" + this.oName).contentWindow;\n"; 
echo "    var oSel = oEditor.getSelection();\n"; 
echo "\n"; 
echo "    /*\n"; 
echo "    var oElement = getSelectedElement(oSel);\n"; 
echo "    if (oElement != null && oElement.tagName == \"SPAN\") {\n"; 
echo "        oElement.style.fontSize = mapFontSize(val);\n"; 
echo "    } else {\n"; 
echo "        this.doCmd(\"fontsize\", val);\n"; 
echo "        oSel = oEditor.getSelection();\n"; 
echo "        oElement = getSelectedElement(oSel);\n"; 
echo "        if (oElement != null) oElement.style.fontSize = mapFontSize(val);\n"; 
echo "    }\n"; 
echo "    */\n"; 
echo "\n"; 
echo "    this.doCmd(\"fontsize\", 1);\n"; 
echo "\n"; 
echo "    var range = oSel.getRangeAt(0);\n"; 
echo "    var commonParent = range.commonAncestorContainer;\n"; 
echo "    if (commonParent.nodeType != 1) {\n"; 
echo "        commonParent = commonParent.parentNode;\n"; 
echo "    }\n"; 
echo "    if (commonParent != null) {\n"; 
echo "        commonParent.style.fontSize = val; //mapFontSize(val);\n"; 
echo "    }\n"; 
echo "\n"; 
echo "    var spans = commonParent.getElementsByTagName(\"SPAN\");\n"; 
echo "    for (var i = 0; i < spans.length; i++) {\n"; 
echo "        if (oSel.containsNode(spans[i], true)) {\n"; 
echo "            spans[i].style.fontSize = val; //mapFontSize(val);\n"; 
echo "        }\n"; 
echo "    }\n"; 
echo "\n"; 
echo "    realTime(this);\n"; 
echo "};\n"; 
echo "\n"; 
echo "function mapFontSize(v) {\n"; 
echo "    var s = \"8pt\";\n"; 
echo "    if (v == 1) s = \"8pt\";\n"; 
echo "    else if (v == 2) s = \"10pt\";\n"; 
echo "    else if (v == 3) s = \"12pt\";\n"; 
echo "    else if (v == 4) s = \"14pt\";\n"; 
echo "    else if (v == 5) s = \"18pt\";\n"; 
echo "    else if (v == 6) s = \"24pt\";\n"; 
echo "    else if (v >= 7) s = \"36pt\";\n"; 
echo "    else if (v <= -2 || v == \"0\") s = \"8pt\";\n"; 
echo "    else if (v == \"-1\") s = \"10pt\";\n"; 
echo "    else if (v == 0) s = \"12pt\";\n"; 
echo "    else if (v == \"+1\") s = \"14pt\";\n"; 
echo "    else if (v == \"+2\") s = \"18pt\";\n"; 
echo "    else if (v == \"+3\") s = \"24pt\";\n"; 
echo "    else if (v == \"+4\" || v == \"+5\" || v == \"+6\") s = \"36pt\";\n"; 
echo "\n"; 
echo "    return s;\n"; 
echo "};\n"; 
echo "\n"; 
echo "function applyFormattingStyle(cmd, opt) {\n"; 
echo "\n"; 
echo "    var oEditor = document.getElementById(\"idContent\" + this.oName).contentWindow;\n"; 
echo "    var oSel = oEditor.getSelection();\n"; 
echo "    var oElement = getSelectedElement(oSel);\n"; 
echo "    var doc = oEditor.document;\n"; 
echo "\n"; 
echo "    var range = oSel.getRangeAt(0);\n"; 
echo "\n"; 
echo "    if (oElement != null && oElement.tagName == \"SPAN\" && oElement.textContent == range.toString()) {\n"; 
echo "\n"; 
echo "        if (cmd == \"Bold\" || cmd == \"Italic\" || cmd == \"Underline\" || cmd == \"Strikethrough\" ||\n"; 
echo "       cmd == \"Superscript\" || cmd == \"Subscript\") {\n"; 
echo "\n"; 
echo "            this.saveForUndo();\n"; 
echo "\n"; 
echo "            switch (cmd) {\n"; 
echo "                case \"Bold\": oElement.style.fontWeight = (!doc.queryCommandState(\"Bold\") ? \"bold\" : \"\"); break;\n"; 
echo "                case \"Italic\": oElement.style.fontStyle = (!doc.queryCommandState(\"Italic\") ? \"italic\" : \"\"); break;\n"; 
echo "                case \"Underline\": oElement.style.textDecoration = (!doc.queryCommandState(\"Underline\") ? \"underline\" : \"\"); break;\n"; 
echo "                case \"Strikethrough\": oElement.style.textDecoration = (!doc.queryCommandState(\"Strikethrough\") ? \"line-through\" : \"\"); break;\n"; 
echo "                case \"Superscript\": oElement.style.verticalAlign = (!doc.queryCommandState(\"Superscript\") ? \"super\" : \"\"); break;\n"; 
echo "                case \"Subscript\": oElement.style.verticalAlign = (!doc.queryCommandState(\"Subscript\") ? \"sub\" : \"\"); break;\n"; 
echo "            }\n"; 
echo "\n"; 
echo "            realTime(this);\n"; 
echo "\n"; 
echo "        }\n"; 
echo "\n"; 
echo "        //oElement.style.fontFamily = val;\n"; 
echo "    } else {\n"; 
echo "        this.doCmd(cmd, opt);\n"; 
echo "    }\n"; 
echo "\n"; 
echo "\n"; 
echo "\n"; 
echo "\n"; 
echo "};\n"; 
echo "\n"; 
echo "function applyBullets() {\n"; 
echo "    this.saveForUndo();\n"; 
echo "    this.doCmd(\"InsertUnOrderedList\");\n"; 
echo "    this.tbar.btns[\"btnNumbering\" + this.oName].setState(1);\n"; 
echo "\n"; 
echo "    var oEditor = document.getElementById(\"idContent\" + this.oName).contentWindow;\n"; 
echo "    var oSel = oEditor.getSelection();\n"; 
echo "    var oElement = getSelectedElement(oSel);\n"; 
echo "\n"; 
echo "\n"; 
echo "    var li = GetElement(oElement, \"LI\");\n"; 
echo "    while (oElement != null &&\n"; 
echo "        oElement.tagName != \"OL\" &&\n"; 
echo "        oElement.tagName != \"UL\") {\n"; 
echo "        if (oElement.tagName == \"BODY\") return;\n"; 
echo "        oElement = oElement.parentNode;\n"; 
echo "    }\n"; 
echo "    oElement.removeAttribute(\"type\", 0);\n"; 
echo "    oElement.style.listStyleImage = \"\";\n"; 
echo "\n"; 
echo "    //safari always create ul inside p or div, remove this unnecessary p or div.\n"; 
echo "    var container = oElement.parentNode;\n"; 
echo "    if (container.firstChild == container.lastChild && container.tagName != \"BODY\") {\n"; 
echo "        container.parentNode.insertBefore(oElement, container);\n"; 
echo "        container.parentNode.removeChild(container);\n"; 
echo "    }\n"; 
echo "\n"; 
echo "    if (li) {\n"; 
echo "\n"; 
echo "        //remove rubbish span tag generated by safari.\n"; 
echo "        if (li.firstChild && (li.firstChild == li.lastChild) && li.firstChild.tagName == 'SPAN') {\n"; 
echo "            //remove the span\n"; 
echo "            var old = li.removeChild(li.firstChild);\n"; 
echo "            li.innerHTML = old.innerHTML;\n"; 
echo "        }\n"; 
echo "\n"; 
echo "        if (li.textContent == \"\") li.innerHTML = \"<br />\";\n"; 
echo "        oSel = oEditor.getSelection();\n"; 
echo "        var range = oEditor.document.createRange();\n"; 
echo "        range.selectNodeContents(li);\n"; 
echo "        range.collapse(false);\n"; 
echo "        oSel.removeAllRanges();\n"; 
echo "        oSel.addRange(range);\n"; 
echo "    }\n"; 
echo "\n"; 
echo "};\n"; 
echo "\n"; 
echo "function applyNumbering() {\n"; 
echo "    this.saveForUndo();\n"; 
echo "    this.doCmd(\"InsertOrderedList\");\n"; 
echo "    this.tbar.btns[\"btnBullets\" + this.oName].setState(1);\n"; 
echo "\n"; 
echo "    var oEditor = document.getElementById(\"idContent\" + this.oName).contentWindow;\n"; 
echo "    var oSel = oEditor.getSelection();\n"; 
echo "    var oElement = getSelectedElement(oSel);\n"; 
echo "    var li = GetElement(oElement, \"LI\");\n"; 
echo "    while (oElement != null &&\n"; 
echo "        oElement.tagName != \"OL\" &&\n"; 
echo "        oElement.tagName != \"UL\") {\n"; 
echo "        if (oElement.tagName == \"BODY\") return;\n"; 
echo "        oElement = oElement.parentNode;\n"; 
echo "    }\n"; 
echo "    oElement.removeAttribute(\"type\", 0);\n"; 
echo "    oElement.style.listStyleImage = \"\";\n"; 
echo "\n"; 
echo "    var container = oElement.parentNode;\n"; 
echo "    if (container.firstChild == container.lastChild && container.tagName != \"BODY\") {\n"; 
echo "        container.parentNode.insertBefore(oElement, container);\n"; 
echo "        container.parentNode.removeChild(container);\n"; 
echo "    }\n"; 
echo "\n"; 
echo "    if (li) {\n"; 
echo "        //remove rubbish span tag generated by safari.\n"; 
echo "        if (li.firstChild && (li.firstChild == li.lastChild) && li.firstChild.tagName == 'SPAN') {\n"; 
echo "            //remove the span\n"; 
echo "            var old = li.removeChild(li.firstChild);\n"; 
echo "            li.innerHTML = old.innerHTML;\n"; 
echo "        }\n"; 
echo "\n"; 
echo "        if (li.textContent == \"\") li.innerHTML = \"\";\n"; 
echo "\n"; 
echo "        oSel = oEditor.getSelection();\n"; 
echo "        var range = oEditor.document.createRange();\n"; 
echo "        range.selectNodeContents(li);\n"; 
echo "        range.collapse(false);\n"; 
echo "        oSel.removeAllRanges();\n"; 
echo "        oSel.addRange(range);\n"; 
echo "    }\n"; 
echo "\n"; 
echo "};\n"; 
echo "\n"; 
echo "function applyOutdent() {\n"; 
echo "    this.doCmd(\"Outdent\");\n"; 
echo "    cleanWebkitUselessSpan(this);\n"; 
echo "};\n"; 
echo "\n"; 
echo "function applyJustifyLeft() {\n"; 
echo "    this.saveForUndo();\n"; 
echo "    this.doCmd(\"JustifyLeft\");\n"; 
echo "};\n"; 
echo "function applyJustifyCenter() {\n"; 
echo "    this.saveForUndo();\n"; 
echo "    this.doCmd(\"JustifyCenter\");\n"; 
echo "};\n"; 
echo "function applyJustifyRight() {\n"; 
echo "    this.saveForUndo();\n"; 
echo "    this.doCmd(\"JustifyRight\");\n"; 
echo "};\n"; 
echo "function applyJustifyFull() {\n"; 
echo "    this.saveForUndo();\n"; 
echo "    this.doCmd(\"JustifyFull\");\n"; 
echo "};\n"; 
echo "function applyBlockDirLTR() {\n"; 
echo "    this.saveForUndo();\n"; 
echo "    var oEditor = document.getElementById(\"idContent\" + this.oName).contentWindow;\n"; 
echo "    var oSel = oEditor.getSelection();\n"; 
echo "    var oEl = getSelectedElement(oSel);\n"; 
echo "    if (oEl.dir) oEl.removeAttribute(\"dir\"); else oEl.dir = \"ltr\";\n"; 
echo "    this.focus();\n"; 
echo "};\n"; 
echo "function applyBlockDirRTL() {\n"; 
echo "    this.saveForUndo();\n"; 
echo "    //this.doCmd(\"BlockDirRTL\");\n"; 
echo "    var oEditor = document.getElementById(\"idContent\" + this.oName).contentWindow;\n"; 
echo "    var oSel = oEditor.getSelection();\n"; 
echo "    var oEl = getSelectedElement(oSel);\n"; 
echo "    if (oEl.dir) oEl.removeAttribute(\"dir\"); else oEl.dir = \"rtl\";\n"; 
echo "    this.focus();\n"; 
echo "};\n"; 
echo "function insertCustomTag(index) {\n"; 
echo "    this.insertHTML(this.arrCustomTag[index][1]);\n"; 
echo "    this.hide();\n"; 
echo "    this.focus();\n"; 
echo "};\n"; 
echo "function expandSelection() {\n"; 
echo "    var oEditor = document.getElementById(\"idContent\" + this.oName).contentWindow;\n"; 
echo "    var oSel = oEditor.getSelection();\n"; 
echo "    var range = oSel.getRangeAt(0);\n"; 
echo "    if (range.startContainer.nodeType == Node.TEXT_NODE) {\n"; 
echo "        if (range.toString() == \"\") {\n"; 
echo "            //select a word\n"; 
echo "            var sPos = range.startOffset;\n"; 
echo "            var ePos = range.endOffset;\n"; 
echo "            var startCont = range.startContainer;\n"; 
echo "            var str = startCont.nodeValue;\n"; 
echo "            sPos = str.substring(0, range.startOffset).search(/(\W+\w*)$/i);\n"; 
echo "            sPos = sPos == -1 ? 0 : sPos;\n"; 
echo "            var tPos = str.substring(sPos, range.startOffset).search(/\w+/i);\n"; 
echo "            sPos += (tPos == -1 ? str.substring(sPos, range.startOffset).length : tPos);\n"; 
echo "            ePos = str.substr(range.endOffset).search(/\W+/i);\n"; 
echo "            ePos = ePos == -1 ? str.length : ePos + range.endOffset;\n"; 
echo "            range = oEditor.document.createRange();\n"; 
echo "            range.setStart(startCont, sPos);\n"; 
echo "            range.setEnd(startCont, ePos);\n"; 
echo "            oSel = oEditor.getSelection();\n"; 
echo "            oSel.removeAllRanges();\n"; 
echo "            oSel.addRange(range);\n"; 
echo "        }\n"; 
echo "    }\n"; 
echo "\n"; 
echo "    return;\n"; 
echo "};\n"; 
echo "function selectParagraph() {\n"; 
echo "    var oEditor = document.getElementById(\"idContent\" + this.oName).contentWindow;\n"; 
echo "    var oSel = oEditor.getSelection();\n"; 
echo "    var selParent = getSelectedElement(oSel);\n"; 
echo "    if (selParent) {\n"; 
echo "        if (oSel.getRangeAt(0).toString() == \"\") {\n"; 
echo "            var oElement = selParent;\n"; 
echo "            while (oElement != null &&\n"; 
echo "                oElement.tagName != \"H1\" &&\n"; 
echo "                oElement.tagName != \"H2\" &&\n"; 
echo "                oElement.tagName != \"H3\" &&\n"; 
echo "                oElement.tagName != \"H4\" &&\n"; 
echo "                oElement.tagName != \"H5\" &&\n"; 
echo "                oElement.tagName != \"H6\" &&\n"; 
echo "                oElement.tagName != \"PRE\" &&\n"; 
echo "                oElement.tagName != \"P\" &&\n"; 
echo "                oElement.tagName != \"DIV\") {\n"; 
echo "                if (oElement.tagName == \"BODY\") return;\n"; 
echo "                oElement = oElement.parentNode;\n"; 
echo "            }\n"; 
echo "\n"; 
echo "            var range = oEditor.document.createRange();\n"; 
echo "            range.selectNode(oElement);\n"; 
echo "            oSel = oEditor.getSelection();\n"; 
echo "            oSel.removeAllRanges();\n"; 
echo "            oSel.addRange(range);\n"; 
echo "        }\n"; 
echo "    }\n"; 
echo "};\n"; 
echo "\n"; 
echo "function insertHTML(sHTML) {\n"; 
echo "    var oEditor = document.getElementById(\"idContent\" + this.oName).contentWindow;\n"; 
echo "    var oSel = oEditor.getSelection();\n"; 
echo "    var range = oSel.getRangeAt(0);\n"; 
echo "	\n"; 
echo "    this.saveForUndo();\n"; 
echo "\n"; 
echo "    range.extractContents();\n"; 
echo "    range.collapse(true);\n"; 
echo "\n"; 
echo "    var docFrag = range.createContextualFragment(sHTML);\n"; 
echo "    //range.collapse(false);\n"; 
echo "    var lastNode = docFrag.lastChild;\n"; 
echo "    range.insertNode(docFrag);\n"; 
echo "    try { oEditor.document.designMode = \"on\"; } catch (e) { }\n"; 
echo "    range.setStartAfter(lastNode);\n"; 
echo "    range.setEndAfter(lastNode);\n"; 
echo "\n"; 
echo "    //workaround.for unknown reason, chrome need 2 br to make new line if cursor located at the end of document.\n"; 
echo "    if (sHTML == \"<br />\" && range.endContainer.nodeType == 1) {\n"; 
echo "        // \n"; 
echo "        if (range.endOffset == range.endContainer.childNodes.length - 1) {\n"; 
echo "            range.insertNode(range.createContextualFragment(\"<br />\"));\n"; 
echo "            range.setStartAfter(lastNode);\n"; 
echo "            range.setEndAfter(lastNode);\n"; 
echo "        }\n"; 
echo "    }\n"; 
echo "    //\n"; 
echo "\n"; 
echo "    var comCon = range.commonAncestorContainer;\n"; 
echo "    if (comCon && comCon.parentNode) {\n"; 
echo "        try { comCon.parentNode.normalize(); } catch (e) { }\n"; 
echo "    }\n"; 
echo "\n"; 
echo "    oSel.removeAllRanges();\n"; 
echo "    oSel.addRange(range);\n"; 
echo "\n"; 
echo "};\n"; 
echo "\n"; 
echo "function insertLink(url, title, target, rel) {\n"; 
echo "    var oEditor = document.getElementById(\"idContent\" + this.oName).contentWindow;\n"; 
echo "    var oSel = oEditor.getSelection();\n"; 
echo "    var range = oSel.getRangeAt(0);\n"; 
echo "\n"; 
echo "    this.saveForUndo();\n"; 
echo "\n"; 
echo "	var oImg = getSelectedElement(oSel);\n"; 
echo "    if (oImg) {\n"; 
echo "		if (oImg.tagName == \"IMG\") oImg.style.border = \"none\";\n"; 
echo "    }\n"; 
echo "	\n"; 
echo "    var emptySel = false;\n"; 
echo "    if (range.toString() == \"\") {\n"; 
echo "        if (range.startContainer.nodeType == Node.ELEMENT_NODE) {\n"; 
echo "            if (range.startContainer.childNodes[range.startOffset].nodeType != Node.TEXT_NODE) {\n"; 
echo "                if (range.startContainer.childNodes[range.startOffset].nodeName == \"BR\") emptySel = true; else emptySel = false;\n"; 
echo "            } else {\n"; 
echo "                emptySel = true;\n"; 
echo "            }\n"; 
echo "        } else {\n"; 
echo "            emptySel = true;\n"; 
echo "        }\n"; 
echo "\n"; 
echo "        if (emptySel) {\n"; 
echo "            var cap = (title != \"\" && title != null ? title : url);\n"; 
echo "            var node = oEditor.document.createTextNode(cap);\n"; 
echo "            range.insertNode(node);\n"; 
echo "            try { oEditor.document.designMode = \"on\"; } catch (e) { }\n"; 
echo "\n"; 
echo "            range = oEditor.document.createRange();\n"; 
echo "            range.setStart(node, 0);\n"; 
echo "            range.setEnd(node, cap.length);\n"; 
echo "\n"; 
echo "            oSel = oEditor.getSelection();\n"; 
echo "            oSel.removeAllRanges();\n"; 
echo "            oSel.addRange(range);\n"; 
echo "        }\n"; 
echo "    }\n"; 
echo "	\n"; 
echo "	if (oImg && oImg.tagName == \"IMG\") {\n"; 
echo "\n"; 
echo "			var newA = oEditor.document.createElement(\"A\");\n"; 
echo "			newA.href = url;\n"; 
echo "			range.selectNode(oImg);\n"; 
echo "			range.surroundContents(newA);\n"; 
echo "\n"; 
echo "			oImg.style.border=\"none\";\n"; 
echo "\n"; 
echo "			range.selectNodeContents(oImg);\n"; 
echo "			range.setEndAfter(oImg);\n"; 
echo "\n"; 
echo "			oSel.removeAllRanges();\n"; 
echo "			oSel.addRange(range);\n"; 
echo "\n"; 
echo "	}\n"; 
echo "	else {\n"; 
echo "		var isSelInMidText = (range.startContainer.nodeType == Node.TEXT_NODE) && (range.startOffset > 0);\n"; 
echo "		oEditor.document.execCommand(\"styleWithCSS\", false, true);\n"; 
echo "		oEditor.document.execCommand(\"CreateLink\", false, url);\n"; 
echo "	}\n"; 
echo "\n"; 
echo "    oSel = oEditor.getSelection();\n"; 
echo "    oEl = GetElement(getSelectedElement(oSel), \"A\");\n"; 
echo "\n"; 
echo "    if (oEl) {\n"; 
echo "        if (target != \"\" && target != undefined) oEl.target = target;\n"; 
echo "        if (rel != \"\" && rel != undefined) oEl.setAttribute(\"rel\", rel);\n"; 
echo "    }\n"; 
echo "};\n"; 
echo "\n"; 
echo "function clearAll() {\n"; 
echo "    if (confirm(getTxt(\"Are you sure you wish to delete all contents?\")) == true) {\n"; 
echo "        this.saveForUndo();\n"; 
echo "        var oEditor = document.getElementById(\"idContent\" + this.oName).contentWindow;\n"; 
echo "        oEditor.document.body.innerHTML = \"<BR>\";\n"; 
echo "        oEditor.focus();\n"; 
echo "    }\n"; 
echo "};\n"; 
echo "function applySpan(blockTag) {\n"; 
echo "    var useBlock = \"SPAN\";\n"; 
echo "    if (blockTag != null && blockTag != \"\") useBlock = blockTag;\n"; 
echo "\n"; 
echo "    var oEditor = document.getElementById(\"idContent\" + this.oName).contentWindow;\n"; 
echo "    var oSel = oEditor.getSelection();\n"; 
echo "\n"; 
echo "    var range;\n"; 
echo "    var oElement;\n"; 
echo "    var sHTML;\n"; 
echo "    if (!isTextSelected(oSel)) { //if not text selection\n"; 
echo "        range = oSel.getRangeAt(0);\n"; 
echo "        oElement = getSelectedElement(oSel);\n"; 
echo "        if (oElement.nodeName == useBlock) return oElement;\n"; 
echo "        return;\n"; 
echo "    }\n"; 
echo "    range = oSel.getRangeAt(0);\n"; 
echo "    sHTML = range.toString();\n"; 
echo "\n"; 
echo "    var docFrag = range.extractContents();\n"; 
echo "    var idSpan = oEditor.document.createElement(useBlock);\n"; 
echo "    idSpan.appendChild(docFrag);\n"; 
echo "    range.insertNode(idSpan);\n"; 
echo "    try { oEditor.document.designMode = \"on\"; } catch (e) { }\n"; 
echo "\n"; 
echo "    range = oEditor.document.createRange();\n"; 
echo "    range.selectNode(idSpan);\n"; 
echo "    oSel = oEditor.getSelection();\n"; 
echo "    oSel.removeAllRanges();\n"; 
echo "    oSel.addRange(range);\n"; 
echo "\n"; 
echo "    return idSpan;\n"; 
echo "};\n"; 
echo "function makeAbsolute() {\n"; 
echo "    var oEditor = document.getElementById(\"idContent\" + this.oName).contentWindow;\n"; 
echo "    var oSel = oEditor.getSelection();\n"; 
echo "    var oEl = getSelectedElement(oSel);\n"; 
echo "\n"; 
echo "    this.saveForUndo();\n"; 
echo "\n"; 
echo "    if (oEl != null && oEl.nodeName != \"BODY\") {\n"; 
echo "        if (oEl.style.position == \"absolute\") oEl.style.position = \"\";\n"; 
echo "        else oEl.style.position = \"absolute\";\n"; 
echo "    }\n"; 
echo "};\n"; 
echo "\n"; 
echo "/*** Table Insert Dropdown ***/\n"; 
echo "function doOver_TabCreate(el) {\n"; 
echo "    var oTD = el;\n"; 
echo "    var oTable = oTD.parentNode.parentNode.parentNode;\n"; 
echo "    var nRow = oTD.parentNode.rowIndex;\n"; 
echo "    var nCol = oTD.cellIndex;\n"; 
echo "    var rows = oTable.rows;\n"; 
echo "    var custCell = rows[rows.length - 1].childNodes[0];\n"; 
echo "    custCell.innerHTML = \"<div>\" + (nRow * 1 + 1) + \" x \" + (nCol * 1 + 1) + \" \" + getTxt(\"Table Dimension Text\") + \"</div>\";\n"; 
echo "\n"; 
echo "    custCell.style.backgroundColor = \"\";\n"; 
echo "    custCell.style.color = \"#000000\";\n"; 
echo "    custCell.style.border = \"0px\";\n"; 
echo "    for (var i = 0; i < rows.length - 1; i++) {\n"; 
echo "        var oRow = rows[i];\n"; 
echo "        for (var j = 0; j < oRow.childNodes.length; j++) {\n"; 
echo "            var oCol = oRow.childNodes[j];\n"; 
echo "            if (i <= nRow && j <= nCol) oCol.style.backgroundColor = \"#316ac5\";\n"; 
echo "            else oCol.style.backgroundColor = \"#ffffff\";\n"; 
echo "        }\n"; 
echo "    }\n"; 
echo "    //event.cancelBubble=true;\n"; 
echo "};\n"; 
echo "function doOut_TabCreate(el) {\n"; 
echo "    var oTable = el;\n"; 
echo "    if (oTable.nodeName != \"TABLE\") return;\n"; 
echo "    var rows = oTable.rows;\n"; 
echo "    for (var i = 0; i < rows.length - 1; i++) {\n"; 
echo "        var oRow = rows[i];\n"; 
echo "        for (var j = 0; j < oRow.childNodes.length; j++) {\n"; 
echo "            var oCol = oRow.childNodes[j];\n"; 
echo "            oCol.style.backgroundColor = \"#ffffff\";\n"; 
echo "        }\n"; 
echo "    }\n"; 
echo "    //event.cancelBubble=true;\n"; 
echo "};\n"; 
echo "function doRefresh_TabCreate() {\n"; 
echo "    if (!this.btnTable) return;\n"; 
echo "    var oTable = document.getElementById(\"dropTableCreate\" + this.oName);\n"; 
echo "    var rows = oTable.rows;\n"; 
echo "    for (var i = 0; i < rows.length - 1; i++) {\n"; 
echo "        var oRow = rows[i];\n"; 
echo "        for (var j = 0; j < oRow.childNodes.length; j++) {\n"; 
echo "            var oCol = oRow.childNodes[j];\n"; 
echo "            oCol.style.backgroundColor = \"#ffffff\";\n"; 
echo "        }\n"; 
echo "    }\n"; 
echo "};\n"; 
echo "function doClick_TabCreate(el) {\n"; 
echo "    this.hide();\n"; 
echo "\n"; 
echo "    var oEditor = document.getElementById(\"idContent\" + this.oName).contentWindow;\n"; 
echo "\n"; 
echo "    var oTD = el;\n"; 
echo "    var nRow = oTD.parentNode.rowIndex + 1;\n"; 
echo "    var nCol = oTD.cellIndex + 1;\n"; 
echo "\n"; 
echo "    this.saveForUndo();\n"; 
echo "\n"; 
echo "    var sHTML = \"<table style='border-collapse:collapse;width:100%;' selThis='selThis'>\";\n"; 
echo "    for (var i = 1; i <= nRow; i++) {\n"; 
echo "        sHTML += \"<tr>\";\n"; 
echo "        for (var j = 1; j <= nCol; j++) {\n"; 
echo "            //sHTML+=\"<td style='border:#000000 1px solid'><br/></td>\";\n"; 
echo "            sHTML += \"<td><br/></td>\";\n"; 
echo "        }\n"; 
echo "        sHTML += \"</tr>\";\n"; 
echo "    }\n"; 
echo "    sHTML += \"</table>\";\n"; 
echo "\n"; 
echo "    var oSel = oEditor.getSelection();\n"; 
echo "    var range = oSel.getRangeAt(0);\n"; 
echo "    range.collapse(true);\n"; 
echo "\n"; 
echo "    var docFrag = range.createContextualFragment(sHTML);\n"; 
echo "    range.insertNode(docFrag);\n"; 
echo "    try { oEditor.document.designMode = \"on\"; } catch (e) { }\n"; 
echo "    var allTabs = oEditor.document.getElementsByTagName(\"TABLE\");\n"; 
echo "    for (var i = 0; i < allTabs.length; i++) {\n"; 
echo "        if (allTabs[i].getAttribute(\"selThis\") == \"selThis\") {\n"; 
echo "            range = oEditor.document.createRange();\n"; 
echo "            range.selectNode(allTabs[i]);\n"; 
echo "            oSel = oEditor.getSelection();\n"; 
echo "            oSel.removeAllRanges();\n"; 
echo "            oSel.addRange(range);\n"; 
echo "            allTabs[i].removeAttribute(\"selThis\");\n"; 
echo "            break;\n"; 
echo "        }\n"; 
echo "    }\n"; 
echo "    realTime(this);\n"; 
echo "};\n"; 
echo "\n"; 
echo "/*** doKeyPress ***/\n"; 
echo "function doKeyPress(evt, obj) {\n"; 
echo "    if (!obj.arrUndoList[0]) { obj.saveForUndo(); } //pengganti saveForUndo_First\n"; 
echo "\n"; 
echo "    if (evt.ctrlKey || evt.metaKey) {\n"; 
echo "        switch (evt.keyCode) {\n"; 
echo "            case 89: obj.doRedo(); break; //redo, CTRL-Y           \n"; 
echo "            case 90: obj.doUndo(); break; //undo, CTRL-Z           \n"; 
echo "\n"; 
echo "            case 86: //CTRL-V\n"; 
echo "\n"; 
echo "                if (obj.pasteTextOnCtrlV) {\n"; 
echo "\n"; 
echo "                    evt.preventDefault();\n"; 
echo "                    modelessDialogShow(obj.dialogPath + \"webpastetext.htm\", 400, 280);\n"; 
echo "\n"; 
echo "                } else {\n"; 
echo "\n"; 
echo "\n"; 
echo "                    var mainEditor = document.getElementById(\"idContent\" + obj.oName).contentWindow;\n"; 
echo "\n"; 
echo "                    //save selection\n"; 
echo "                    var oSel = mainEditor.getSelection();\n"; 
echo "                    var range = oSel.getRangeAt(0);\n"; 
echo "\n"; 
echo "                    mainEditor.document.body.contentEditable = false;\n"; 
echo "\n"; 
echo "					var scrTop = (mainEditor.document.body.scrollTop);\n"; 
echo "\n"; 
echo "                    var pasteArea = mainEditor.document.getElementById(\"pasteArea\");\n"; 
echo "                    if (!pasteArea) {\n"; 
echo "                        pasteArea = document.createElement(\"div\");\n"; 
echo "                        pasteArea.id = \"pasteArea\";\n"; 
echo "                        pasteArea.style.position = \"absolute\";\n"; 
echo "                        pasteArea.style.top = scrTop + \"px\";\n"; 
echo "						pasteArea.style.width = \"1px\";\n"; 
echo "						pasteArea.style.height = \"1px\";\n"; 
echo "						pasteArea.style.border = \"none\";\n"; 
echo "						pasteArea.style.overflow = \"hidden\";\n"; 
echo "                        pasteArea.contentEditable = true;\n"; 
echo "                        mainEditor.document.body.appendChild(pasteArea);\n"; 
echo "                    }\n"; 
echo "					\n"; 
echo "                    pasteArea.focus();\n"; 
echo "\n"; 
echo "                    window.setTimeout(function () {\n"; 
echo "\n"; 
echo "                        var str = obj.fixWord();\n"; 
echo "						\n"; 
echo "                        var mainEditor = document.getElementById(\"idContent\" + obj.oName).contentWindow;\n"; 
echo "						mainEditor.document.body.contentEditable = true;\n"; 
echo "                        var oSel = mainEditor.getSelection();\n"; 
echo "                        oSel.removeAllRanges();\n"; 
echo "                        oSel.addRange(range);\n"; 
echo "\n"; 
echo "                        obj.insertHTML(str);				\n"; 
echo "						\n"; 
echo "                    }, 100);\n"; 
echo "\n"; 
echo "                }\n"; 
echo "                break;\n"; 
echo "                //case 88: obj.saveForUndo(); break; //CTRL-X           \n"; 
echo "        }\n"; 
echo "    }\n"; 
echo "\n"; 
echo "    if (evt.keyCode == 37 || evt.keyCode == 38 || evt.keyCode == 39 || evt.keyCode == 40)//Arrow\n"; 
echo "    {\n"; 
echo "        obj.saveForUndo(); //Save for Undo\n"; 
echo "    }\n"; 
echo "\n"; 
echo "    if (evt.keyCode == 13) {\n"; 
echo "\n"; 
echo "        obj.saveForUndo(); //Save for Undo\n"; 
echo "\n"; 
echo "        if (evt.shiftKey) {\n"; 
echo "            obj.insertHTML(\"<br />\");\n"; 
echo "            evt.preventDefault();\n"; 
echo "        } else {\n"; 
echo "            if (obj.returnKeyMode == 3) {\n"; 
echo "\n"; 
echo "                //insert p\n"; 
echo "                $applyReturnEvent(evt, obj, \"p\");\n"; 
echo "\n"; 
echo "            } else if (obj.returnKeyMode == 2) {\n"; 
echo "\n"; 
echo "                //insert br\n"; 
echo "                $applyReturnEvent(evt, obj, \"br\");\n"; 
echo "\n"; 
echo "            } else {\n"; 
echo "\n"; 
echo "                //insert div\n"; 
echo "                //default behavior  \n"; 
echo "                $applyReturnEvent(evt, obj, \"div\");\n"; 
echo "\n"; 
echo "            }\n"; 
echo "        }\n"; 
echo "\n"; 
echo "    }\n"; 
echo "\n"; 
echo "    obj.onKeyPress();\n"; 
echo "};\n"; 
echo "\n"; 
echo "\n"; 
echo "function $getBlockElement(el) {\n"; 
echo "\n"; 
echo "    if (el == null) return null;\n"; 
echo "\n"; 
echo "    var block = \"|H1|H2|H3|H4|H5|H6|PRE|DIV|P|TD|\";\n"; 
echo "\n"; 
echo "    while (el.tagName != \"BODY\") {\n"; 
echo "        if (block.indexOf(\"|\" + el.tagName + \"|\") != -1) {\n"; 
echo "            return el;\n"; 
echo "        }\n"; 
echo "        el = el.parentNode;\n"; 
echo "    };\n"; 
echo "    return null;\n"; 
echo "};\n"; 
echo "\n"; 
echo "function $applyReturnEvent(evt, obj, tag) {\n"; 
echo "\n"; 
echo "    //check current container.\n"; 
echo "    var wnd = document.getElementById(\"idContent\" + obj.oName).contentWindow;\n"; 
echo "    var sel = wnd.getSelection();\n"; 
echo "\n"; 
echo "    //check if inside li\n"; 
echo "    var selElm = getSelectedElement(sel);\n"; 
echo "    if (selElm) {\n"; 
echo "        var li = GetElement(selElm, \"LI\");\n"; 
echo "        if (li) {\n"; 
echo "\n"; 
echo "            if (li.textContent == \"\") {\n"; 
echo "\n"; 
echo "                //move out to from ul/ol\n"; 
echo "                var range = sel.getRangeAt(0);\n"; 
echo "                var list = li.parentNode;\n"; 
echo "                range.setStartAfter(list);\n"; 
echo "                range.setEndAfter(list);\n"; 
echo "\n"; 
echo "                li.parentNode.removeChild(li);\n"; 
echo "\n"; 
echo "                //create a tag after list\n"; 
echo "                if (tag == \"br\") {\n"; 
echo "                    docFrag = range.createContextualFragment(\"<\" + tag + \" />\");\n"; 
echo "                } else {\n"; 
echo "                    docFrag = range.createContextualFragment(\"<\" + tag + \"></\" + tag + \">\");\n"; 
echo "                }\n"; 
echo "                var cnt = docFrag.firstChild; //save the reference to docFrag content because after insert, docFrag will be empty\n"; 
echo "                if (cnt.innerHTML == \"\") cnt.innerHTML = \"&nbsp;\";\n"; 
echo "                range.insertNode(docFrag);\n"; 
echo "                range.selectNodeContents(cnt);\n"; 
echo "                cnt.normalize();\n"; 
echo "                cnt.parentNode.normalize();\n"; 
echo "\n"; 
echo "                range.collapse(true);\n"; 
echo "\n"; 
echo "                sel.removeAllRanges();\n"; 
echo "                sel.addRange(range);\n"; 
echo "\n"; 
echo "                evt.preventDefault();\n"; 
echo "\n"; 
echo "                return;\n"; 
echo "\n"; 
echo "            } else {\n"; 
echo "                /*\n"; 
echo "                //move cursor outside li and insert\n"; 
echo "                var range = sel.getRangeAt(0);\n"; 
echo "                range.setStartAfter(li);\n"; 
echo "                range.setEndAfter(li);\n"; 
echo "                //insert li instead\n"; 
echo "                var docFrag = range.createContextualFragment(\"<li></li>\");\n"; 
echo "                var newLi = docFrag.firstChild;\n"; 
echo "                range.insertNode(docFrag);\n"; 
echo "                range.selectNodeContents(newLi);\n"; 
echo "                range.collapse(true);\n"; 
echo "\n"; 
echo "                sel.removeAllRanges();\n"; 
echo "                sel.addRange(range);\n"; 
echo "\n"; 
echo "                evt.preventDefault();\n"; 
echo "                return;   */\n"; 
echo "\n"; 
echo "                var range = sel.getRangeAt(0);\n"; 
echo "                range.setEndAfter(li);\n"; 
echo "                var docFrag = range.extractContents();\n"; 
echo "                var newLi = docFrag.firstChild;\n"; 
echo "                if (newLi.textContent == \"\") newLi.innerHTML = \"<br />\";\n"; 
echo "                range.insertNode(docFrag);\n"; 
echo "                range.selectNodeContents(newLi);\n"; 
echo "                range.collapse(false);\n"; 
echo "\n"; 
echo "                sel.removeAllRanges();\n"; 
echo "                sel.addRange(range);\n"; 
echo "\n"; 
echo "                evt.preventDefault();\n"; 
echo "                return;\n"; 
echo "            }\n"; 
echo "\n"; 
echo "        }\n"; 
echo "    }\n"; 
echo "\n"; 
echo "    if (tag == \"br\") {\n"; 
echo "        obj.insertHTML(\"<br />\");\n"; 
echo "        evt.preventDefault();\n"; 
echo "        return;\n"; 
echo "    }\n"; 
echo "\n"; 
echo "    //if other tags.\n"; 
echo "    var el = $getBlockElement(getSelectedElement(sel));\n"; 
echo "\n"; 
echo "    if (el && (\n"; 
echo "       el.tagName == \"H1\" || el.tagName == \"H2\" || el.tagName == \"H3\" ||\n"; 
echo "       el.tagName == \"H4\" || el.tagName == \"H5\" || el.tagName == \"H6\" ||\n"; 
echo "       el.tagName == \"P\" || el.tagName == \"DIV\" || el.tagName == \"PRE\")) {\n"; 
echo "\n"; 
echo "        //alert(9);\n"; 
echo "\n"; 
echo "    } else {\n"; 
echo "\n"; 
echo "        obj.doCmd('FormatBlock', tag);\n"; 
echo "        sel = wnd.getSelection();\n"; 
echo "        el = $getBlockElement(getSelectedElement(sel));\n"; 
echo "\n"; 
echo "    }\n"; 
echo "\n"; 
echo "    if (el) {\n"; 
echo "        var r = sel.getRangeAt(0);\n"; 
echo "\n"; 
echo "        r.setEndAfter(el);\n"; 
echo "        var docFrag = r.extractContents();\n"; 
echo "\n"; 
echo "        if (el.innerHTML == \"\") {\n"; 
echo "            el.innerHTML = \"&nbsp;\";\n"; 
echo "            el.parentNode.normalize();\n"; 
echo "            el.normalize();\n"; 
echo "        }\n"; 
echo "\n"; 
echo "        //insert the fragment\n"; 
echo "        r.setStartAfter(el);\n"; 
echo "        r.setEndAfter(el);\n"; 
echo "        r.collapse(true);\n"; 
echo "\n"; 
echo "        //if the fragment is empty, create new one). This happen if the cursor is located at the end of line.\n"; 
echo "        var isH = (\",H1,H2,H3,H4,H5,H6,\".indexOf(\",\" + el.tagName + \",\") >= 0);\n"; 
echo "\n"; 
echo "        if (docFrag && docFrag.firstChild && (isH || docFrag.firstChild.nodeType == 3) && docFrag.firstChild.textContent == \"\") {\n"; 
echo "\n"; 
echo "            docFrag = r.createContextualFragment(\"<\" + tag + \"></\" + tag + \">\");\n"; 
echo "        }\n"; 
echo "\n"; 
echo "        var cnt = docFrag.firstChild; //save the reference to docFrag content because after insert, docFrag will be empty\n"; 
echo "        if (cnt.textContent == \"\") cnt.innerHTML = \"<br />\";\n"; 
echo "        r.insertNode(docFrag);\n"; 
echo "        r.selectNodeContents(cnt);\n"; 
echo "        cnt.normalize();\n"; 
echo "        cnt.parentNode.normalize();\n"; 
echo "\n"; 
echo "        r.collapse(true);\n"; 
echo "\n"; 
echo "        //update the range\n"; 
echo "        sel.removeAllRanges();\n"; 
echo "        sel.addRange(r);\n"; 
echo "\n"; 
echo "        ensureVisible(cnt, document.getElementById(\"idContent\" + obj.oName));\n"; 
echo "\n"; 
echo "        //remove temporary br\n"; 
echo "        //if(cnt.innerHTML==\"<br>\") cnt.innerHTML=\"\";\n"; 
echo "\n"; 
echo "        evt.preventDefault();\n"; 
echo "\n"; 
echo "    }\n"; 
echo "};\n"; 
echo "\n"; 
echo "/*** fullScreen ***/\n"; 
echo "function fullScreen() {\n"; 
echo "    var oEditor = document.getElementById(\"idContent\" + this.oName).contentWindow;\n"; 
echo "    var edtArea = document.getElementById(\"idArea\" + this.oName);\n"; 
echo "\n"; 
echo "    this.hide();\n"; 
echo "\n"; 
echo "    if (this.stateFullScreen) {\n"; 
echo "        this.onNormalScreen();\n"; 
echo "        this.stateFullScreen = false;\n"; 
echo "        document.body.style.overflow = \"\";\n"; 
echo "        document.getElementById(\"id_refresh_z_index\").style.margin = \"0px\";\n"; 
echo "        edtArea.style.position = \"\";\n"; 
echo "        edtArea.style.top = \"0px\";\n"; 
echo "        edtArea.style.left = \"0px\";\n"; 
echo "\n"; 
echo "        if (this.width.toString().indexOf(\"%\") != -1) edtArea.style.width = this.width;\n"; 
echo "        else edtArea.style.width = parseInt(this.width) + \"px\";\n"; 
echo "\n"; 
echo "        if (this.height.toString().indexOf(\"%\") != -1) edtArea.style.height = this.height;\n"; 
echo "        else edtArea.style.height = parseInt(this.height) + \"px\";\n"; 
echo "\n"; 
echo "        for (var i = 0; i < oUtil.arrEditor.length; i++) {\n"; 
echo "            if (oUtil.arrEditor[i] != this.oName) {\n"; 
echo "                document.getElementById(\"idArea\" + oUtil.arrEditor[i]).style.display = \"\";\n"; 
echo "                try { document.getElementById(\"idContent\" + oUtil.arrEditor[i]).contentWindow.document.designMode = \"on\"; } catch (e) { } //new\n"; 
echo "            }\n"; 
echo "        }\n"; 
echo "    }\n"; 
echo "    else {\n"; 
echo "        this.onFullScreen();\n"; 
echo "        this.stateFullScreen = true;\n"; 
echo "        window.scroll(0, 0);\n"; 
echo "        document.body.style.overflow = \"hidden\";\n"; 
echo "        document.getElementById(\"id_refresh_z_index\").style.margin = \"70px\";\n"; 
echo "        edtArea.style.position = \"absolute\";\n"; 
echo "        edtArea.style.top = \"0px\";\n"; 
echo "        edtArea.style.left = \"0px\";\n"; 
echo "        edtArea.style.width = window.innerWidth + \"px\";\n"; 
echo "        edtArea.style.height = window.innerHeight + \"px\";\n"; 
echo "        edtArea.style.zIndex = 2000;\n"; 
echo "\n"; 
echo "        for (var i = 0; i < oUtil.arrEditor.length; i++) {\n"; 
echo "            if (oUtil.arrEditor[i] != this.oName) document.getElementById(\"idArea\" + oUtil.arrEditor[i]).style.display = \"none\";\n"; 
echo "        }\n"; 
echo "        oEditor.focus();\n"; 
echo "    }\n"; 
echo "\n"; 
echo "    try { oEditor.document.designMode = \"on\"; } catch (e) { }\n"; 
echo "\n"; 
echo "    var idStyles = document.getElementById(\"idStyles\" + this.oName);\n"; 
echo "    idStyles.innerHTML = \"\"\n"; 
echo "};\n"; 
echo "\n"; 
echo "/*** Show/Hide Dropdown ***/\n"; 
echo "function modelessDialogShow(url, width, height, p, opt) {\n"; 
echo "    modalDialog(url, width, height); //windowOpen(url, width, height, false, p, opt);\n"; 
echo "};\n"; 
echo "function modalDialogShow(url, width, height, p, opt) {\n"; 
echo "    modalDialog(url, width, height); //windowOpen(url, width, height, true, p, opt);\n"; 
echo "};\n"; 
echo "\n"; 
echo "function windowOpen(url, wd, hg, ov, p, opt) {\n"; 
echo "    var id = \"ID\" + (new Date()).getTime();\n"; 
echo "    var f = new ISWindow(id);\n"; 
echo "    f.iconPath = oUtil.scriptPath.substring(0, oUtil.scriptPath.indexOf(\"saf/\")) + \"icons/\";\n"; 
echo "    f.show({ width: wd + \"px\", height: hg + \"px\", overlay: ov, center: true, url: url, openerWin: p, options: opt });\n"; 
echo "};\n"; 
echo "\n"; 
echo "function hide() {\n"; 
echo "    hideAllDD();\n"; 
echo "\n"; 
echo "    this.oColor1.hide();\n"; 
echo "    this.oColor2.hide();\n"; 
echo "\n"; 
echo "    //additional\n"; 
echo "    if (this.btnTable) this.doRefresh_TabCreate();\n"; 
echo "\n"; 
echo "};\n"; 
echo "\n"; 
echo "/*** HTML to XHTML ***/\n"; 
echo "function lineBreak1(tag) //[0]<TAG>[1]text[2]</TAG>\n"; 
echo "{\n"; 
echo "    arrReturn = [\"\n\", \"\", \"\"];\n"; 
echo "    if (tag == \"A\" || tag == \"B\" || tag == \"CITE\" || tag == \"CODE\" || tag == \"EM\" ||\n"; 
echo "    tag == \"FONT\" || tag == \"I\" || tag == \"SMALL\" || tag == \"STRIKE\" || tag == \"BIG\" ||\n"; 
echo "    tag == \"STRONG\" || tag == \"SUB\" || tag == \"SUP\" || tag == \"U\" || tag == \"SAMP\" ||\n"; 
echo "    tag == \"S\" || tag == \"VAR\" || tag == \"BASEFONT\" || tag == \"KBD\" || tag == \"TT\" || tag == \"SPAN\" || tag == \"IMG\")\n"; 
echo "        arrReturn = [\"\", \"\", \"\"];\n"; 
echo "\n"; 
echo "    if (tag == \"TEXTAREA\" || tag == \"TABLE\" || tag == \"THEAD\" || tag == \"TBODY\" ||\n"; 
echo "    tag == \"TR\" || tag == \"OL\" || tag == \"UL\" || tag == \"DIR\" || tag == \"MENU\" ||\n"; 
echo "    tag == \"FORM\" || tag == \"SELECT\" || tag == \"MAP\" || tag == \"DL\" || tag == \"HEAD\" ||\n"; 
echo "    tag == \"BODY\" || tag == \"HTML\")\n"; 
echo "        arrReturn = [\"\n\", \"\", \"\n\"];\n"; 
echo "\n"; 
echo "    if (tag == \"STYLE\" || tag == \"SCRIPT\")\n"; 
echo "        arrReturn = [\"\n\", \"\", \"\"];\n"; 
echo "\n"; 
echo "    if (tag == \"BR\" || tag == \"HR\")\n"; 
echo "        arrReturn = [\"\", \"\n\", \"\"];\n"; 
echo "\n"; 
echo "    return arrReturn;\n"; 
echo "};\n"; 
echo "function fixAttr(s) {\n"; 
echo "    s = String(s).replace(/&/g, \"&amp;\");\n"; 
echo "    s = String(s).replace(/</g, \"&lt;\");\n"; 
echo "    s = String(s).replace(/\"/g, \"&quot;\");\n"; 
echo "    return s;\n"; 
echo "};\n"; 
echo "function fixVal(s) {\n"; 
echo "    s = String(s).replace(/&/g, \"&amp;\");\n"; 
echo "    s = String(s).replace(/</g, \"&lt;\");\n"; 
echo "    var x = escape(s);\n"; 
echo "    x = unescape(x.replace(/\%A0/gi, \"-*REPL*-\"));\n"; 
echo "    s = x.replace(/-\*REPL\*-/gi, \"&nbsp;\");\n"; 
echo "    return s;\n"; 
echo "};\n"; 
echo "function recur(oEl, sTab) {\n"; 
echo "    var sHTML = \"\";\n"; 
echo "    for (var i = 0; i < oEl.childNodes.length; i++) {\n"; 
echo "        var oNode = oEl.childNodes[i];\n"; 
echo "        if (oNode.nodeType == 1)//tag\n"; 
echo "        {\n"; 
echo "            var sTagName = oNode.nodeName;\n"; 
echo "\n"; 
echo "            var bDoNotProcess = false;\n"; 
echo "            if (sTagName.substring(0, 1) == \"/\") {\n"; 
echo "                bDoNotProcess = true; //do not process\n"; 
echo "            }\n"; 
echo "            else {\n"; 
echo "                /*** tabs ***/\n"; 
echo "                var sT = sTab;\n"; 
echo "                sHTML += lineBreak1(sTagName)[0];\n"; 
echo "                if (lineBreak1(sTagName)[0] != \"\") sHTML += sT; //If new line, use base Tabs\n"; 
echo "                /************/\n"; 
echo "            }\n"; 
echo "\n"; 
echo "            if (bDoNotProcess) {\n"; 
echo "                ; //do not process\n"; 
echo "            }\n"; 
echo "            else if (sTagName == \"OBJECT\" || sTagName == \"EMBED\") {\n"; 
echo "                s = getOuterHTML(oNode);\n"; 
echo "\n"; 
echo "                s = s.replace(/\\"[^\\"]*\\"/ig, function (x) {\n"; 
echo "                    x = x.replace(/&/g, \"&amp;\").replace(/</g, \"&lt;\").replace(/>/g, \"&gt;\").replace(/'/g, \"&apos;\").replace(/\s+/ig, \"#_#\").replace(/&amp;amp;/gi, \"&amp;\");\n"; 
echo "                    return x\n"; 
echo "                });\n"; 
echo "                s = s.replace(/<([^ >]*)/ig, function (x) { return x.toLowerCase() });\n"; 
echo "                s = s.replace(/ ([^=]+)=([^\"' >]+)/ig, \" $1=\\"$2\\"\"); //new\n"; 
echo "\n"; 
echo "                s = s.replace(/ ([^=]+)=/ig, function (x) { return x.toLowerCase() });\n"; 
echo "                s = s.replace(/#_#/ig, \" \");\n"; 
echo "\n"; 
echo "                s = s.replace(/<param([^>]*)>/ig, \"\n<param$1 />\").replace(/\/ \/>$/ig, \" \/>\"); //no closing tag\n"; 
echo "\n"; 
echo "                if (sTagName == \"EMBED\")\n"; 
echo "                    if (oNode.innerHTML == \"\")\n"; 
echo "                        s = s.replace(/>$/ig, \" \/>\").replace(/\/ \/>$/ig, \"\/>\"); //no closing tag\n"; 
echo "\n"; 
echo "                s = s.replace(/<param name=\\"Play\\" value=\\"0\\" \/>/, \"<param name=\\"Play\\" value=\\"-1\\" \/>\");\n"; 
echo "\n"; 
echo "                sHTML += s;\n"; 
echo "            }\n"; 
echo "            else if (sTagName == \"TITLE\") {\n"; 
echo "                sHTML += \"<title>\" + oNode.innerHTML + \"</title>\";\n"; 
echo "            }\n"; 
echo "            else {\n"; 
echo "                if (sTagName == \"AREA\") {\n"; 
echo "                    var sCoords = oNode.coords;\n"; 
echo "                    var sShape = oNode.shape;\n"; 
echo "                }\n"; 
echo "\n"; 
echo "                var oNode2 = oNode.cloneNode(false);\n"; 
echo "                s = getOuterHTML(oNode2).replace(/<\/[^>]*>/, \"\");\n"; 
echo "\n"; 
echo "                if (sTagName == \"STYLE\") {\n"; 
echo "                    var arrTmp = s.match(/<[^>]*>/ig);\n"; 
echo "                    s = arrTmp[0];\n"; 
echo "                }\n"; 
echo "\n"; 
echo "                s = s.replace(/\\"[^\\"]*\\"/ig, function (x) {\n"; 
echo "                    //x=x.replace(/&/g, \"&amp;\").replace(/</g, \"&lt;\").replace(/>/g, \"&gt;\").replace(/'/g, \"&apos;\").replace(/\s+/ig,\"#_#\");\n"; 
echo "                    //x=x.replace(/&/g, \"&amp;\").replace(/</g, \"&lt;\").replace(/>/g, \"&gt;\").replace(/\s+/ig,\"#_#\");\n"; 
echo "                    x = x.replace(/&/g, \"&amp;\").replace(/&amp;amp;/g, \"&amp;\").replace(/</g, \"&lt;\").replace(/>/g, \"&gt;\").replace(/\s+/ig, \"#_#\");\n"; 
echo "                    return x\n"; 
echo "                });\n"; 
echo "                //info ttg: .replace(/&amp;amp;/g, \"&amp;\")\n"; 
echo "                //ini karena '&' di (hanya) '&amp;' selalu di-replace lagi dgn &amp;.\n"; 
echo "                //tapi kalau &lt; , &gt; tdk (no problem) => default behaviour\n"; 
echo "\n"; 
echo "                s = s.replace(/<([^ >]*)/ig, function (x) { return x.toLowerCase() });\n"; 
echo "                s = s.replace(/ ([^=]+)=([^\" >]+)/ig, \" $1=\\"$2\\"\");\n"; 
echo "                s = s.replace(/ ([^=]+)=/ig, function (x) { return x.toLowerCase() });\n"; 
echo "                s = s.replace(/#_#/ig, \" \");\n"; 
echo "\n"; 
echo "                //single attribute\n"; 
echo "                s = s.replace(/(<hr[^>]*)(noshade=\"\")/ig, \"$1noshade=\\"noshade\\"\");\n"; 
echo "                s = s.replace(/(<input[^>]*)(checked=\"\")/ig, \"$1checked=\\"checked\\"\");\n"; 
echo "                s = s.replace(/(<select[^>]*)(multiple=\"\")/ig, \"$1multiple=\\"multiple\\"\");\n"; 
echo "                s = s.replace(/(<option[^>]*)(selected=\"\")/ig, \"$1selected=\\"true\\"\");\n"; 
echo "                s = s.replace(/(<input[^>]*)(readonly=\"\")/ig, \"$1readonly=\\"readonly\\"\");\n"; 
echo "                s = s.replace(/(<input[^>]*)(disabled=\"\")/ig, \"$1disabled=\\"disabled\\"\");\n"; 
echo "                s = s.replace(/(<td[^>]*)(nowrap=\"\" )/ig, \"$1nowrap=\\"nowrap\\" \");\n"; 
echo "                s = s.replace(/(<td[^>]*)(nowrap=\"\"\>)/ig, \"$1nowrap=\\"nowrap\\"\>\");\n"; 
echo "\n"; 
echo "                //s = s.replace(/ contenteditable=\\"true\\"/ig, \"\");\n"; 
echo "\n"; 
echo "                if (sTagName == \"AREA\") {\n"; 
echo "                    s = s.replace(/ coords=\\"0,0,0,0\\"/ig, \" coords=\\"\" + sCoords + \"\\"\");\n"; 
echo "                    s = s.replace(/ shape=\\"RECT\\"/ig, \" shape=\\"\" + sShape + \"\\"\");\n"; 
echo "                }\n"; 
echo "\n"; 
echo "                var bClosingTag = true;\n"; 
echo "                if (sTagName == \"IMG\" || sTagName == \"BR\" ||\n"; 
echo "          sTagName == \"AREA\" || sTagName == \"HR\" ||\n"; 
echo "          sTagName == \"INPUT\" || sTagName == \"BASE\" ||\n"; 
echo "          sTagName == \"LINK\")//no closing tag\n"; 
echo "                {\n"; 
echo "                    s = s.replace(/>$/ig, \" \/>\").replace(/\/ \/>$/ig, \"\/>\"); //no closing tag\n"; 
echo "                    bClosingTag = false;\n"; 
echo "                }\n"; 
echo "\n"; 
echo "                sHTML += s;\n"; 
echo "\n"; 
echo "                /*** tabs ***/\n"; 
echo "                if (sTagName != \"TEXTAREA\") sHTML += lineBreak1(sTagName)[1];\n"; 
echo "                if (sTagName != \"TEXTAREA\") if (lineBreak1(sTagName)[1] != \"\") sHTML += sT; //If new line, use base Tabs\n"; 
echo "                /************/\n"; 
echo "\n"; 
echo "                if (bClosingTag) {\n"; 
echo "                    /*** CONTENT ***/\n"; 
echo "                    s = getOuterHTML(oNode);\n"; 
echo "                    if (sTagName == \"SCRIPT\") {\n"; 
echo "                        s = s.replace(/<script([^>]*)>[\n+\s+\t+]*/ig, \"<script$1>\"); //clean spaces\n"; 
echo "                        s = s.replace(/[\n+\s+\t+]*<\/script>/ig, \"<\/script>\"); //clean spaces\n"; 
echo "                        s = s.replace(/<script([^>]*)>\/\/<!\[CDATA\[/ig, \"\");\n"; 
echo "                        s = s.replace(/\/\/\]\]><\/script>/ig, \"\");\n"; 
echo "                        s = s.replace(/<script([^>]*)>/ig, \"\");\n"; 
echo "                        s = s.replace(/<\/script>/ig, \"\");\n"; 
echo "                        s = s.replace(/^\s+/, '').replace(/\s+$/, '');\n"; 
echo "\n"; 
echo "                        sHTML += \"\n\" +\n"; 
echo "              sT + \"//<![CDATA[\n\" +\n"; 
echo "              sT + s + \"\n\" +\n"; 
echo "              sT + \"//]]>\n\" + sT;\n"; 
echo "\n"; 
echo "                    }\n"; 
echo "                    if (sTagName == \"STYLE\") {\n"; 
echo "                        s = s.replace(/<style([^>]*)>[\n+\s+\t+]*/ig, \"<style$1>\"); //clean spaces\n"; 
echo "                        s = s.replace(/[\n+\s+\t+]*<\/style>/ig, \"<\/style>\"); //clean spaces         \n"; 
echo "                        s = s.replace(/<style([^>]*)><!--/ig, \"\");\n"; 
echo "                        s = s.replace(/--><\/style>/ig, \"\");\n"; 
echo "                        s = s.replace(/<style([^>]*)>/ig, \"\");\n"; 
echo "                        s = s.replace(/<\/style>/ig, \"\");\n"; 
echo "                        s = s.replace(/^\s+/, \"\").replace(/\s+$/, \"\");\n"; 
echo "\n"; 
echo "                        sHTML += \"\n\" +\n"; 
echo "              sT + \"<!--\n\" +\n"; 
echo "              sT + s + \"\n\" +\n"; 
echo "              sT + \"-->\n\" + sT;\n"; 
echo "                    }\n"; 
echo "                    if (sTagName == \"DIV\" || sTagName == \"P\") {\n"; 
echo "                        if (oNode.innerHTML == \"\" || oNode.innerHTML == \"&nbsp;\") {\n"; 
echo "                            sHTML += \"&nbsp;\";\n"; 
echo "                        }\n"; 
echo "                        else sHTML += recur(oNode, sT + \"\t\");\n"; 
echo "                    }\n"; 
echo "                    else\n"; 
echo "                        if (sTagName == \"STYLE\" || sTagName == \"SCRIPT\") {\n"; 
echo "                            //do nothing\n"; 
echo "                        }\n"; 
echo "                        else {\n"; 
echo "                            sHTML += recur(oNode, sT + \"\t\");\n"; 
echo "                        }\n"; 
echo "\n"; 
echo "                    /*** tabs ***/\n"; 
echo "                    if (sTagName != \"TEXTAREA\") sHTML += lineBreak1(sTagName)[2];\n"; 
echo "                    if (sTagName != \"TEXTAREA\") if (lineBreak1(sTagName)[2] != \"\") sHTML += sT; //If new line, use base Tabs\n"; 
echo "                    /************/\n"; 
echo "\n"; 
echo "                    sHTML += \"</\" + sTagName.toLowerCase() + \">\";\n"; 
echo "                }\n"; 
echo "            }\n"; 
echo "        }\n"; 
echo "        else if (oNode.nodeType == 3)//text\n"; 
echo "        {\n"; 
echo "            sHTML += fixVal(oNode.nodeValue).replace(/^[\t\r\n\v\f]*/, \"\").replace(/[\t\r\n\v\f]*$/, \"\");\n"; 
echo "        }\n"; 
echo "        else if (oNode.nodeType == 8) {\n"; 
echo "            if (getOuterHTML(oNode).substring(0, 2) == \"<\" + \"%\") {//server side script\n"; 
echo "                sTmp = (getOuterHTML(oNode).substring(2));\n"; 
echo "                sTmp = sTmp.substring(0, sTmp.length - 2);\n"; 
echo "                sTmp = sTmp.replace(/^\s+/, \"\").replace(/\s+$/, \"\");\n"; 
echo "\n"; 
echo "                /*** tabs ***/\n"; 
echo "                var sT = sTab;\n"; 
echo "                /************/\n"; 
echo "\n"; 
echo "                sHTML += \"\n\" +\n"; 
echo "          sT + \"<%\n\" +\n"; 
echo "          sT + sTmp + \"\n\" +\n"; 
echo "          sT + \"%>\n\" + sT;\n"; 
echo "            }\n"; 
echo "            else {//comments\n"; 
echo "\n"; 
echo "                /*** tabs ***/\n"; 
echo "                var sT = sTab;\n"; 
echo "                /************/\n"; 
echo "\n"; 
echo "                sTmp = oNode.nodeValue;\n"; 
echo "                sTmp = sTmp.replace(/^\s+/, \"\").replace(/\s+$/, \"\");\n"; 
echo "\n"; 
echo "                sHTML += \"\n\" +\n"; 
echo "          sT + \"<!--\n\" +\n"; 
echo "          sT + sTmp + \"\n\" +\n"; 
echo "          sT + \"-->\n\" + sT;\n"; 
echo "            }\n"; 
echo "        }\n"; 
echo "        else {\n"; 
echo "            ; //Not Processed\n"; 
echo "        }\n"; 
echo "    }\n"; 
echo "    return sHTML;\n"; 
echo "};\n"; 
echo "\n"; 
echo "/*** Netscape range methods ***/\n"; 
echo "function getSelectedElement(sel) {\n"; 
echo "    var range = sel.getRangeAt(0);\n"; 
echo "    var node = range.startContainer;\n"; 
echo "    if (node.nodeType == Node.ELEMENT_NODE) {\n"; 
echo "        if (range.startOffset >= node.childNodes.length) return node;\n"; 
echo "        node = node.childNodes[range.startOffset];\n"; 
echo "    }\n"; 
echo "    if (node.nodeType == Node.TEXT_NODE) {\n"; 
echo "        if (node.nodeValue.length == range.startOffset) {\n"; 
echo "            var el = node.nextSibling;\n"; 
echo "            if (el && el.nodeType == Node.ELEMENT_NODE) {\n"; 
echo "                if (range.endContainer.nodeType == Node.TEXT_NODE && range.endContainer.nodeValue.length == range.endOffset) {\n"; 
echo "                    if (el == range.endContainer.parentNode) {\n"; 
echo "                        return el;\n"; 
echo "                    }\n"; 
echo "                }\n"; 
echo "            }\n"; 
echo "        }\n"; 
echo "        while (node != null && node.nodeType != Node.ELEMENT_NODE) {\n"; 
echo "            node = node.parentNode;\n"; 
echo "        }\n"; 
echo "    }\n"; 
echo "    return node;\n"; 
echo "};\n"; 
echo "function isTextSelected(sel) {\n"; 
echo "    var range = sel.getRangeAt(0);\n"; 
echo "    if (range != null && range.startContainer != null) {\n"; 
echo "        return (range.startContainer.nodeType == Node.TEXT_NODE);\n"; 
echo "    }\n"; 
echo "    return false;\n"; 
echo "};\n"; 
echo "function getOuterHTML(node) {\n"; 
echo "    var sHTML = \"\";\n"; 
echo "    switch (node.nodeType) {\n"; 
echo "        case Node.ELEMENT_NODE:\n"; 
echo "            sHTML = \"<\" + node.nodeName;\n"; 
echo "\n"; 
echo "            var tagVal = \"\";\n"; 
echo "            for (var atr = 0; atr < node.attributes.length; atr++) {\n"; 
echo "                if (node.attributes[atr].nodeName.substr(0, 4) == \"_moz\") continue;\n"; 
echo "                if (node.attributes[atr].nodeValue.substr(0, 4) == \"_moz\") continue; //yus                \n"; 
echo "                if (node.nodeName == 'TEXTAREA' && node.attributes[atr].nodeName.toLowerCase() == 'value') {\n"; 
echo "                    tagVal = node.attributes[atr].nodeValue;\n"; 
echo "                }\n"; 
echo "                else {\n"; 
echo "                    sHTML += ' ' + node.attributes[atr].nodeName + '=\"' + node.attributes[atr].nodeValue + '\"';\n"; 
echo "                }\n"; 
echo "            }\n"; 
echo "            sHTML += '>';\n"; 
echo "            sHTML += (node.nodeName != 'TEXTAREA' ? node.innerHTML : tagVal);\n"; 
echo "            sHTML += \"</\" + node.nodeName + \">\";\n"; 
echo "            break;\n"; 
echo "        case Node.COMMENT_NODE:\n"; 
echo "            sHTML = \"<!\" + \"--\" + node.nodeValue + \"--\" + \">\"; break;\n"; 
echo "        case Node.TEXT_NODE:\n"; 
echo "            sHTML = node.nodeValue; break;\n"; 
echo "    }\n"; 
echo "    return sHTML;\n"; 
echo "};\n"; 
echo "\n"; 
echo "function tbAction(tb, id, edt, sfx) {\n"; 
echo "    var e = edt, oN = sfx, btn = id.substring(0, id.lastIndexOf(oN));\n"; 
echo "\n"; 
echo "    switch (btn) {\n"; 
echo "        case \"btnFullScreen\": e.fullScreen(); break;\n"; 
echo "        case \"btnPrint\": e.focus(); document.getElementById(\"idContent\" + edt.oName).contentWindow.print(); break;\n"; 
echo "        case \"btnSpellCheck\": e.hide();\n"; 
echo "            if (e.spellCheckMode == \"ieSpell\");\n"; 
echo "            else if (e.spellCheckMode == \"NetSpell\") checkSpellingById(\"idContent\" + edt.oName);\n"; 
echo "            break;\n"; 
echo "        case \"btnCut\": e.doCmd(\"Cut\"); break;\n"; 
echo "        case \"btnCopy\": e.doCmd(\"Copy\"); break;\n"; 
echo "        case \"btnUndo\": e.doUndo(); break;\n"; 
echo "        case \"btnRedo\": e.doRedo(); break;\n"; 
echo "        case \"btnBold\": e.applyFormattingStyle(\"Bold\"); break;\n"; 
echo "        case \"btnItalic\": e.applyFormattingStyle(\"Italic\"); break;\n"; 
echo "        case \"btnUnderline\": e.applyFormattingStyle(\"Underline\"); break;\n"; 
echo "        case \"btnStrikethrough\": e.applyFormattingStyle(\"Strikethrough\"); break;\n"; 
echo "        case \"btnSuperscript\": e.applyFormattingStyle(\"Superscript\"); break;\n"; 
echo "        case \"btnSubscript\": e.applyFormattingStyle(\"Subscript\"); break;\n"; 
echo "        case \"btnJustifyLeft\": e.applyJustifyLeft(); break;\n"; 
echo "        case \"btnJustifyCenter\": e.applyJustifyCenter(); break;\n"; 
echo "        case \"btnJustifyRight\": e.applyJustifyRight(); break;\n"; 
echo "        case \"btnJustifyFull\": e.applyJustifyFull(); break;\n"; 
echo "        case \"btnNumbering\": e.applyNumbering(); break;\n"; 
echo "        case \"btnBullets\": e.applyBullets(); break;\n"; 
echo "        case \"btnIndent\": e.doCmd(\"Indent\"); break;\n"; 
echo "        case \"btnOutdent\": e.applyOutdent(); break;\n"; 
echo "        case \"btnLTR\": e.applyBlockDirLTR(); break;\n"; 
echo "        case \"btnRTL\": e.applyBlockDirRTL(); break;\n"; 
echo "        case \"btnFontDialog\": e.hide(); modelessDialogShow(e.dialogPath + \"webfonts.htm\", e.dialogSize[\"FontDialog\"].w, e.dialogSize[\"FontDialog\"].h); break;\n"; 
echo "        case \"btnTextDialog\": e.hide(); modelessDialogShow(e.dialogPath + \"webtext.htm\", e.dialogSize[\"TextDialog\"].w, e.dialogSize[\"TextDialog\"].h); break;\n"; 
echo "        case \"btnCompleteTextDialog\": e.hide(); modelessDialogShow(e.dialogPath + \"webtextcomplete.htm\", e.dialogSize[\"CompleteTextDialog\"].w, e.dialogSize[\"CompleteTextDialog\"].h); break;\n"; 
echo "        case \"btnLinkDialog\":\n"; 
echo "            e.hide();\n"; 
echo "            if (e.fileBrowser == \"\" && e.enableCssButtons == false) {\n"; 
echo "                modelessDialogShow(e.dialogPath + \"weblink.htm\", 300, 400);\n"; 
echo "            }\n"; 
echo "            else {\n"; 
echo "                modelessDialogShow(e.dialogPath + \"weblink.htm\", e.dialogSize[\"LinkDialog\"].w, e.dialogSize[\"LinkDialog\"].h);\n"; 
echo "            }\n"; 
echo "            break;\n"; 
echo "        case \"btnImageDialog\": e.hide(); modelessDialogShow(e.dialogPath + \"webimage.php\", e.dialogSize[\"ImageDialog\"].w, e.dialogSize[\"ImageDialog\"].h); break;\n"; 
echo "        case \"btnYoutubeDialog\": e.hide(); modelessDialogShow(e.dialogPath + \"webyoutube.htm\", e.dialogSize[\"YoutubeDialog\"].w, e.dialogSize[\"YoutubeDialog\"].h); break;\n"; 
echo "        case \"btnTableDialog\": e.hide(); modelessDialogShow(e.dialogPath + \"webtable.htm\", e.dialogSize[\"TableDialog\"].w, e.dialogSize[\"TableDialog\"].h); break;\n"; 
echo "        case \"btnFlashDialog\": e.hide(); modelessDialogShow(e.dialogPath + \"webflash.htm\", e.dialogSize[\"FlashDialog\"].w, e.dialogSize[\"FlashDialog\"].h); break;\n"; 
echo "        case \"btnCharsDialog\": e.hide(); modelessDialogShow(e.dialogPath + \"webchars.htm\", e.dialogSize[\"CharsDialog\"].w, e.dialogSize[\"CharsDialog\"].h); break;\n"; 
echo "        case \"btnSearchDialog\": e.hide(); modelessDialogShow(e.dialogPath + \"websearch.htm\", e.dialogSize[\"SearchDialog\"].w, e.dialogSize[\"SearchDialog\"].h); break;\n"; 
echo "        case \"btnSourceDialog\": e.hide(); changeActiveEditor(e.oName); modelessDialogShow(e.dialogPath + \"websource.htm\", e.dialogSize[\"SourceDialog\"].w, e.dialogSize[\"SourceDialog\"].h); break;\n"; 
echo "        case \"btnBookmarkDialog\": e.hide(); modelessDialogShow(e.dialogPath + \"webbookmark.htm\", e.dialogSize[\"BookmarkDialog\"].w, e.dialogSize[\"BookmarkDialog\"].h); break;\n"; 
echo "        case \"btnPreview\": e.hide(); modelessDialogShow(e.dialogPath + \"webpreview.htm\", e.dialogSize[\"Preview\"].w, e.dialogSize[\"Preview\"].h); break;\n"; 
echo "        case \"btnContentBlock\": e.hide(); eval(e.cmdContentBlock); break;\n"; 
echo "        case \"btnInternalLink\": e.hide(); eval(e.cmdInternalLink); break;\n"; 
echo "        case \"btnInternalImage\": e.hide(); eval(e.cmdInternalImage); break;\n"; 
echo "        case \"btnCustomObject\": e.hide(); eval(e.cmdCustomObject); break;\n"; 
echo "        case \"btnGuidelines\": e.runtimeBorder(true); break;\n"; 
echo "        case \"btnAbsolute\": e.makeAbsolute(); break;\n"; 
echo "        case \"btnLine\": e.doCmd(\"InsertHorizontalRule\"); break;\n"; 
echo "        case \"btnRemoveFormat\": e.doClean(); break;\n"; 
echo "        case \"btnClearAll\": e.clearAll(); break;\n"; 
echo "        case \"btnStyles\": e.hide(); e.openStyleSelect(); break;\n"; 
echo "        case \"btnParagraph\": e.hide(); e.selectParagraph(); break;\n"; 
echo "        case \"btnFontName\": e.hide(); e.expandSelection(); realtimeFontSelect(e.oName); break;\n"; 
echo "        case \"btnFontSize\": e.hide(); e.expandSelection(); realtimeSizeSelect(e.oName); break;\n"; 
echo "        case \"btnCustomTag\": e.hide(); break;\n"; 
echo "        case \"btnQuote\": e.applyQuote(); break;\n"; 
echo "        default:\n"; 
echo "            for (var i = 0; i < e.arrCustomButtons.length; i++) {\n"; 
echo "                if (e.arrCustomButtons[i][0] == btn) {\n"; 
echo "                    eval(e.arrCustomButtons[i][1]);\n"; 
echo "                    break;\n"; 
echo "                }\n"; 
echo "            }\n"; 
echo "    }\n"; 
echo "};\n"; 
echo "\n"; 
echo "function ddAction(tb, id, edt, sfx) {\n"; 
echo "    var oN = sfx;\n"; 
echo "    var e = edt;\n"; 
echo "    var btn = id.substring(0, id.lastIndexOf(oN));\n"; 
echo "\n"; 
echo "    switch (btn) {\n"; 
echo "        //case \"btnPasteClip\": e.doPaste(); break;            \n"; 
echo "        case \"btnPasteClip\": alert(getTxt(\"PasteWarning\")); break;\n"; 
echo "        case \"btnPasteWord\": if (!e.customDialogShow(\"PasteWord\")) modelessDialogShow(e.scriptPath + \"paste_word.htm\", 400, 280); break;\n"; 
echo "        case \"btnPasteText\": modelessDialogShow(e.dialogPath + \"webpastetext.htm\", 400, 280); break;\n"; 
echo "    }\n"; 
echo "\n"; 
echo "    var idx = 0;\n"; 
echo "    if (btn.indexOf(\"btnParagraphFormatting\") != -1) {\n"; 
echo "    } else\n"; 
echo "        if (btn.indexOf(\"btnParagraph\") != -1) {\n"; 
echo "            idx = btn.substr(btn.indexOf(\"_\") + 1);\n"; 
echo "            e.applyParagraph(\"<\" + e.arrParagraph[parseInt(idx)][1] + \">\");\n"; 
echo "        } else\n"; 
echo "            if (btn.indexOf(\"btnFontName\") != -1) {\n"; 
echo "                idx = btn.substr(btn.indexOf(\"_\") + 1);\n"; 
echo "                e.applyFontName(e.arrFontName[parseInt(idx)]);\n"; 
echo "            } else\n"; 
echo "                if (btn.indexOf(\"btnFontSize\") != -1) {\n"; 
echo "                    idx = btn.substr(btn.indexOf(\"_\") + 1);\n"; 
echo "                    e.applyFontSize(e.arrFontSize[parseInt(idx)][1]);\n"; 
echo "                } else\n"; 
echo "                    if (btn.indexOf(\"btnCustomTag\") != -1) {\n"; 
echo "                        idx = btn.substr(btn.indexOf(\"_\") + 1);\n"; 
echo "                        e.insertCustomTag(parseInt(idx));\n"; 
echo "                    }\n"; 
echo "};\n"; 
echo "\n"; 
echo "function changeHeight(v) {\n"; 
echo "\n"; 
echo "    var cH = String(this.height);\n"; 
echo "    var edtObj = document.getElementById(\"idArea\" + this.oName);\n"; 
echo "    if (cH.indexOf(\"%\") > -1) {\n"; 
echo "        cH = edtObj.childNodes[0].offsetHeight -\n"; 
echo "      edtObj.rows[0].cells[0].childNodes[0].offsetHeight -\n"; 
echo "        (this.useTagSelector ? 20 : 0);\n"; 
echo "    }\n"; 
echo "\n"; 
echo "    if (!this.minHeight) this.minHeight = parseInt(cH, 10);\n"; 
echo "\n"; 
echo "    var newHeight = parseInt(cH, 10) + v;\n"; 
echo "\n"; 
echo "    //if(newHeight < this.minHeight) {\n"; 
echo "    //  newHeight = this.minHeight;\n"; 
echo "    //}\n"; 
echo "\n"; 
echo "    this.height = newHeight + \"px\";\n"; 
echo "    edtObj.style.height = this.height;\n"; 
echo "\n"; 
echo "};\n"; 
echo "\n"; 
echo "function _isWordContent(str) {\n"; 
echo "    return (\n"; 
echo "      /msonormal/i.test(str) ||\n"; 
echo "      /<!(?:--[\s\S]*?--\s*)?>\s*/gi.test(str) ||\n"; 
echo "      /<\\?\?xml[^>]*>/gi.test(str) ||\n"; 
echo "      /<\/?o:p[^>]*>/gi.test(str) ||\n"; 
echo "      /<\/?u1:p[^>]*>/gi.test(str) ||\n"; 
echo "      /<\/?v:[^>]*>/gi.test(str) ||\n"; 
echo "      /<\/?o:[^>]*>/gi.test(str) ||\n"; 
echo "      /<\/?st1:[^>]*>/gi.test(str) ||\n"; 
echo "      /<\/?w:wrap[^>]*>/gi.test(str) ||\n"; 
echo "      /<\/?w:anchorlock[^>]*>/gi.test(str) ||\n"; 
echo "      /<!--\[if[^>]*>/gi.test(str) ||\n"; 
echo "      /<!--\[endif\]-->/gi.test(str) ||\n"; 
echo "      /<!\[endif\]-->/gi.test(str) ||\n"; 
echo "      /<\/?meta[^>]*>/g.test(str) ||\n"; 
echo "      /<\/?link[^>]*>/g.test(str) ||\n"; 
echo "      /<\/?style[^>]*>/g.test(str)\n"; 
echo "  );\n"; 
echo "};\n"; 
echo "\n"; 
echo "function fixWord() {\n"; 
echo "\n"; 
echo "    var oEditor = document.getElementById(\"idContent\" + this.oName).contentWindow;\n"; 
echo "\n"; 
echo "    var idSource = oEditor.document.getElementById(\"pasteArea\");\n"; 
echo "\n"; 
echo "    //check if word content.\n"; 
echo "    var isWord = _isWordContent(idSource.innerHTML);\n"; 
echo "    if (!isWord) {\n"; 
echo "        var cnt = idSource.innerHTML;\n"; 
echo "        idSource.parentNode.removeChild(idSource);\n"; 
echo "        return cnt;\n"; 
echo "    }\n"; 
echo "\n"; 
echo "    var allTags = idSource.getElementsByTagName(\"*\");\n"; 
echo "    for (var i = 0; i < allTags.length; i++) {\n"; 
echo "        allTags[i].removeAttribute(\"class\");\n"; 
echo "        allTags[i].removeAttribute(\"style\");\n"; 
echo "    }\n"; 
echo "\n"; 
echo "    var str = idSource.innerHTML;\n"; 
echo "\n"; 
echo "    //remove the div\n"; 
echo "    idSource.parentNode.removeChild(idSource);\n"; 
echo "\n"; 
echo "    str = String(str).replace(/<\\?\?xml[^>]*>/g, \"\");\n"; 
echo "    str = String(str).replace(/<\/?o:p[^>]*>/g, \"\");\n"; 
echo "    str = String(str).replace(/<\/?u1:p[^>]*>/gi, \"\");\n"; 
echo "    str = String(str).replace(/<\/?v:[^>]*>/g, \"\");\n"; 
echo "    str = String(str).replace(/<\/?o:[^>]*>/g, \"\");\n"; 
echo "    str = String(str).replace(/<\/?st1:[^>]*>/g, \"\");\n"; 
echo "    str = String(str).replace(/<\/?w:wrap[^>]*>/gi, \"\");\n"; 
echo "    str = String(str).replace(/<\/?w:anchorlock[^>]*>/gi, \"\");\n"; 
echo "\n"; 
echo "    //str = String(str).replace(/&nbsp;/g, \"\"); //<p>&nbsp;</p>\n"; 
echo "\n"; 
echo "    str = String(str).replace(/<\/?SPAN[^>]*>/g, \"\");\n"; 
echo "    str = String(str).replace(/<\/?FONT[^>]*>/g, \"\");\n"; 
echo "    str = String(str).replace(/<\/?STRONG[^>]*>/g, \"\");\n"; 
echo "\n"; 
echo "    str = String(str).replace(/<\/?H1[^>]*>/g, \"\");\n"; 
echo "    str = String(str).replace(/<\/?H2[^>]*>/g, \"\");\n"; 
echo "    str = String(str).replace(/<\/?H3[^>]*>/g, \"\");\n"; 
echo "    str = String(str).replace(/<\/?H4[^>]*>/g, \"\");\n"; 
echo "    str = String(str).replace(/<\/?H5[^>]*>/g, \"\");\n"; 
echo "    str = String(str).replace(/<\/?H6[^>]*>/g, \"\");\n"; 
echo "\n"; 
echo "    str = String(str).replace(/<\/?P[^>]*><\/P>/g, \"\");\n"; 
echo "\n"; 
echo "    str = String(str).replace(/<!--\[if[^>]*>/gi, \"\");\n"; 
echo "    str = String(str).replace(/<!--\[endif\]-->/gi, \"\");\n"; 
echo "    str = String(str).replace(/<!\[endif\]-->/gi, \"\");\n"; 
echo "\n"; 
echo "    return str;\n"; 
echo "};\n"; 
echo "\n"; 
echo "function customDialogShow(s) {\n"; 
echo "    for (var j = 0; j < this.customDialog.length; j++) {\n"; 
echo "        if (this.customDialog[j][0] == s) {\n"; 
echo "            eval(this.customDialog[j][1]);\n"; 
echo "            return true;\n"; 
echo "        }\n"; 
echo "    }\n"; 
echo "    return false;\n"; 
echo "};\n"; 
echo "\n"; 
echo "function GetEmoticons() {\n"; 
echo "    var sHtml = '';\n"; 
echo "    var arrEmoticons = [\n"; 
echo "        [\"smiley.png\", \"smiley\"],\n"; 
echo "        [\"smiley-lol.png\", \"lol\"],\n"; 
echo "        [\"smiley-confuse.png\", \"confuse\"],\n"; 
echo "        [\"smiley-cool.png\", \"cool\"],\n"; 
echo "        [\"smiley-cry.png\", \"cry\"],\n"; 
echo "        [\"smiley-wink.png\", \"wink\"],\n"; 
echo "        [\"smiley-surprise.png\", \"surprise\"],\n"; 
echo "        [\"smiley-sad.png\", \"sad\"],\n"; 
echo "        [\"smiley-red.png\", \"red\"],\n"; 
echo "        [\"smiley-neutral.png\", \"neutral\"],\n"; 
echo "        [\"smiley-kiss.png\", \"kiss\"],\n"; 
echo "        [\"smiley-mad.png\", \"mad\"],\n"; 
echo "        [\"smiley-money.png\", \"money\"],\n"; 
echo "        [\"smiley-sleep.png\", \"sleep\"],\n"; 
echo "        [\"smiley-yell.png\", \"yell\"],\n"; 
echo "        [\"smiley-roll.png\", \"roll\"],\n"; 
echo "        [\"smiley-grin.png\", \"grin\"],\n"; 
echo "        [\"smiley-razz.png\", \"razz\"],\n"; 
echo "        [\"smiley-sweat.png\", \"sweat\"],\n"; 
echo "        [\"smiley-eek.png\", \"eek\"],\n"; 
echo "        [\"smiley-zipper.png\", \"zipper\"],\n"; 
echo "        [\"heart.png\", \"love\"],\n"; 
echo "        [\"heart-break.png\", \"heart break\"],\n"; 
echo "        [\"light-bulb.png\", \"idea\"]\n"; 
echo "    ]; //[\"smiley-draw.png\", \"draw\"]\n"; 
echo "    var icPath = this.scriptPath.substring(0, this.scriptPath.indexOf(\"saf/\")) + this.iconPath;\n"; 
echo "\n"; 
echo "    sHtml += \"<div style='width:193px;height:72px;margin:2px;'>\";\n"; 
echo "    for (var j = 0; j < arrEmoticons.length; j++) {\n"; 
echo "        sHtml += \"<img unselectable='on' src='\" + icPath + arrEmoticons[j][0] + \"' onmouseover='this.style.border=\\"#aaaaaa 1px solid\\"' onmouseout='this.style.border=\\"#ffffff 1px solid\\"' style='float:left;margin:1px;cursor:pointer;border:#ffffff 1px solid;padding:2px;' onclick='\" + this.oName + \".insertEmoticon(\\"\" + icPath + arrEmoticons[j][0] + \"\\",\\"\" + arrEmoticons[j][1] + \"\\");' alt='\" + arrEmoticons[j][1] + \"' />\";\n"; 
echo "    }\n"; 
echo "    sHtml += \"</div>\";\n"; 
echo "    return sHtml;\n"; 
echo "}\n"; 
echo "function insertEmoticon(img, alt) {\n"; 
echo "    this.insertHTML(\"<img src='\" + img + \"' alt='\" + alt + \"' />\");\n"; 
echo "    var box = document.getElementById(\"ddEmoticons\" + this.oName);\n"; 
echo "    box.style.display = \"none\";\n"; 
echo "    this.isActive = false;\n"; 
echo "}\n"; 
echo "\n"; 
echo "function applyQuote() {\n"; 
echo "    var oEditor = document.getElementById(\"idContent\" + this.oName).contentWindow;\n"; 
echo "    var oSel = oEditor.getSelection();\n"; 
echo "    var element = getSelectedElement(oSel);\n"; 
echo "    var oQuote = GetElement(element, \"BLOCKQUOTE\");\n"; 
echo "    if (oQuote) {\n"; 
echo "        this.applyParagraph('p');\n"; 
echo "    } else {\n"; 
echo "        this.applyParagraph('blockquote');\n"; 
echo "    }\n"; 
echo "}\n"; 
echo "\n"; 
echo "function cleanWebkitUselessSpan(obj) {\n"; 
echo "    var oEditor = document.getElementById(\"idContent\" + obj.oName).contentWindow;\n"; 
echo "    var sel = oEditor.getSelection();\n"; 
echo "    var r = sel.getRangeAt(0);\n"; 
echo "    var el = getSelectedElement(sel);\n"; 
echo "    var span = GetElement(el, \"SPAN\");\n"; 
echo "\n"; 
echo "    if (span && span.textContent == \"\") {\n"; 
echo "\n"; 
echo "        var parent = span.parentNode;\n"; 
echo "\n"; 
echo "        span.parentNode.removeChild(span);\n"; 
echo "\n"; 
echo "        if (parent.tagName == \"BODY\") {\n"; 
echo "            var tag = \"div\";\n"; 
echo "            if (obj.returnKeyMode == 2) {\n"; 
echo "                tag = \"br\";\n"; 
echo "            } else if (obj.returnKeyMode == 3) {\n"; 
echo "                tag = \"p\";\n"; 
echo "            }\n"; 
echo "\n"; 
echo "\n"; 
echo "            var docFrag = r.createContextualFragment(\"<\" + tag + \"></\" + tag + \">\");\n"; 
echo "\n"; 
echo "            var cnt = docFrag.firstChild; //save the reference to docFrag content because after insert, docFrag will be empty\n"; 
echo "            if (cnt.innerHTML == \"\") cnt.innerHTML = \"<br />\";\n"; 
echo "            r.insertNode(docFrag);\n"; 
echo "            r.selectNodeContents(cnt);\n"; 
echo "            cnt.normalize();\n"; 
echo "            cnt.parentNode.normalize();\n"; 
echo "\n"; 
echo "            r.collapse(true);\n"; 
echo "\n"; 
echo "            //update the range\n"; 
echo "            sel.removeAllRanges();\n"; 
echo "            sel.addRange(r);\n"; 
echo "\n"; 
echo "            //cnt.scrollIntoView(false);\n"; 
echo "\n"; 
echo "            //remove temporary br\n"; 
echo "            //if(cnt.innerHTML==\"<br>\") cnt.innerHTML=\"\";\n"; 
echo "            realTime(this);\n"; 
echo "        }\n"; 
echo "\n"; 
echo "    }\n"; 
echo "};\n"; 
echo "\n"; 
echo "function getElementPosition(el, pr) {\n"; 
echo "    var tmp = el, y = 0;\n"; 
echo "    do {\n"; 
echo "        y += tmp.offsetTop;\n"; 
echo "        tmp = tmp.offsetParent;\n"; 
echo "    } while (tmp && tmp.id != pr.id);\n"; 
echo "    return y;\n"; 
echo "};\n"; 
echo "\n"; 
echo "function isNodeVisible(el, edtFrame) {\n"; 
echo "    var body = edtFrame.contentWindow.document.body;\n"; 
echo "    var elPos = getElementPosition(el, body);\n"; 
echo "\n"; 
echo "    var vpStyle = null;\n"; 
echo "    if (window.getComputedStyle) {\n"; 
echo "        vpStyle = window.getComputedStyle(edtFrame, \"\");\n"; 
echo "    } else {\n"; 
echo "        vpStyle = edtFrame.currentStyle;\n"; 
echo "    }\n"; 
echo "\n"; 
echo "    var vph = parseInt(vpStyle.height, 10);\n"; 
echo "    return (elPos > body.scrollTop && elPos < (body.scrollTop + vph - 20));\n"; 
echo "};\n"; 
echo "\n"; 
echo "function ensureVisible(el, edtFrame) {\n"; 
echo "    if (!isNodeVisible(el, edtFrame)) {\n"; 
echo "        var body = edtFrame.contentWindow.document.body;\n"; 
echo "        var elPos = getElementPosition(el, body);\n"; 
echo "        body.scrollTop = elPos;\n"; 
echo "\n"; 
echo "    }\n"; 
echo "};\n";
?>